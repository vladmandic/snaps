/*
  snaps
  homepage: <https://github.com/vladmandic/snaps>
  author: <https://github.com/vladmandic>'
*/

"use strict";var Hn=Object.create;var Ee=Object.defineProperty;var Wn=Object.getOwnPropertyDescriptor;var Yn=Object.getOwnPropertyNames;var Zn=Object.getPrototypeOf,Kn=Object.prototype.hasOwnProperty;var Qn=(r,t,e)=>t in r?Ee(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var X=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Jn=(r,t)=>{for(var e in t)Ee(r,e,{get:t[e],enumerable:!0})},to=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Yn(t))!Kn.call(r,i)&&i!==e&&Ee(r,i,{get:()=>t[i],enumerable:!(n=Wn(t,i))||n.enumerable});return r};var dt=(r,t,e)=>(e=r!=null?Hn(Zn(r)):{},to(t||!r||!r.__esModule?Ee(e,"default",{value:r,enumerable:!0}):e,r));var rt=(r,t,e)=>(Qn(r,typeof t!="symbol"?t+"":t,e),e);var Ae=X((Gs,ri)=>{"use strict";var eo=Object.create,Ie=Object.defineProperty,ro=Object.getOwnPropertyDescriptor,Hr=Object.getOwnPropertyNames,io=Object.getPrototypeOf,no=Object.prototype.hasOwnProperty,oo=(r,t)=>function(){return t||(0,r[Hr(r)[0]])((t={exports:{}}).exports,t),t.exports},so=(r,t)=>{for(var e in t)Ie(r,e,{get:t[e],enumerable:!0})},Wr=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Hr(t))!no.call(r,i)&&i!==e&&Ie(r,i,{get:()=>t[i],enumerable:!(n=ro(t,i))||n.enumerable});return r},Ht=(r,t,e)=>(e=r!=null?eo(io(r)):{},Wr(t||!r||!r.__esModule?Ie(e,"default",{value:r,enumerable:!0}):e,r)),ao=r=>Wr(Ie({},"__esModule",{value:!0}),r),uo=oo({"node_modules/.pnpm/dayjs@1.11.4/node_modules/dayjs/dayjs.min.js"(r,t){(function(e,n){typeof r=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(e=typeof globalThis<"u"?globalThis:e||self).dayjs=n()})(r,function(){"use strict";var e=1e3,n=6e4,i=36e5,o="millisecond",s="second",f="minute",p="hour",T="day",E="week",b="month",v="quarter",h="year",w="date",O="Invalid Date",F=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,R={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},g=function(I,L,x){var M=String(I);return!M||M.length>=L?I:""+Array(L+1-M.length).join(x)+I},c={s:g,z:function(I){var L=-I.utcOffset(),x=Math.abs(L),M=Math.floor(x/60),q=x%60;return(L<=0?"+":"-")+g(M,2,"0")+":"+g(q,2,"0")},m:function I(L,x){if(L.date()<x.date())return-I(x,L);var M=12*(x.year()-L.year())+(x.month()-L.month()),q=L.clone().add(M,b),j=x-q<0,B=L.clone().add(M+(j?-1:1),b);return+(-(M+(x-q)/(j?q-B:B-q))||0)},a:function(I){return I<0?Math.ceil(I)||0:Math.floor(I)},p:function(I){return{M:b,y:h,w:E,d:T,D:w,h:p,m:f,s,ms:o,Q:v}[I]||String(I||"").toLowerCase().replace(/s$/,"")},u:function(I){return I===void 0}},a="en",y={};y[a]=R;var S=function(I){return I instanceof C},d=function I(L,x,M){var q;if(!L)return a;if(typeof L=="string"){var j=L.toLowerCase();y[j]&&(q=j),x&&(y[j]=x,q=j);var B=L.split("-");if(!q&&B.length>1)return I(B[0])}else{var U=L.name;y[U]=L,q=U}return!M&&q&&(a=q),q||!M&&a},N=function(I,L){if(S(I))return I.clone();var x=typeof L=="object"?L:{};return x.date=I,x.args=arguments,new C(x)},m=c;m.l=d,m.i=S,m.w=function(I,L){return N(I,{locale:L.$L,utc:L.$u,x:L.$x,$offset:L.$offset})};var C=function(){function I(x){this.$L=d(x.locale,null,!0),this.parse(x)}var L=I.prototype;return L.parse=function(x){this.$d=function(M){var q=M.date,j=M.utc;if(q===null)return new Date(NaN);if(m.u(q))return new Date;if(q instanceof Date)return new Date(q);if(typeof q=="string"&&!/Z$/i.test(q)){var B=q.match(F);if(B){var U=B[2]-1||0,H=(B[7]||"0").substring(0,3);return j?new Date(Date.UTC(B[1],U,B[3]||1,B[4]||0,B[5]||0,B[6]||0,H)):new Date(B[1],U,B[3]||1,B[4]||0,B[5]||0,B[6]||0,H)}}return new Date(q)}(x),this.$x=x.x||{},this.init()},L.init=function(){var x=this.$d;this.$y=x.getFullYear(),this.$M=x.getMonth(),this.$D=x.getDate(),this.$W=x.getDay(),this.$H=x.getHours(),this.$m=x.getMinutes(),this.$s=x.getSeconds(),this.$ms=x.getMilliseconds()},L.$utils=function(){return m},L.isValid=function(){return this.$d.toString()!==O},L.isSame=function(x,M){var q=N(x);return this.startOf(M)<=q&&q<=this.endOf(M)},L.isAfter=function(x,M){return N(x)<this.startOf(M)},L.isBefore=function(x,M){return this.endOf(M)<N(x)},L.$g=function(x,M,q){return m.u(x)?this[M]:this.set(q,x)},L.unix=function(){return Math.floor(this.valueOf()/1e3)},L.valueOf=function(){return this.$d.getTime()},L.startOf=function(x,M){var q=this,j=!!m.u(M)||M,B=m.p(x),U=function(_,D){var k=m.w(q.$u?Date.UTC(q.$y,D,_):new Date(q.$y,D,_),q);return j?k:k.endOf(T)},H=function(_,D){return m.w(q.toDate()[_].apply(q.toDate("s"),(j?[0,0,0,0]:[23,59,59,999]).slice(D)),q)},W=this.$W,et=this.$M,Dt=this.$D,St="set"+(this.$u?"UTC":"");switch(B){case h:return j?U(1,0):U(31,11);case b:return j?U(1,et):U(0,et+1);case E:var l=this.$locale().weekStart||0,u=(W<l?W+7:W)-l;return U(j?Dt-u:Dt+(6-u),et);case T:case w:return H(St+"Hours",0);case p:return H(St+"Minutes",1);case f:return H(St+"Seconds",2);case s:return H(St+"Milliseconds",3);default:return this.clone()}},L.endOf=function(x){return this.startOf(x,!1)},L.$set=function(x,M){var q,j=m.p(x),B="set"+(this.$u?"UTC":""),U=(q={},q[T]=B+"Date",q[w]=B+"Date",q[b]=B+"Month",q[h]=B+"FullYear",q[p]=B+"Hours",q[f]=B+"Minutes",q[s]=B+"Seconds",q[o]=B+"Milliseconds",q)[j],H=j===T?this.$D+(M-this.$W):M;if(j===b||j===h){var W=this.clone().set(w,1);W.$d[U](H),W.init(),this.$d=W.set(w,Math.min(this.$D,W.daysInMonth())).$d}else U&&this.$d[U](H);return this.init(),this},L.set=function(x,M){return this.clone().$set(x,M)},L.get=function(x){return this[m.p(x)]()},L.add=function(x,M){var q,j=this;x=Number(x);var B=m.p(M),U=function(et){var Dt=N(j);return m.w(Dt.date(Dt.date()+Math.round(et*x)),j)};if(B===b)return this.set(b,this.$M+x);if(B===h)return this.set(h,this.$y+x);if(B===T)return U(1);if(B===E)return U(7);var H=(q={},q[f]=n,q[p]=i,q[s]=e,q)[B]||1,W=this.$d.getTime()+x*H;return m.w(W,this)},L.subtract=function(x,M){return this.add(-1*x,M)},L.format=function(x){var M=this,q=this.$locale();if(!this.isValid())return q.invalidDate||O;var j=x||"YYYY-MM-DDTHH:mm:ssZ",B=m.z(this),U=this.$H,H=this.$m,W=this.$M,et=q.weekdays,Dt=q.months,St=function(D,k,Y,Z){return D&&(D[k]||D(M,j))||Y[k].slice(0,Z)},l=function(D){return m.s(U%12||12,D,"0")},u=q.meridiem||function(D,k,Y){var Z=D<12?"AM":"PM";return Y?Z.toLowerCase():Z},_={YY:String(this.$y).slice(-2),YYYY:this.$y,M:W+1,MM:m.s(W+1,2,"0"),MMM:St(q.monthsShort,W,Dt,3),MMMM:St(Dt,W),D:this.$D,DD:m.s(this.$D,2,"0"),d:String(this.$W),dd:St(q.weekdaysMin,this.$W,et,2),ddd:St(q.weekdaysShort,this.$W,et,3),dddd:et[this.$W],H:String(U),HH:m.s(U,2,"0"),h:l(1),hh:l(2),a:u(U,H,!0),A:u(U,H,!1),m:String(H),mm:m.s(H,2,"0"),s:String(this.$s),ss:m.s(this.$s,2,"0"),SSS:m.s(this.$ms,3,"0"),Z:B};return j.replace(P,function(D,k){return k||_[D]||B.replace(":","")})},L.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},L.diff=function(x,M,q){var j,B=m.p(M),U=N(x),H=(U.utcOffset()-this.utcOffset())*n,W=this-U,et=m.m(this,U);return et=(j={},j[h]=et/12,j[b]=et,j[v]=et/3,j[E]=(W-H)/6048e5,j[T]=(W-H)/864e5,j[p]=W/i,j[f]=W/n,j[s]=W/e,j)[B]||W,q?et:m.a(et)},L.daysInMonth=function(){return this.endOf(b).$D},L.$locale=function(){return y[this.$L]},L.locale=function(x,M){if(!x)return this.$L;var q=this.clone(),j=d(x,M,!0);return j&&(q.$L=j),q},L.clone=function(){return m.w(this.$d,this)},L.toDate=function(){return new Date(this.valueOf())},L.toJSON=function(){return this.isValid()?this.toISOString():null},L.toISOString=function(){return this.$d.toISOString()},L.toString=function(){return this.$d.toUTCString()},I}(),A=C.prototype;return N.prototype=A,[["$ms",o],["$s",s],["$m",f],["$H",p],["$W",T],["$M",b],["$y",h],["$D",w]].forEach(function(I){A[I[1]]=function(L){return this.$g(L,I[0],I[1])}}),N.extend=function(I,L){return I.$i||(I(L,C,N),I.$i=!0),N},N.locale=d,N.isDayjs=S,N.unix=function(I){return N(1e3*I)},N.en=y[a],N.Ls=y,N.p={},N})}}),Yr={};so(Yr,{access:()=>Oo,accessFile:()=>ti,assert:()=>Co,blank:()=>Fo,client:()=>_o,clientFile:()=>ei,configure:()=>Io,console:()=>Uo,data:()=>Ro,debug:()=>Xo,error:()=>jo,fatal:()=>$o,header:()=>Ao,headerJson:()=>Mo,info:()=>Lo,logFile:()=>Jr,options:()=>z,print:()=>_t,ring:()=>Pe,state:()=>xo,tags:()=>mt,timed:()=>No,verbose:()=>Bo,warn:()=>qo});ri.exports=ao(Yr);var Zr=Ht(require("os")),Gt=Ht(require("fs")),Rt=Ht(require("path")),ge=Ht(uo()),sr=10,$r=(r=0)=>t=>`\x1B[${t+r}m`,Br=(r=0)=>t=>`\x1B[${38+r};5;${t}m`,Xr=(r=0)=>(t,e,n)=>`\x1B[${38+r};2;${t};${e};${n}m`;function co(){let r=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(let[e,n]of Object.entries(t)){for(let[i,o]of Object.entries(n))t[i]={open:`\x1B[${o[0]}m`,close:`\x1B[${o[1]}m`},n[i]=t[i],r.set(o[0],o[1]);Object.defineProperty(t,e,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:r,enumerable:!1}),t.color.close="\x1B[39m",t.bgColor.close="\x1B[49m",t.color.ansi=$r(),t.color.ansi256=Br(),t.color.ansi16m=Xr(),t.bgColor.ansi=$r(sr),t.bgColor.ansi256=Br(sr),t.bgColor.ansi16m=Xr(sr),Object.defineProperties(t,{rgbToAnsi256:{value:(e,n,i)=>e===n&&n===i?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(n/255*5)+Math.round(i/255*5),enumerable:!1},hexToRgb:{value:e=>{let n=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!n)return[0,0,0];let{colorString:i}=n.groups;i.length===3&&(i=[...i].map(s=>s+s).join(""));let o=Number.parseInt(i,16);return[o>>16&255,o>>8&255,o&255]},enumerable:!1},hexToAnsi256:{value:e=>t.rgbToAnsi256(...t.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value:e=>{if(e<8)return 30+e;if(e<16)return 90+(e-8);let n,i,o;if(e>=232)n=((e-232)*10+8)/255,i=n,o=n;else{e-=16;let p=e%36;n=Math.floor(e/36)/5,i=Math.floor(p/6)/5,o=p%6/5}let s=Math.max(n,i,o)*2;if(s===0)return 30;let f=30+(Math.round(o)<<2|Math.round(i)<<1|Math.round(n));return s===2&&(f+=60),f},enumerable:!1},rgbToAnsi:{value:(e,n,i)=>t.ansi256ToAnsi(t.rgbToAnsi256(e,n,i)),enumerable:!1},hexToAnsi:{value:e=>t.ansi256ToAnsi(t.hexToAnsi256(e)),enumerable:!1}}),t}var lo=co(),Ot=lo,lr=Ht(require("process"),1),ho=Ht(require("os"),1),Ur=Ht(require("tty"),1);function wt(r,t=lr.default.argv){let e=r.startsWith("-")?"":r.length===1?"-":"--",n=t.indexOf(e+r),i=t.indexOf("--");return n!==-1&&(i===-1||n<i)}var{env:J}=lr.default,Ce;wt("no-color")||wt("no-colors")||wt("color=false")||wt("color=never")?Ce=0:(wt("color")||wt("colors")||wt("color=true")||wt("color=always"))&&(Ce=1);function fo(){if("FORCE_COLOR"in J)return J.FORCE_COLOR==="true"?1:J.FORCE_COLOR==="false"?0:J.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(J.FORCE_COLOR,10),3)}function po(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function mo(r,{streamIsTTY:t,sniffFlags:e=!0}={}){let n=fo();n!==void 0&&(Ce=n);let i=e?Ce:n;if(i===0)return 0;if(e){if(wt("color=16m")||wt("color=full")||wt("color=truecolor"))return 3;if(wt("color=256"))return 2}if(r&&!t&&i===void 0)return 0;let o=i||0;if(J.TERM==="dumb")return o;if(lr.default.platform==="win32"){let s=ho.default.release().split(".");return Number(s[0])>=10&&Number(s[2])>=10586?Number(s[2])>=14931?3:2:1}if("CI"in J)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(s=>s in J)||J.CI_NAME==="codeship"?1:o;if("TEAMCITY_VERSION"in J)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(J.TEAMCITY_VERSION)?1:0;if("TF_BUILD"in J&&"AGENT_NAME"in J)return 1;if(J.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in J){let s=Number.parseInt((J.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(J.TERM_PROGRAM){case"iTerm.app":return s>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(J.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(J.TERM)||"COLORTERM"in J?1:o}function kr(r,t={}){let e=mo(r,{streamIsTTY:r&&r.isTTY,...t});return po(e)}var go={stdout:kr({isTTY:Ur.default.isatty(1)}),stderr:kr({isTTY:Ur.default.isatty(2)})},yo=go;function wo(r,t,e){let n=r.indexOf(t);if(n===-1)return r;let i=t.length,o=0,s="";do s+=r.substr(o,n-o)+t+e,o=n+i,n=r.indexOf(t,o);while(n!==-1);return s+=r.slice(o),s}function vo(r,t,e,n){let i=0,o="";do{let s=r[n-1]==="\r";o+=r.substr(i,(s?n-1:n)-i)+t+(s?`\r
`:`
`)+e,i=n+1,n=r.indexOf(`
`,i)}while(n!==-1);return o+=r.slice(i),o}var{stdout:Vr,stderr:zr}=yo,ar=Symbol("GENERATOR"),ie=Symbol("STYLER"),de=Symbol("IS_EMPTY"),Gr=["ansi","ansi","ansi256","ansi16m"],ne=Object.create(null),To=(r,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let e=Vr?Vr.level:0;r.level=t.level===void 0?e:t.level},bo=class{constructor(r){return Kr(r)}},Kr=r=>{let t=(...e)=>e.join(" ");return To(t,r),Object.setPrototypeOf(t,ye.prototype),t};function ye(r){return Kr(r)}Object.setPrototypeOf(ye.prototype,Function.prototype);for(let[r,t]of Object.entries(Ot))ne[r]={get(){let e=Oe(this,cr(t.open,t.close,this[ie]),this[de]);return Object.defineProperty(this,r,{value:e}),e}};ne.visible={get(){let r=Oe(this,this[ie],!0);return Object.defineProperty(this,"visible",{value:r}),r}};var ur=(r,t,e,...n)=>r==="rgb"?t==="ansi16m"?Ot[e].ansi16m(...n):t==="ansi256"?Ot[e].ansi256(Ot.rgbToAnsi256(...n)):Ot[e].ansi(Ot.rgbToAnsi(...n)):r==="hex"?ur("rgb",t,e,...Ot.hexToRgb(...n)):Ot[e][r](...n),Do=["rgb","hex","ansi256"];for(let r of Do){ne[r]={get(){let{level:e}=this;return function(...n){let i=cr(ur(r,Gr[e],"color",...n),Ot.color.close,this[ie]);return Oe(this,i,this[de])}}};let t="bg"+r[0].toUpperCase()+r.slice(1);ne[t]={get(){let{level:e}=this;return function(...n){let i=cr(ur(r,Gr[e],"bgColor",...n),Ot.bgColor.close,this[ie]);return Oe(this,i,this[de])}}}}var So=Object.defineProperties(()=>{},{...ne,level:{enumerable:!0,get(){return this[ar].level},set(r){this[ar].level=r}}}),cr=(r,t,e)=>{let n,i;return e===void 0?(n=r,i=t):(n=e.openAll+r,i=t+e.closeAll),{open:r,close:t,openAll:n,closeAll:i,parent:e}},Oe=(r,t,e)=>{let n=(...i)=>Eo(n,i.length===1?""+i[0]:i.join(" "));return Object.setPrototypeOf(n,So),n[ar]=r,n[ie]=t,n[de]=e,n},Eo=(r,t)=>{if(r.level<=0||!t)return r[de]?"":t;let e=r[ie];if(e===void 0)return t;let{openAll:n,closeAll:i}=e;if(t.includes("\x1B"))for(;e!==void 0;)t=wo(t,e.close,e.open),e=e.parent;let o=t.indexOf(`
`);return o!==-1&&(t=vo(t,i,n,o)),n+t+i};Object.defineProperties(ye.prototype,ne);var Vs=ye(),zs=ye({level:zr?zr.level:0}),Qr=require("console"),Et=new bo({level:2}),Pe=[],z={dateFormat:"YYYY-MM-DD HH:mm:ss",ringLength:100,console:!0,timeStamp:!0},G={logFile:!1,accessFile:!1,clientFile:!1,logStream:void 0,accessStream:void 0,clientStream:void 0},mt={blank:"",continue:":     ",info:Et.cyan("INFO: "),warn:Et.yellow("WARN: "),data:Et.green("DATA: "),error:Et.red("ERROR:"),fatal:Et.bold.red("FATAL:"),assert:Et.italic.bold.red("ASSERT:"),timed:Et.magentaBright("TIMED:"),state:Et.magenta("STATE:"),verbose:Et.bgGray.yellowBright("VERB: "),debug:Et.bgGray.redBright("DEBUG:"),console:Et.gray("CONSOLE:")},Ne={showHidden:!1,depth:5,colors:!0,showProxy:!0,maxArrayLength:1024,maxStringLength:10240,breakLength:200,compact:64,sorted:!1,getters:!1},_e=new Qr.Console({stdout:process.stdout,stderr:process.stderr,ignoreErrors:!0,inspectOptions:Ne});function Po(r){let t="";try{t=JSON.stringify(r)}catch{}return t}function me(...r){let t="";for(let e of r)t+=typeof e=="object"?Po(e):e,t+=" ";return t}function _t(...r){let t=(0,ge.default)(Date.now()).format(z.dateFormat);z.console&&(z.timeStamp?_e.log(t,...r):_e.log(...r))}function Jr(r){typeof r=="string"&&(z.logFile=r,G.logFile=!0,G.logStream=Gt.createWriteStream(Rt.resolve(z.logFile||""),{flags:"a"}),G.logStream&&G.logStream.on("error",t=>{_t(mt.error,"Cannot open application log",z.logFile,t),G.logFile=!1}))}function ti(r){typeof r=="string"&&(z.accessFile=r,G.accessFile=!0,G.accessStream=Gt.createWriteStream(Rt.resolve(z.accessFile),{flags:"a"}),G.accessStream&&G.accessStream.on("error",t=>{_t(mt.error,"Cannot open application log",z.accessFile,t),G.accessFile=!1}))}function ei(r){typeof r=="string"&&(z.clientFile=r,G.clientFile=!0,G.clientStream=Gt.createWriteStream(Rt.resolve(z.clientFile),{flags:"a"}),G.clientStream&&G.clientStream.on("error",t=>{_t(mt.error,"Cannot open application log",z.clientFile,t),G.clientFile=!1}))}async function No(r,...t){arguments.length<2&&(t=[r],r=process.hrtime.bigint());let e=process.hrtime.bigint(),n=0;try{n=parseInt((e-r).toString())}catch{}n=Math.round(n/1e6);let i=(0,ge.default)(Date.now()).format(z.dateFormat);z.console&&_e.log(i,mt.timed,`${n.toLocaleString()} ms`,...t),G.logFile&&G.logStream&&G.logStream.write(`${mt.timed} ${i} ${n.toLocaleString()} ms ${me(...t)}
`)}async function lt(r,...t){let e=(0,ge.default)(Date.now()).format(z.dateFormat);mt[r]?_t(mt[r],...t):_t(...t),G.logFile&&G.logStream&&G.logStream.write(`${e} ${mt[r]} ${me(...t)}
`),Pe.push({tag:r,time:e,msg:me(...t)}),Pe.length>z.ringLength&&Pe.shift()}async function Co(r,t,...e){r!==t&&lt("assert",...e,{res:r,exp:t})}async function Oo(...r){let t=(0,ge.default)(Date.now()).format(z.dateFormat);G.accessFile&&G.accessStream&&G.accessStream.write(`${t} ${me(...r)}
`)}async function _o(...r){let t=(0,ge.default)(Date.now()).format(z.dateFormat);G.clientFile&&G.clientStream&&G.clientStream.write(`${t} ${me(...r)}
`)}function Io(r){!r||(r.dateFormat&&(z.dateFormat=r.dateFormat),r.ringLength&&(z.ringLength=r.ringLength),r.logFile&&Jr(r.logFile),r.accessFile&&ti(r.accessFile),r.clientFile&&ei(r.clientFile),r.inspect&&(Ne={...Ne,...r.inspect}),_e=new Qr.Console({stdout:process.stdout,stderr:process.stderr,ignoreErrors:!0,inspectOptions:Ne}))}function Ao(){let r="./package.json";if(!Gt.existsSync(r))return;let t=JSON.parse(Gt.readFileSync(r).toString());process.title=t.name,lt("info",t.name,"version",t.version),lt("info","User:",Zr.userInfo().username,"Platform:",process.platform,"Arch:",process.arch,"Node:",process.version),z.logFile&&G.logFile&&_t(mt.state,"Application log:",Rt.resolve(z.logFile)),z.accessFile&&G.accessFile&&_t(mt.state,"Access log:",Rt.resolve(z.accessFile)),z.clientFile&&G.clientFile&&_t(mt.state,"Client log:",Rt.resolve(z.clientFile))}function Mo(){let r="./package.json";if(!Gt.existsSync(r))return;let t=JSON.parse(Gt.readFileSync(r).toString());process.title=t.name,lt("info",{application:t.name,version:t.version}),lt("info",{user:Zr.userInfo().username,platform:process.platform,arch:process.arch,node:process.version}),(z.logFile||z.accessFile||z.clientFile)&&_t(mt.state,{log:Rt.resolve(z.logFile||""),access:Rt.resolve(z.accessFile||""),client:Rt.resolve(z.clientFile||"")})}var Fo=(...r)=>lt("blank",...r),Lo=(...r)=>lt("info",...r),xo=(...r)=>lt("state",...r),Ro=(...r)=>lt("data",...r),qo=(...r)=>lt("warn",...r),jo=(...r)=>lt("error",...r),$o=(...r)=>lt("fatal",...r),Bo=(...r)=>lt("verbose",...r),Xo=(...r)=>lt("debug",...r),Uo=(...r)=>lt("console",...r)});var Le=X(hr=>{(function(){hr.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(hr)});var It=X((fi,Bt)=>{(function(){var r,t,e,n,i,o,s,f=[].slice,p={}.hasOwnProperty;r=function(){var T,E,b,v,h,w;if(w=arguments[0],h=2<=arguments.length?f.call(arguments,1):[],i(Object.assign))Object.assign.apply(null,arguments);else for(T=0,b=h.length;T<b;T++)if(v=h[T],v!=null)for(E in v)!p.call(v,E)||(w[E]=v[E]);return w},i=function(T){return!!T&&Object.prototype.toString.call(T)==="[object Function]"},o=function(T){var E;return!!T&&((E=typeof T)=="function"||E==="object")},e=function(T){return i(Array.isArray)?Array.isArray(T):Object.prototype.toString.call(T)==="[object Array]"},n=function(T){var E;if(e(T))return!T.length;for(E in T)if(!!p.call(T,E))return!1;return!0},s=function(T){var E,b;return o(T)&&(b=Object.getPrototypeOf(T))&&(E=b.constructor)&&typeof E=="function"&&E instanceof E&&Function.prototype.toString.call(E)===Function.prototype.toString.call(Object)},t=function(T){return i(T.valueOf)?T.valueOf():T},Bt.exports.assign=r,Bt.exports.isFunction=i,Bt.exports.isObject=o,Bt.exports.isArray=e,Bt.exports.isEmpty=n,Bt.exports.isPlainObject=s,Bt.exports.getValue=t}).call(fi)});var fr=X((pi,di)=>{(function(){var r;di.exports=r=function(){function t(){}return t.prototype.hasFeature=function(e,n){return!0},t.prototype.createDocumentType=function(e,n,i){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(e,n,i){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(e,n){throw new Error("This DOM method is not implemented.")},t}()}).call(pi)});var yi=X((mi,gi)=>{(function(){var r;gi.exports=r=function(){function t(){}return t.prototype.handleError=function(e){throw new Error(e)},t}()}).call(mi)});var Ti=X((wi,vi)=>{(function(){var r;vi.exports=r=function(){function t(e){this.arr=e||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(e){return this.arr[e]||null},t.prototype.contains=function(e){return this.arr.indexOf(e)!==-1},t}()}).call(wi)});var Si=X((bi,Di)=>{(function(){var r,t,e;t=yi(),e=Ti(),Di.exports=r=function(){function n(){var i;this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=i=Object.create(this.defaultParams)}return Object.defineProperty(n.prototype,"parameterNames",{get:function(){return new e(Object.keys(this.defaultParams))}}),n.prototype.getParameter=function(i){return this.params.hasOwnProperty(i)?this.params[i]:null},n.prototype.canSetParameter=function(i,o){return!0},n.prototype.setParameter=function(i,o){return o!=null?this.params[i]=o:delete this.params[i]},n}()}).call(bi)});var Q=X((Ei,Pi)=>{(function(){Pi.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(Ei)});var pr=X((Ni,Ci)=>{(function(){var r,t,e;r=Q(),e=gt(),Ci.exports=t=function(){function n(i,o,s){if(this.parent=i,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),o==null)throw new Error("Missing attribute name. "+this.debugInfo(o));this.name=this.stringify.name(o),this.value=this.stringify.attValue(s),this.type=r.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(n.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(n.prototype,"textContent",{get:function(){return this.value},set:function(i){return this.value=i||""}}),Object.defineProperty(n.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(n.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(n.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(n.prototype,"specified",{get:function(){return!0}}),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return this.options.writer.attribute(this,this.options.writer.filterOptions(i))},n.prototype.debugInfo=function(i){return i=i||this.name,i==null?"parent: <"+this.parent.name+">":"attribute: {"+i+"}, parent: <"+this.parent.name+">"},n.prototype.isEqualNode=function(i){return!(i.namespaceURI!==this.namespaceURI||i.prefix!==this.prefix||i.localName!==this.localName||i.value!==this.value)},n}()}).call(Ni)});var xe=X((Oi,_i)=>{(function(){var r;_i.exports=r=function(){function t(e){this.nodes=e}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(e){return this.nodes[e]},t.prototype.setNamedItem=function(e){var n;return n=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,n||null},t.prototype.removeNamedItem=function(e){var n;return n=this.nodes[e],delete this.nodes[e],n||null},t.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},t.prototype.getNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},t}()}).call(Oi)});var Re=X((Ii,Ai)=>{(function(){var r,t,e,n,i,o,s,f,p,T=function(b,v){for(var h in v)E.call(v,h)&&(b[h]=v[h]);function w(){this.constructor=b}return w.prototype=v.prototype,b.prototype=new w,b.__super__=v.prototype,b},E={}.hasOwnProperty;p=It(),f=p.isObject,s=p.isFunction,o=p.getValue,i=gt(),r=Q(),t=pr(),n=xe(),Ai.exports=e=function(b){T(v,b);function v(h,w,O){var F,P,R,g;if(v.__super__.constructor.call(this,h),w==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(w),this.type=r.Element,this.attribs={},this.schemaTypeInfo=null,O!=null&&this.attribute(O),h.type===r.Document&&(this.isRoot=!0,this.documentObject=h,h.rootObject=this,h.children)){for(g=h.children,P=0,R=g.length;P<R;P++)if(F=g[P],F.type===r.DocType){F.name=this.name;break}}}return Object.defineProperty(v.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(v.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(v.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(v.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(v.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(v.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(v.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(v.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new n(this.attribs)),this.attributeMap}}),v.prototype.clone=function(){var h,w,O,F;O=Object.create(this),O.isRoot&&(O.documentObject=null),O.attribs={},F=this.attribs;for(w in F)!E.call(F,w)||(h=F[w],O.attribs[w]=h.clone());return O.children=[],this.children.forEach(function(P){var R;return R=P.clone(),R.parent=O,O.children.push(R)}),O},v.prototype.attribute=function(h,w){var O,F;if(h!=null&&(h=o(h)),f(h))for(O in h)!E.call(h,O)||(F=h[O],this.attribute(O,F));else s(w)&&(w=w.apply()),this.options.keepNullAttributes&&w==null?this.attribs[h]=new t(this,h,""):w!=null&&(this.attribs[h]=new t(this,h,w));return this},v.prototype.removeAttribute=function(h){var w,O,F;if(h==null)throw new Error("Missing attribute name. "+this.debugInfo());if(h=o(h),Array.isArray(h))for(O=0,F=h.length;O<F;O++)w=h[O],delete this.attribs[w];else delete this.attribs[h];return this},v.prototype.toString=function(h){return this.options.writer.element(this,this.options.writer.filterOptions(h))},v.prototype.att=function(h,w){return this.attribute(h,w)},v.prototype.a=function(h,w){return this.attribute(h,w)},v.prototype.getAttribute=function(h){return this.attribs.hasOwnProperty(h)?this.attribs[h].value:null},v.prototype.setAttribute=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getAttributeNode=function(h){return this.attribs.hasOwnProperty(h)?this.attribs[h]:null},v.prototype.setAttributeNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.removeAttributeNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getAttributeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setAttributeNS=function(h,w,O){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.removeAttributeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getAttributeNodeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setAttributeNodeNS=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagNameNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.hasAttribute=function(h){return this.attribs.hasOwnProperty(h)},v.prototype.hasAttributeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setIdAttribute=function(h,w){return this.attribs.hasOwnProperty(h)?this.attribs[h].isId:w},v.prototype.setIdAttributeNS=function(h,w,O){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setIdAttributeNode=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagNameNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByClassName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isEqualNode=function(h){var w,O,F;if(!v.__super__.isEqualNode.apply(this,arguments).isEqualNode(h)||h.namespaceURI!==this.namespaceURI||h.prefix!==this.prefix||h.localName!==this.localName||h.attribs.length!==this.attribs.length)return!1;for(w=O=0,F=this.attribs.length-1;0<=F?O<=F:O>=F;w=0<=F?++O:--O)if(!this.attribs[w].isEqualNode(h.attribs[w]))return!1;return!0},v}(i)}).call(Ii)});var ve=X((Mi,Fi)=>{(function(){var r,t,e=function(i,o){for(var s in o)n.call(o,s)&&(i[s]=o[s]);function f(){this.constructor=i}return f.prototype=o.prototype,i.prototype=new f,i.__super__=o.prototype,i},n={}.hasOwnProperty;t=gt(),Fi.exports=r=function(i){e(o,i);function o(s){o.__super__.constructor.call(this,s),this.value=""}return Object.defineProperty(o.prototype,"data",{get:function(){return this.value},set:function(s){return this.value=s||""}}),Object.defineProperty(o.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(o.prototype,"textContent",{get:function(){return this.value},set:function(s){return this.value=s||""}}),o.prototype.clone=function(){return Object.create(this)},o.prototype.substringData=function(s,f){throw new Error("This DOM method is not implemented."+this.debugInfo())},o.prototype.appendData=function(s){throw new Error("This DOM method is not implemented."+this.debugInfo())},o.prototype.insertData=function(s,f){throw new Error("This DOM method is not implemented."+this.debugInfo())},o.prototype.deleteData=function(s,f){throw new Error("This DOM method is not implemented."+this.debugInfo())},o.prototype.replaceData=function(s,f,p){throw new Error("This DOM method is not implemented."+this.debugInfo())},o.prototype.isEqualNode=function(s){return!(!o.__super__.isEqualNode.apply(this,arguments).isEqualNode(s)||s.data!==this.data)},o}(t)}).call(Mi)});var qe=X((Li,xi)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;r=Q(),e=ve(),xi.exports=t=function(o){n(s,o);function s(f,p){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=r.CData,this.value=this.stringify.cdata(p)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(f){return this.options.writer.cdata(this,this.options.writer.filterOptions(f))},s}(e)}).call(Li)});var je=X((Ri,qi)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;r=Q(),t=ve(),qi.exports=e=function(o){n(s,o);function s(f,p){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=r.Comment,this.value=this.stringify.comment(p)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(f){return this.options.writer.comment(this,this.options.writer.filterOptions(f))},s}(t)}).call(Ri)});var $e=X((ji,$i)=>{(function(){var r,t,e,n,i=function(s,f){for(var p in f)o.call(f,p)&&(s[p]=f[p]);function T(){this.constructor=s}return T.prototype=f.prototype,s.prototype=new T,s.__super__=f.prototype,s},o={}.hasOwnProperty;n=It().isObject,e=gt(),r=Q(),$i.exports=t=function(s){i(f,s);function f(p,T,E,b){var v;f.__super__.constructor.call(this,p),n(T)&&(v=T,T=v.version,E=v.encoding,b=v.standalone),T||(T="1.0"),this.type=r.Declaration,this.version=this.stringify.xmlVersion(T),E!=null&&(this.encoding=this.stringify.xmlEncoding(E)),b!=null&&(this.standalone=this.stringify.xmlStandalone(b))}return f.prototype.toString=function(p){return this.options.writer.declaration(this,this.options.writer.filterOptions(p))},f}(e)}).call(ji)});var Be=X((Bi,Xi)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;e=gt(),r=Q(),Xi.exports=t=function(o){n(s,o);function s(f,p,T,E,b,v){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(T==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(p));if(!E)throw new Error("Missing DTD attribute type. "+this.debugInfo(p));if(!b)throw new Error("Missing DTD attribute default. "+this.debugInfo(p));if(b.indexOf("#")!==0&&(b="#"+b),!b.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(p));if(v&&!b.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(p));this.elementName=this.stringify.name(p),this.type=r.AttributeDeclaration,this.attributeName=this.stringify.name(T),this.attributeType=this.stringify.dtdAttType(E),v&&(this.defaultValue=this.stringify.dtdAttDefault(v)),this.defaultValueType=b}return s.prototype.toString=function(f){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(f))},s}(e)}).call(Bi)});var Xe=X((Ui,ki)=>{(function(){var r,t,e,n,i=function(s,f){for(var p in f)o.call(f,p)&&(s[p]=f[p]);function T(){this.constructor=s}return T.prototype=f.prototype,s.prototype=new T,s.__super__=f.prototype,s},o={}.hasOwnProperty;n=It().isObject,e=gt(),r=Q(),ki.exports=t=function(s){i(f,s);function f(p,T,E,b){if(f.__super__.constructor.call(this,p),E==null)throw new Error("Missing DTD entity name. "+this.debugInfo(E));if(b==null)throw new Error("Missing DTD entity value. "+this.debugInfo(E));if(this.pe=!!T,this.name=this.stringify.name(E),this.type=r.EntityDeclaration,!n(b))this.value=this.stringify.dtdEntityValue(b),this.internal=!0;else{if(!b.pubID&&!b.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(E));if(b.pubID&&!b.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(E));if(this.internal=!1,b.pubID!=null&&(this.pubID=this.stringify.dtdPubID(b.pubID)),b.sysID!=null&&(this.sysID=this.stringify.dtdSysID(b.sysID)),b.nData!=null&&(this.nData=this.stringify.dtdNData(b.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(E))}}return Object.defineProperty(f.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(f.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(f.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(f.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(f.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(f.prototype,"xmlVersion",{get:function(){return null}}),f.prototype.toString=function(p){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(p))},f}(e)}).call(Ui)});var Ue=X((Vi,zi)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;e=gt(),r=Q(),zi.exports=t=function(o){n(s,o);function s(f,p,T){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing DTD element name. "+this.debugInfo());T||(T="(#PCDATA)"),Array.isArray(T)&&(T="("+T.join(",")+")"),this.name=this.stringify.name(p),this.type=r.ElementDeclaration,this.value=this.stringify.dtdElementValue(T)}return s.prototype.toString=function(f){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(f))},s}(e)}).call(Vi)});var ke=X((Gi,Hi)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;e=gt(),r=Q(),Hi.exports=t=function(o){n(s,o);function s(f,p,T){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing DTD notation name. "+this.debugInfo(p));if(!T.pubID&&!T.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(p));this.name=this.stringify.name(p),this.type=r.NotationDeclaration,T.pubID!=null&&(this.pubID=this.stringify.dtdPubID(T.pubID)),T.sysID!=null&&(this.sysID=this.stringify.dtdSysID(T.sysID))}return Object.defineProperty(s.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(s.prototype,"systemId",{get:function(){return this.sysID}}),s.prototype.toString=function(f){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(f))},s}(e)}).call(Gi)});var Ve=X((Wi,Yi)=>{(function(){var r,t,e,n,i,o,s,f,p,T=function(b,v){for(var h in v)E.call(v,h)&&(b[h]=v[h]);function w(){this.constructor=b}return w.prototype=v.prototype,b.prototype=new w,b.__super__=v.prototype,b},E={}.hasOwnProperty;p=It().isObject,f=gt(),r=Q(),t=Be(),n=Xe(),e=Ue(),i=ke(),s=xe(),Yi.exports=o=function(b){T(v,b);function v(h,w,O){var F,P,R,g,c,a;if(v.__super__.constructor.call(this,h),this.type=r.DocType,h.children){for(g=h.children,P=0,R=g.length;P<R;P++)if(F=g[P],F.type===r.Element){this.name=F.name;break}}this.documentObject=h,p(w)&&(c=w,w=c.pubID,O=c.sysID),O==null&&(a=[w,O],O=a[0],w=a[1]),w!=null&&(this.pubID=this.stringify.dtdPubID(w)),O!=null&&(this.sysID=this.stringify.dtdSysID(O))}return Object.defineProperty(v.prototype,"entities",{get:function(){var h,w,O,F,P;for(F={},P=this.children,w=0,O=P.length;w<O;w++)h=P[w],h.type===r.EntityDeclaration&&!h.pe&&(F[h.name]=h);return new s(F)}}),Object.defineProperty(v.prototype,"notations",{get:function(){var h,w,O,F,P;for(F={},P=this.children,w=0,O=P.length;w<O;w++)h=P[w],h.type===r.NotationDeclaration&&(F[h.name]=h);return new s(F)}}),Object.defineProperty(v.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(v.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(v.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),v.prototype.element=function(h,w){var O;return O=new e(this,h,w),this.children.push(O),this},v.prototype.attList=function(h,w,O,F,P){var R;return R=new t(this,h,w,O,F,P),this.children.push(R),this},v.prototype.entity=function(h,w){var O;return O=new n(this,!1,h,w),this.children.push(O),this},v.prototype.pEntity=function(h,w){var O;return O=new n(this,!0,h,w),this.children.push(O),this},v.prototype.notation=function(h,w){var O;return O=new i(this,h,w),this.children.push(O),this},v.prototype.toString=function(h){return this.options.writer.docType(this,this.options.writer.filterOptions(h))},v.prototype.ele=function(h,w){return this.element(h,w)},v.prototype.att=function(h,w,O,F,P){return this.attList(h,w,O,F,P)},v.prototype.ent=function(h,w){return this.entity(h,w)},v.prototype.pent=function(h,w){return this.pEntity(h,w)},v.prototype.not=function(h,w){return this.notation(h,w)},v.prototype.up=function(){return this.root()||this.documentObject},v.prototype.isEqualNode=function(h){return!(!v.__super__.isEqualNode.apply(this,arguments).isEqualNode(h)||h.name!==this.name||h.publicId!==this.publicId||h.systemId!==this.systemId)},v}(f)}).call(Wi)});var ze=X((Zi,Ki)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;r=Q(),t=gt(),Ki.exports=e=function(o){n(s,o);function s(f,p){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=r.Raw,this.value=this.stringify.raw(p)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(f){return this.options.writer.raw(this,this.options.writer.filterOptions(f))},s}(t)}).call(Zi)});var Ge=X((Qi,Ji)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;r=Q(),t=ve(),Ji.exports=e=function(o){n(s,o);function s(f,p){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=r.Text,this.value=this.stringify.text(p)}return Object.defineProperty(s.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(s.prototype,"wholeText",{get:function(){var f,p,T;for(T="",p=this.previousSibling;p;)T=p.data+T,p=p.previousSibling;for(T+=this.data,f=this.nextSibling;f;)T=T+f.data,f=f.nextSibling;return T}}),s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(f){return this.options.writer.text(this,this.options.writer.filterOptions(f))},s.prototype.splitText=function(f){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.replaceWholeText=function(f){throw new Error("This DOM method is not implemented."+this.debugInfo())},s}(t)}).call(Qi)});var He=X((tn,en)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;r=Q(),t=ve(),en.exports=e=function(o){n(s,o);function s(f,p,T){if(s.__super__.constructor.call(this,f),p==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=r.ProcessingInstruction,this.target=this.stringify.insTarget(p),this.name=this.target,T&&(this.value=this.stringify.insValue(T))}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(f){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(f))},s.prototype.isEqualNode=function(f){return!(!s.__super__.isEqualNode.apply(this,arguments).isEqualNode(f)||f.target!==this.target)},s}(t)}).call(tn)});var dr=X((rn,nn)=>{(function(){var r,t,e,n=function(o,s){for(var f in s)i.call(s,f)&&(o[f]=s[f]);function p(){this.constructor=o}return p.prototype=s.prototype,o.prototype=new p,o.__super__=s.prototype,o},i={}.hasOwnProperty;e=gt(),r=Q(),nn.exports=t=function(o){n(s,o);function s(f){s.__super__.constructor.call(this,f),this.type=r.Dummy}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(f){return""},s}(e)}).call(rn)});var an=X((on,sn)=>{(function(){var r;sn.exports=r=function(){function t(e){this.nodes=e}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(e){return this.nodes[e]||null},t}()}).call(on)});var ln=X((un,cn)=>{(function(){cn.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(un)});var gt=X((hn,fn)=>{(function(){var r,t,e,n,i,o,s,f,p,T,E,b,v,h,w,O,F,P,R,g={}.hasOwnProperty;R=It(),P=R.isObject,F=R.isFunction,O=R.isEmpty,w=R.getValue,f=null,e=null,n=null,i=null,o=null,v=null,h=null,b=null,s=null,t=null,E=null,p=null,r=null,fn.exports=T=function(){function c(a){this.parent=a,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,f||(f=Re(),e=qe(),n=je(),i=$e(),o=Ve(),v=ze(),h=Ge(),b=He(),s=dr(),t=Q(),E=an(),p=xe(),r=ln())}return Object.defineProperty(c.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(c.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(c.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(c.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(c.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new E(this.children)),this.childNodeList}}),Object.defineProperty(c.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(c.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(c.prototype,"previousSibling",{get:function(){var a;return a=this.parent.children.indexOf(this),this.parent.children[a-1]||null}}),Object.defineProperty(c.prototype,"nextSibling",{get:function(){var a;return a=this.parent.children.indexOf(this),this.parent.children[a+1]||null}}),Object.defineProperty(c.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(c.prototype,"textContent",{get:function(){var a,y,S,d,N;if(this.nodeType===t.Element||this.nodeType===t.DocumentFragment){for(N="",d=this.children,y=0,S=d.length;y<S;y++)a=d[y],a.textContent&&(N+=a.textContent);return N}else return null},set:function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),c.prototype.setParent=function(a){var y,S,d,N,m;for(this.parent=a,a&&(this.options=a.options,this.stringify=a.stringify),N=this.children,m=[],S=0,d=N.length;S<d;S++)y=N[S],m.push(y.setParent(this));return m},c.prototype.element=function(a,y,S){var d,N,m,C,A,I,L,x,M,q,j;if(I=null,y===null&&S==null&&(M=[{},null],y=M[0],S=M[1]),y==null&&(y={}),y=w(y),P(y)||(q=[y,S],S=q[0],y=q[1]),a!=null&&(a=w(a)),Array.isArray(a))for(m=0,L=a.length;m<L;m++)N=a[m],I=this.element(N);else if(F(a))I=this.element(a.apply());else if(P(a)){for(A in a)if(!!g.call(a,A))if(j=a[A],F(j)&&(j=j.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&A.indexOf(this.stringify.convertAttKey)===0)I=this.attribute(A.substr(this.stringify.convertAttKey.length),j);else if(!this.options.separateArrayItems&&Array.isArray(j)&&O(j))I=this.dummy();else if(P(j)&&O(j))I=this.element(A);else if(!this.options.keepNullNodes&&j==null)I=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(j))for(C=0,x=j.length;C<x;C++)N=j[C],d={},d[A]=N,I=this.element(d);else P(j)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&A.indexOf(this.stringify.convertTextKey)===0?I=this.element(j):(I=this.element(A),I.element(j)):I=this.element(A,j)}else!this.options.keepNullNodes&&S===null?I=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&a.indexOf(this.stringify.convertTextKey)===0?I=this.text(S):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&a.indexOf(this.stringify.convertCDataKey)===0?I=this.cdata(S):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&a.indexOf(this.stringify.convertCommentKey)===0?I=this.comment(S):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&a.indexOf(this.stringify.convertRawKey)===0?I=this.raw(S):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&a.indexOf(this.stringify.convertPIKey)===0?I=this.instruction(a.substr(this.stringify.convertPIKey.length),S):I=this.node(a,y,S);if(I==null)throw new Error("Could not create any elements with: "+a+". "+this.debugInfo());return I},c.prototype.insertBefore=function(a,y,S){var d,N,m,C,A;if(a?.type)return m=a,C=y,m.setParent(this),C?(N=children.indexOf(C),A=children.splice(N),children.push(m),Array.prototype.push.apply(children,A)):children.push(m),m;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(a));return N=this.parent.children.indexOf(this),A=this.parent.children.splice(N),d=this.parent.element(a,y,S),Array.prototype.push.apply(this.parent.children,A),d},c.prototype.insertAfter=function(a,y,S){var d,N,m;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(a));return N=this.parent.children.indexOf(this),m=this.parent.children.splice(N+1),d=this.parent.element(a,y,S),Array.prototype.push.apply(this.parent.children,m),d},c.prototype.remove=function(){var a,y;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return a=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[a,a-a+1].concat(y=[])),this.parent},c.prototype.node=function(a,y,S){var d,N;return a!=null&&(a=w(a)),y||(y={}),y=w(y),P(y)||(N=[y,S],S=N[0],y=N[1]),d=new f(this,a,y),S!=null&&d.text(S),this.children.push(d),d},c.prototype.text=function(a){var y;return P(a)&&this.element(a),y=new h(this,a),this.children.push(y),this},c.prototype.cdata=function(a){var y;return y=new e(this,a),this.children.push(y),this},c.prototype.comment=function(a){var y;return y=new n(this,a),this.children.push(y),this},c.prototype.commentBefore=function(a){var y,S,d;return S=this.parent.children.indexOf(this),d=this.parent.children.splice(S),y=this.parent.comment(a),Array.prototype.push.apply(this.parent.children,d),this},c.prototype.commentAfter=function(a){var y,S,d;return S=this.parent.children.indexOf(this),d=this.parent.children.splice(S+1),y=this.parent.comment(a),Array.prototype.push.apply(this.parent.children,d),this},c.prototype.raw=function(a){var y;return y=new v(this,a),this.children.push(y),this},c.prototype.dummy=function(){var a;return a=new s(this),a},c.prototype.instruction=function(a,y){var S,d,N,m,C;if(a!=null&&(a=w(a)),y!=null&&(y=w(y)),Array.isArray(a))for(m=0,C=a.length;m<C;m++)S=a[m],this.instruction(S);else if(P(a))for(S in a)!g.call(a,S)||(d=a[S],this.instruction(S,d));else F(y)&&(y=y.apply()),N=new b(this,a,y),this.children.push(N);return this},c.prototype.instructionBefore=function(a,y){var S,d,N;return d=this.parent.children.indexOf(this),N=this.parent.children.splice(d),S=this.parent.instruction(a,y),Array.prototype.push.apply(this.parent.children,N),this},c.prototype.instructionAfter=function(a,y){var S,d,N;return d=this.parent.children.indexOf(this),N=this.parent.children.splice(d+1),S=this.parent.instruction(a,y),Array.prototype.push.apply(this.parent.children,N),this},c.prototype.declaration=function(a,y,S){var d,N;return d=this.document(),N=new i(d,a,y,S),d.children.length===0?d.children.unshift(N):d.children[0].type===t.Declaration?d.children[0]=N:d.children.unshift(N),d.root()||d},c.prototype.dtd=function(a,y){var S,d,N,m,C,A,I,L,x,M;for(d=this.document(),N=new o(d,a,y),x=d.children,m=C=0,I=x.length;C<I;m=++C)if(S=x[m],S.type===t.DocType)return d.children[m]=N,N;for(M=d.children,m=A=0,L=M.length;A<L;m=++A)if(S=M[m],S.isRoot)return d.children.splice(m,0,N),N;return d.children.push(N),N},c.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},c.prototype.root=function(){var a;for(a=this;a;){if(a.type===t.Document)return a.rootObject;if(a.isRoot)return a;a=a.parent}},c.prototype.document=function(){var a;for(a=this;a;){if(a.type===t.Document)return a;a=a.parent}},c.prototype.end=function(a){return this.document().end(a)},c.prototype.prev=function(){var a;if(a=this.parent.children.indexOf(this),a<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[a-1]},c.prototype.next=function(){var a;if(a=this.parent.children.indexOf(this),a===-1||a===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[a+1]},c.prototype.importDocument=function(a){var y;return y=a.root().clone(),y.parent=this,y.isRoot=!1,this.children.push(y),this},c.prototype.debugInfo=function(a){var y,S;return a=a||this.name,a==null&&!((y=this.parent)!=null&&y.name)?"":a==null?"parent: <"+this.parent.name+">":(S=this.parent)!=null&&S.name?"node: <"+a+">, parent: <"+this.parent.name+">":"node: <"+a+">"},c.prototype.ele=function(a,y,S){return this.element(a,y,S)},c.prototype.nod=function(a,y,S){return this.node(a,y,S)},c.prototype.txt=function(a){return this.text(a)},c.prototype.dat=function(a){return this.cdata(a)},c.prototype.com=function(a){return this.comment(a)},c.prototype.ins=function(a,y){return this.instruction(a,y)},c.prototype.doc=function(){return this.document()},c.prototype.dec=function(a,y,S){return this.declaration(a,y,S)},c.prototype.e=function(a,y,S){return this.element(a,y,S)},c.prototype.n=function(a,y,S){return this.node(a,y,S)},c.prototype.t=function(a){return this.text(a)},c.prototype.d=function(a){return this.cdata(a)},c.prototype.c=function(a){return this.comment(a)},c.prototype.r=function(a){return this.raw(a)},c.prototype.i=function(a,y){return this.instruction(a,y)},c.prototype.u=function(){return this.up()},c.prototype.importXMLBuilder=function(a){return this.importDocument(a)},c.prototype.replaceChild=function(a,y){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.removeChild=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.appendChild=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.hasChildNodes=function(){return this.children.length!==0},c.prototype.cloneNode=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.isSupported=function(a,y){return!0},c.prototype.hasAttributes=function(){return this.attribs.length!==0},c.prototype.compareDocumentPosition=function(a){var y,S;return y=this,y===a?0:this.document()!==a.document()?(S=r.Disconnected|r.ImplementationSpecific,Math.random()<.5?S|=r.Preceding:S|=r.Following,S):y.isAncestor(a)?r.Contains|r.Preceding:y.isDescendant(a)?r.Contains|r.Following:y.isPreceding(a)?r.Preceding:r.Following},c.prototype.isSameNode=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.lookupPrefix=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.isDefaultNamespace=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.lookupNamespaceURI=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.isEqualNode=function(a){var y,S,d;if(a.nodeType!==this.nodeType||a.children.length!==this.children.length)return!1;for(y=S=0,d=this.children.length-1;0<=d?S<=d:S>=d;y=0<=d?++S:--S)if(!this.children[y].isEqualNode(a.children[y]))return!1;return!0},c.prototype.getFeature=function(a,y){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.setUserData=function(a,y,S){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getUserData=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.contains=function(a){return a?a===this||this.isDescendant(a):!1},c.prototype.isDescendant=function(a){var y,S,d,N,m;for(m=this.children,d=0,N=m.length;d<N;d++)if(y=m[d],a===y||(S=y.isDescendant(a),S))return!0;return!1},c.prototype.isAncestor=function(a){return a.isDescendant(this)},c.prototype.isPreceding=function(a){var y,S;return y=this.treePosition(a),S=this.treePosition(this),y===-1||S===-1?!1:y<S},c.prototype.isFollowing=function(a){var y,S;return y=this.treePosition(a),S=this.treePosition(this),y===-1||S===-1?!1:y>S},c.prototype.treePosition=function(a){var y,S;return S=0,y=!1,this.foreachTreeNode(this.document(),function(d){if(S++,!y&&d===a)return y=!0}),y?S:-1},c.prototype.foreachTreeNode=function(a,y){var S,d,N,m,C;for(a||(a=this.document()),m=a.children,d=0,N=m.length;d<N;d++){if(S=m[d],C=y(S))return C;if(C=this.foreachTreeNode(S,y),C)return C}},c}()}).call(hn)});var mr=X((pn,dn)=>{(function(){var r,t=function(n,i){return function(){return n.apply(i,arguments)}},e={}.hasOwnProperty;dn.exports=r=function(){function n(i){this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this);var o,s,f;i||(i={}),this.options=i,this.options.version||(this.options.version="1.0"),s=i.stringify||{};for(o in s)!e.call(s,o)||(f=s[o],this[o]=f)}return n.prototype.name=function(i){return this.options.noValidation?i:this.assertLegalName(""+i||"")},n.prototype.text=function(i){return this.options.noValidation?i:this.assertLegalChar(this.textEscape(""+i||""))},n.prototype.cdata=function(i){return this.options.noValidation?i:(i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i))},n.prototype.comment=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},n.prototype.raw=function(i){return this.options.noValidation?i:""+i||""},n.prototype.attValue=function(i){return this.options.noValidation?i:this.assertLegalChar(this.attEscape(i=""+i||""))},n.prototype.insTarget=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.insValue=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return this.assertLegalChar(i)},n.prototype.xmlVersion=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},n.prototype.xmlEncoding=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return this.assertLegalChar(i)},n.prototype.xmlStandalone=function(i){return this.options.noValidation?i:i?"yes":"no"},n.prototype.dtdPubID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdSysID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdElementValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttType=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttDefault=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdEntityValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdNData=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.convertAttKey="@",n.prototype.convertPIKey="?",n.prototype.convertTextKey="#text",n.prototype.convertCDataKey="#cdata",n.prototype.convertCommentKey="#comment",n.prototype.convertRawKey="#raw",n.prototype.assertLegalChar=function(i){var o,s;if(this.options.noValidation)return i;if(o="",this.options.version==="1.0"){if(o=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,s=i.match(o))throw new Error("Invalid character in string: "+i+" at index "+s.index)}else if(this.options.version==="1.1"&&(o=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,s=i.match(o)))throw new Error("Invalid character in string: "+i+" at index "+s.index);return i},n.prototype.assertLegalName=function(i){var o;if(this.options.noValidation)return i;if(this.assertLegalChar(i),o=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!i.match(o))throw new Error("Invalid character in name");return i},n.prototype.textEscape=function(i){var o;return this.options.noValidation?i:(o=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(o,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},n.prototype.attEscape=function(i){var o;return this.options.noValidation?i:(o=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(o,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},n}()}).call(pn)});var Te=X((mn,gn)=>{(function(){gn.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(mn)});var gr=X((yn,wn)=>{(function(){var r,t,e,n,i,o,s,f,p,T,E,b,v,h,w,O,F,P={}.hasOwnProperty;F=It().assign,r=Q(),p=$e(),T=Ve(),e=qe(),n=je(),b=Re(),h=ze(),w=Ge(),v=He(),E=dr(),i=Be(),o=Ue(),s=Xe(),f=ke(),t=Te(),wn.exports=O=function(){function R(g){var c,a,y;g||(g={}),this.options=g,a=g.writer||{};for(c in a)!P.call(a,c)||(y=a[c],this["_"+c]=this[c],this[c]=y)}return R.prototype.filterOptions=function(g){var c,a,y,S,d,N,m,C;return g||(g={}),g=F({},this.options,g),c={writer:this},c.pretty=g.pretty||!1,c.allowEmpty=g.allowEmpty||!1,c.indent=(a=g.indent)!=null?a:"  ",c.newline=(y=g.newline)!=null?y:`
`,c.offset=(S=g.offset)!=null?S:0,c.dontPrettyTextNodes=(d=(N=g.dontPrettyTextNodes)!=null?N:g.dontprettytextnodes)!=null?d:0,c.spaceBeforeSlash=(m=(C=g.spaceBeforeSlash)!=null?C:g.spacebeforeslash)!=null?m:"",c.spaceBeforeSlash===!0&&(c.spaceBeforeSlash=" "),c.suppressPrettyCount=0,c.user={},c.state=t.None,c},R.prototype.indent=function(g,c,a){var y;return!c.pretty||c.suppressPrettyCount?"":c.pretty&&(y=(a||0)+c.offset+1,y>0)?new Array(y).join(c.indent):""},R.prototype.endline=function(g,c,a){return!c.pretty||c.suppressPrettyCount?"":c.newline},R.prototype.attribute=function(g,c,a){var y;return this.openAttribute(g,c,a),y=" "+g.name+'="'+g.value+'"',this.closeAttribute(g,c,a),y},R.prototype.cdata=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<![CDATA[",c.state=t.InsideTag,y+=g.value,c.state=t.CloseTag,y+="]]>"+this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.comment=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<!-- ",c.state=t.InsideTag,y+=g.value,c.state=t.CloseTag,y+=" -->"+this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.declaration=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<?xml",c.state=t.InsideTag,y+=' version="'+g.version+'"',g.encoding!=null&&(y+=' encoding="'+g.encoding+'"'),g.standalone!=null&&(y+=' standalone="'+g.standalone+'"'),c.state=t.CloseTag,y+=c.spaceBeforeSlash+"?>",y+=this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.docType=function(g,c,a){var y,S,d,N,m;if(a||(a=0),this.openNode(g,c,a),c.state=t.OpenTag,N=this.indent(g,c,a),N+="<!DOCTYPE "+g.root().name,g.pubID&&g.sysID?N+=' PUBLIC "'+g.pubID+'" "'+g.sysID+'"':g.sysID&&(N+=' SYSTEM "'+g.sysID+'"'),g.children.length>0){for(N+=" [",N+=this.endline(g,c,a),c.state=t.InsideTag,m=g.children,S=0,d=m.length;S<d;S++)y=m[S],N+=this.writeChildNode(y,c,a+1);c.state=t.CloseTag,N+="]"}return c.state=t.CloseTag,N+=c.spaceBeforeSlash+">",N+=this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),N},R.prototype.element=function(g,c,a){var y,S,d,N,m,C,A,I,L,x,M,q,j,B;a||(a=0),x=!1,M="",this.openNode(g,c,a),c.state=t.OpenTag,M+=this.indent(g,c,a)+"<"+g.name,q=g.attribs;for(L in q)!P.call(q,L)||(y=q[L],M+=this.attribute(y,c,a));if(d=g.children.length,N=d===0?null:g.children[0],d===0||g.children.every(function(U){return(U.type===r.Text||U.type===r.Raw)&&U.value===""}))c.allowEmpty?(M+=">",c.state=t.CloseTag,M+="</"+g.name+">"+this.endline(g,c,a)):(c.state=t.CloseTag,M+=c.spaceBeforeSlash+"/>"+this.endline(g,c,a));else if(c.pretty&&d===1&&(N.type===r.Text||N.type===r.Raw)&&N.value!=null)M+=">",c.state=t.InsideTag,c.suppressPrettyCount++,x=!0,M+=this.writeChildNode(N,c,a+1),c.suppressPrettyCount--,x=!1,c.state=t.CloseTag,M+="</"+g.name+">"+this.endline(g,c,a);else{if(c.dontPrettyTextNodes){for(j=g.children,m=0,A=j.length;m<A;m++)if(S=j[m],(S.type===r.Text||S.type===r.Raw)&&S.value!=null){c.suppressPrettyCount++,x=!0;break}}for(M+=">"+this.endline(g,c,a),c.state=t.InsideTag,B=g.children,C=0,I=B.length;C<I;C++)S=B[C],M+=this.writeChildNode(S,c,a+1);c.state=t.CloseTag,M+=this.indent(g,c,a)+"</"+g.name+">",x&&c.suppressPrettyCount--,M+=this.endline(g,c,a),c.state=t.None}return this.closeNode(g,c,a),M},R.prototype.writeChildNode=function(g,c,a){switch(g.type){case r.CData:return this.cdata(g,c,a);case r.Comment:return this.comment(g,c,a);case r.Element:return this.element(g,c,a);case r.Raw:return this.raw(g,c,a);case r.Text:return this.text(g,c,a);case r.ProcessingInstruction:return this.processingInstruction(g,c,a);case r.Dummy:return"";case r.Declaration:return this.declaration(g,c,a);case r.DocType:return this.docType(g,c,a);case r.AttributeDeclaration:return this.dtdAttList(g,c,a);case r.ElementDeclaration:return this.dtdElement(g,c,a);case r.EntityDeclaration:return this.dtdEntity(g,c,a);case r.NotationDeclaration:return this.dtdNotation(g,c,a);default:throw new Error("Unknown XML node type: "+g.constructor.name)}},R.prototype.processingInstruction=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<?",c.state=t.InsideTag,y+=g.target,g.value&&(y+=" "+g.value),c.state=t.CloseTag,y+=c.spaceBeforeSlash+"?>",y+=this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.raw=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a),c.state=t.InsideTag,y+=g.value,c.state=t.CloseTag,y+=this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.text=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a),c.state=t.InsideTag,y+=g.value,c.state=t.CloseTag,y+=this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.dtdAttList=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<!ATTLIST",c.state=t.InsideTag,y+=" "+g.elementName+" "+g.attributeName+" "+g.attributeType,g.defaultValueType!=="#DEFAULT"&&(y+=" "+g.defaultValueType),g.defaultValue&&(y+=' "'+g.defaultValue+'"'),c.state=t.CloseTag,y+=c.spaceBeforeSlash+">"+this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.dtdElement=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<!ELEMENT",c.state=t.InsideTag,y+=" "+g.name+" "+g.value,c.state=t.CloseTag,y+=c.spaceBeforeSlash+">"+this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.dtdEntity=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<!ENTITY",c.state=t.InsideTag,g.pe&&(y+=" %"),y+=" "+g.name,g.value?y+=' "'+g.value+'"':(g.pubID&&g.sysID?y+=' PUBLIC "'+g.pubID+'" "'+g.sysID+'"':g.sysID&&(y+=' SYSTEM "'+g.sysID+'"'),g.nData&&(y+=" NDATA "+g.nData)),c.state=t.CloseTag,y+=c.spaceBeforeSlash+">"+this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.dtdNotation=function(g,c,a){var y;return this.openNode(g,c,a),c.state=t.OpenTag,y=this.indent(g,c,a)+"<!NOTATION",c.state=t.InsideTag,y+=" "+g.name,g.pubID&&g.sysID?y+=' PUBLIC "'+g.pubID+'" "'+g.sysID+'"':g.pubID?y+=' PUBLIC "'+g.pubID+'"':g.sysID&&(y+=' SYSTEM "'+g.sysID+'"'),c.state=t.CloseTag,y+=c.spaceBeforeSlash+">"+this.endline(g,c,a),c.state=t.None,this.closeNode(g,c,a),y},R.prototype.openNode=function(g,c,a){},R.prototype.closeNode=function(g,c,a){},R.prototype.openAttribute=function(g,c,a){},R.prototype.closeAttribute=function(g,c,a){},R}()}).call(yn)});var We=X((vn,Tn)=>{(function(){var r,t,e=function(i,o){for(var s in o)n.call(o,s)&&(i[s]=o[s]);function f(){this.constructor=i}return f.prototype=o.prototype,i.prototype=new f,i.__super__=o.prototype,i},n={}.hasOwnProperty;t=gr(),Tn.exports=r=function(i){e(o,i);function o(s){o.__super__.constructor.call(this,s)}return o.prototype.document=function(s,f){var p,T,E,b,v;for(f=this.filterOptions(f),b="",v=s.children,T=0,E=v.length;T<E;T++)p=v[T],b+=this.writeChildNode(p,f,0);return f.pretty&&b.slice(-f.newline.length)===f.newline&&(b=b.slice(0,-f.newline.length)),b},o}(t)}).call(vn)});var yr=X((bn,Dn)=>{(function(){var r,t,e,n,i,o,s,f,p=function(E,b){for(var v in b)T.call(b,v)&&(E[v]=b[v]);function h(){this.constructor=E}return h.prototype=b.prototype,E.prototype=new h,E.__super__=b.prototype,E},T={}.hasOwnProperty;f=It().isPlainObject,e=fr(),t=Si(),i=gt(),r=Q(),s=mr(),o=We(),Dn.exports=n=function(E){p(b,E);function b(v){b.__super__.constructor.call(this,null),this.name="#document",this.type=r.Document,this.documentURI=null,this.domConfig=new t,v||(v={}),v.writer||(v.writer=new o),this.options=v,this.stringify=new s(v)}return Object.defineProperty(b.prototype,"implementation",{value:new e}),Object.defineProperty(b.prototype,"doctype",{get:function(){var v,h,w,O;for(O=this.children,h=0,w=O.length;h<w;h++)if(v=O[h],v.type===r.DocType)return v;return null}}),Object.defineProperty(b.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(b.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(b.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(b.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].encoding:null}}),Object.defineProperty(b.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(b.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(b.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(b.prototype,"origin",{get:function(){return null}}),Object.defineProperty(b.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(b.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(b.prototype,"contentType",{get:function(){return null}}),b.prototype.end=function(v){var h;return h={},v?f(v)&&(h=v,v=this.options.writer):v=this.options.writer,v.document(this,v.filterOptions(h))},b.prototype.toString=function(v){return this.options.writer.document(this,this.options.writer.filterOptions(v))},b.prototype.createElement=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createTextNode=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createComment=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createCDATASection=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createProcessingInstruction=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createAttribute=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createEntityReference=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByTagName=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.importNode=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createElementNS=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createAttributeNS=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByTagNameNS=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementById=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.adoptNode=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.renameNode=function(v,h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByClassName=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createEvent=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createNodeIterator=function(v,h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createTreeWalker=function(v,h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b}(i)}).call(bn)});var Pn=X((Sn,En)=>{(function(){var r,t,e,n,i,o,s,f,p,T,E,b,v,h,w,O,F,P,R,g,c,a,y,S,d={}.hasOwnProperty;S=It(),a=S.isObject,c=S.isFunction,y=S.isPlainObject,g=S.getValue,r=Q(),b=yr(),h=Re(),n=qe(),i=je(),O=ze(),R=Ge(),w=He(),T=$e(),E=Ve(),o=Be(),f=Xe(),s=Ue(),p=ke(),e=pr(),P=mr(),F=We(),t=Te(),En.exports=v=function(){function N(m,C,A){var I;this.name="?xml",this.type=r.Document,m||(m={}),I={},m.writer?y(m.writer)&&(I=m.writer,m.writer=new F):m.writer=new F,this.options=m,this.writer=m.writer,this.writerOptions=this.writer.filterOptions(I),this.stringify=new P(m),this.onDataCallback=C||function(){},this.onEndCallback=A||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return N.prototype.createChildNode=function(m){var C,A,I,L,x,M,q,j;switch(m.type){case r.CData:this.cdata(m.value);break;case r.Comment:this.comment(m.value);break;case r.Element:I={},q=m.attribs;for(A in q)!d.call(q,A)||(C=q[A],I[A]=C.value);this.node(m.name,I);break;case r.Dummy:this.dummy();break;case r.Raw:this.raw(m.value);break;case r.Text:this.text(m.value);break;case r.ProcessingInstruction:this.instruction(m.target,m.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+m.constructor.name)}for(j=m.children,x=0,M=j.length;x<M;x++)L=j[x],this.createChildNode(L),L.type===r.Element&&this.up();return this},N.prototype.dummy=function(){return this},N.prototype.node=function(m,C,A){var I;if(m==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(m));return this.openCurrent(),m=g(m),C==null&&(C={}),C=g(C),a(C)||(I=[C,A],A=I[0],C=I[1]),this.currentNode=new h(this,m,C),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,A!=null&&this.text(A),this},N.prototype.element=function(m,C,A){var I,L,x,M,q,j;if(this.currentNode&&this.currentNode.type===r.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(m)||a(m)||c(m))for(M=this.options.noValidation,this.options.noValidation=!0,j=new b(this.options).element("TEMP_ROOT"),j.element(m),this.options.noValidation=M,q=j.children,L=0,x=q.length;L<x;L++)I=q[L],this.createChildNode(I),I.type===r.Element&&this.up();else this.node(m,C,A);return this},N.prototype.attribute=function(m,C){var A,I;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(m));if(m!=null&&(m=g(m)),a(m))for(A in m)!d.call(m,A)||(I=m[A],this.attribute(A,I));else c(C)&&(C=C.apply()),this.options.keepNullAttributes&&C==null?this.currentNode.attribs[m]=new e(this,m,""):C!=null&&(this.currentNode.attribs[m]=new e(this,m,C));return this},N.prototype.text=function(m){var C;return this.openCurrent(),C=new R(this,m),this.onData(this.writer.text(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.cdata=function(m){var C;return this.openCurrent(),C=new n(this,m),this.onData(this.writer.cdata(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.comment=function(m){var C;return this.openCurrent(),C=new i(this,m),this.onData(this.writer.comment(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.raw=function(m){var C;return this.openCurrent(),C=new O(this,m),this.onData(this.writer.raw(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.instruction=function(m,C){var A,I,L,x,M;if(this.openCurrent(),m!=null&&(m=g(m)),C!=null&&(C=g(C)),Array.isArray(m))for(A=0,x=m.length;A<x;A++)I=m[A],this.instruction(I);else if(a(m))for(I in m)!d.call(m,I)||(L=m[I],this.instruction(I,L));else c(C)&&(C=C.apply()),M=new w(this,m,C),this.onData(this.writer.processingInstruction(M,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},N.prototype.declaration=function(m,C,A){var I;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return I=new T(this,m,C,A),this.onData(this.writer.declaration(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.doctype=function(m,C,A){if(this.openCurrent(),m==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new E(this,C,A),this.currentNode.rootNodeName=m,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},N.prototype.dtdElement=function(m,C){var A;return this.openCurrent(),A=new s(this,m,C),this.onData(this.writer.dtdElement(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.attList=function(m,C,A,I,L){var x;return this.openCurrent(),x=new o(this,m,C,A,I,L),this.onData(this.writer.dtdAttList(x,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.entity=function(m,C){var A;return this.openCurrent(),A=new f(this,!1,m,C),this.onData(this.writer.dtdEntity(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.pEntity=function(m,C){var A;return this.openCurrent(),A=new f(this,!0,m,C),this.onData(this.writer.dtdEntity(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.notation=function(m,C){var A;return this.openCurrent(),A=new p(this,m,C),this.onData(this.writer.dtdNotation(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},N.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},N.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},N.prototype.openNode=function(m){var C,A,I,L;if(!m.isOpen){if(!this.root&&this.currentLevel===0&&m.type===r.Element&&(this.root=m),A="",m.type===r.Element){this.writerOptions.state=t.OpenTag,A=this.writer.indent(m,this.writerOptions,this.currentLevel)+"<"+m.name,L=m.attribs;for(I in L)!d.call(L,I)||(C=L[I],A+=this.writer.attribute(C,this.writerOptions,this.currentLevel));A+=(m.children?">":"/>")+this.writer.endline(m,this.writerOptions,this.currentLevel),this.writerOptions.state=t.InsideTag}else this.writerOptions.state=t.OpenTag,A=this.writer.indent(m,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+m.rootNodeName,m.pubID&&m.sysID?A+=' PUBLIC "'+m.pubID+'" "'+m.sysID+'"':m.sysID&&(A+=' SYSTEM "'+m.sysID+'"'),m.children?(A+=" [",this.writerOptions.state=t.InsideTag):(this.writerOptions.state=t.CloseTag,A+=">"),A+=this.writer.endline(m,this.writerOptions,this.currentLevel);return this.onData(A,this.currentLevel),m.isOpen=!0}},N.prototype.closeNode=function(m){var C;if(!m.isClosed)return C="",this.writerOptions.state=t.CloseTag,m.type===r.Element?C=this.writer.indent(m,this.writerOptions,this.currentLevel)+"</"+m.name+">"+this.writer.endline(m,this.writerOptions,this.currentLevel):C=this.writer.indent(m,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(m,this.writerOptions,this.currentLevel),this.writerOptions.state=t.None,this.onData(C,this.currentLevel),m.isClosed=!0},N.prototype.onData=function(m,C){return this.documentStarted=!0,this.onDataCallback(m,C+1)},N.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},N.prototype.debugInfo=function(m){return m==null?"":"node: <"+m+">"},N.prototype.ele=function(){return this.element.apply(this,arguments)},N.prototype.nod=function(m,C,A){return this.node(m,C,A)},N.prototype.txt=function(m){return this.text(m)},N.prototype.dat=function(m){return this.cdata(m)},N.prototype.com=function(m){return this.comment(m)},N.prototype.ins=function(m,C){return this.instruction(m,C)},N.prototype.dec=function(m,C,A){return this.declaration(m,C,A)},N.prototype.dtd=function(m,C,A){return this.doctype(m,C,A)},N.prototype.e=function(m,C,A){return this.element(m,C,A)},N.prototype.n=function(m,C,A){return this.node(m,C,A)},N.prototype.t=function(m){return this.text(m)},N.prototype.d=function(m){return this.cdata(m)},N.prototype.c=function(m){return this.comment(m)},N.prototype.r=function(m){return this.raw(m)},N.prototype.i=function(m,C){return this.instruction(m,C)},N.prototype.att=function(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},N.prototype.a=function(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},N.prototype.ent=function(m,C){return this.entity(m,C)},N.prototype.pent=function(m,C){return this.pEntity(m,C)},N.prototype.not=function(m,C){return this.notation(m,C)},N}()}).call(Sn)});var On=X((Nn,Cn)=>{(function(){var r,t,e,n,i=function(s,f){for(var p in f)o.call(f,p)&&(s[p]=f[p]);function T(){this.constructor=s}return T.prototype=f.prototype,s.prototype=new T,s.__super__=f.prototype,s},o={}.hasOwnProperty;r=Q(),n=gr(),t=Te(),Cn.exports=e=function(s){i(f,s);function f(p,T){this.stream=p,f.__super__.constructor.call(this,T)}return f.prototype.endline=function(p,T,E){return p.isLastRootNode&&T.state===t.CloseTag?"":f.__super__.endline.call(this,p,T,E)},f.prototype.document=function(p,T){var E,b,v,h,w,O,F,P,R;for(F=p.children,b=v=0,w=F.length;v<w;b=++v)E=F[b],E.isLastRootNode=b===p.children.length-1;for(T=this.filterOptions(T),P=p.children,R=[],h=0,O=P.length;h<O;h++)E=P[h],R.push(this.writeChildNode(E,T,0));return R},f.prototype.attribute=function(p,T,E){return this.stream.write(f.__super__.attribute.call(this,p,T,E))},f.prototype.cdata=function(p,T,E){return this.stream.write(f.__super__.cdata.call(this,p,T,E))},f.prototype.comment=function(p,T,E){return this.stream.write(f.__super__.comment.call(this,p,T,E))},f.prototype.declaration=function(p,T,E){return this.stream.write(f.__super__.declaration.call(this,p,T,E))},f.prototype.docType=function(p,T,E){var b,v,h,w;if(E||(E=0),this.openNode(p,T,E),T.state=t.OpenTag,this.stream.write(this.indent(p,T,E)),this.stream.write("<!DOCTYPE "+p.root().name),p.pubID&&p.sysID?this.stream.write(' PUBLIC "'+p.pubID+'" "'+p.sysID+'"'):p.sysID&&this.stream.write(' SYSTEM "'+p.sysID+'"'),p.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(p,T,E)),T.state=t.InsideTag,w=p.children,v=0,h=w.length;v<h;v++)b=w[v],this.writeChildNode(b,T,E+1);T.state=t.CloseTag,this.stream.write("]")}return T.state=t.CloseTag,this.stream.write(T.spaceBeforeSlash+">"),this.stream.write(this.endline(p,T,E)),T.state=t.None,this.closeNode(p,T,E)},f.prototype.element=function(p,T,E){var b,v,h,w,O,F,P,R,g,c;E||(E=0),this.openNode(p,T,E),T.state=t.OpenTag,this.stream.write(this.indent(p,T,E)+"<"+p.name),g=p.attribs;for(P in g)!o.call(g,P)||(b=g[P],this.attribute(b,T,E));if(h=p.children.length,w=h===0?null:p.children[0],h===0||p.children.every(function(a){return(a.type===r.Text||a.type===r.Raw)&&a.value===""}))T.allowEmpty?(this.stream.write(">"),T.state=t.CloseTag,this.stream.write("</"+p.name+">")):(T.state=t.CloseTag,this.stream.write(T.spaceBeforeSlash+"/>"));else if(T.pretty&&h===1&&(w.type===r.Text||w.type===r.Raw)&&w.value!=null)this.stream.write(">"),T.state=t.InsideTag,T.suppressPrettyCount++,R=!0,this.writeChildNode(w,T,E+1),T.suppressPrettyCount--,R=!1,T.state=t.CloseTag,this.stream.write("</"+p.name+">");else{for(this.stream.write(">"+this.endline(p,T,E)),T.state=t.InsideTag,c=p.children,O=0,F=c.length;O<F;O++)v=c[O],this.writeChildNode(v,T,E+1);T.state=t.CloseTag,this.stream.write(this.indent(p,T,E)+"</"+p.name+">")}return this.stream.write(this.endline(p,T,E)),T.state=t.None,this.closeNode(p,T,E)},f.prototype.processingInstruction=function(p,T,E){return this.stream.write(f.__super__.processingInstruction.call(this,p,T,E))},f.prototype.raw=function(p,T,E){return this.stream.write(f.__super__.raw.call(this,p,T,E))},f.prototype.text=function(p,T,E){return this.stream.write(f.__super__.text.call(this,p,T,E))},f.prototype.dtdAttList=function(p,T,E){return this.stream.write(f.__super__.dtdAttList.call(this,p,T,E))},f.prototype.dtdElement=function(p,T,E){return this.stream.write(f.__super__.dtdElement.call(this,p,T,E))},f.prototype.dtdEntity=function(p,T,E){return this.stream.write(f.__super__.dtdEntity.call(this,p,T,E))},f.prototype.dtdNotation=function(p,T,E){return this.stream.write(f.__super__.dtdNotation.call(this,p,T,E))},f}(n)}).call(Nn)});var In=X((_n,Xt)=>{(function(){var r,t,e,n,i,o,s,f,p,T;T=It(),f=T.assign,p=T.isFunction,e=fr(),n=yr(),i=Pn(),s=We(),o=On(),r=Q(),t=Te(),Xt.exports.create=function(E,b,v,h){var w,O;if(E==null)throw new Error("Root element needs a name.");return h=f({},b,v,h),w=new n(h),O=w.element(E),h.headless||(w.declaration(h),(h.pubID!=null||h.sysID!=null)&&w.dtd(h)),O},Xt.exports.begin=function(E,b,v){var h;return p(E)&&(h=[E,b],b=h[0],v=h[1],E={}),b?new i(E,b,v):new n(E)},Xt.exports.stringWriter=function(E){return new s(E)},Xt.exports.streamWriter=function(E,b){return new o(E,b)},Xt.exports.implementation=new e,Xt.exports.nodeType=r,Xt.exports.writerState=t}).call(_n)});var An=X(wr=>{(function(){"use strict";var r,t,e,n,i,o={}.hasOwnProperty;r=In(),t=Le().defaults,n=function(s){return typeof s=="string"&&(s.indexOf("&")>=0||s.indexOf(">")>=0||s.indexOf("<")>=0)},i=function(s){return"<![CDATA["+e(s)+"]]>"},e=function(s){return s.replace("]]>","]]]]><![CDATA[>")},wr.Builder=function(){function s(f){var p,T,E;this.options={},T=t["0.2"];for(p in T)!o.call(T,p)||(E=T[p],this.options[p]=E);for(p in f)!o.call(f,p)||(E=f[p],this.options[p]=E)}return s.prototype.buildObject=function(f){var p,T,E,b,v;return p=this.options.attrkey,T=this.options.charkey,Object.keys(f).length===1&&this.options.rootName===t["0.2"].rootName?(v=Object.keys(f)[0],f=f[v]):v=this.options.rootName,E=function(h){return function(w,O){var F,P,R,g,c,a;if(typeof O!="object")h.options.cdata&&n(O)?w.raw(i(O)):w.txt(O);else if(Array.isArray(O)){for(g in O)if(!!o.call(O,g)){P=O[g];for(c in P)R=P[c],w=E(w.ele(c),R).up()}}else for(c in O)if(!!o.call(O,c))if(P=O[c],c===p){if(typeof P=="object")for(F in P)a=P[F],w=w.att(F,a)}else if(c===T)h.options.cdata&&n(P)?w=w.raw(i(P)):w=w.txt(P);else if(Array.isArray(P))for(g in P)!o.call(P,g)||(R=P[g],typeof R=="string"?h.options.cdata&&n(R)?w=w.ele(c).raw(i(R)).up():w=w.ele(c,R).up():w=E(w.ele(c),R).up());else typeof P=="object"?w=E(w.ele(c),P).up():typeof P=="string"&&h.options.cdata&&n(P)?w=w.ele(c).raw(i(P)).up():(P==null&&(P=""),w=w.ele(c,P.toString()).up());return w}}(this),b=r.create(v,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),E(b,f).end(this.options.renderOpts)},s}()}).call(wr)});var Mn=X(Ye=>{(function(r){r.parser=function(l,u){return new e(l,u)},r.SAXParser=e,r.SAXStream=T,r.createStream=p,r.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];r.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function e(l,u){if(!(this instanceof e))return new e(l,u);var _=this;i(_),_.q=_.c="",_.bufferCheckPosition=r.MAX_BUFFER_LENGTH,_.opt=u||{},_.opt.lowercase=_.opt.lowercase||_.opt.lowercasetags,_.looseCase=_.opt.lowercase?"toLowerCase":"toUpperCase",_.tags=[],_.closed=_.closedRoot=_.sawRoot=!1,_.tag=_.error=null,_.strict=!!l,_.noscript=!!(l||_.opt.noscript),_.state=d.BEGIN,_.strictEntities=_.opt.strictEntities,_.ENTITIES=_.strictEntities?Object.create(r.XML_ENTITIES):Object.create(r.ENTITIES),_.attribList=[],_.opt.xmlns&&(_.ns=Object.create(w)),_.trackPosition=_.opt.position!==!1,_.trackPosition&&(_.position=_.line=_.column=0),m(_,"onready")}Object.create||(Object.create=function(l){function u(){}u.prototype=l;var _=new u;return _}),Object.keys||(Object.keys=function(l){var u=[];for(var _ in l)l.hasOwnProperty(_)&&u.push(_);return u});function n(l){for(var u=Math.max(r.MAX_BUFFER_LENGTH,10),_=0,D=0,k=t.length;D<k;D++){var Y=l[t[D]].length;if(Y>u)switch(t[D]){case"textNode":A(l);break;case"cdata":C(l,"oncdata",l.cdata),l.cdata="";break;case"script":C(l,"onscript",l.script),l.script="";break;default:L(l,"Max buffer length exceeded: "+t[D])}_=Math.max(_,Y)}var Z=r.MAX_BUFFER_LENGTH-_;l.bufferCheckPosition=Z+l.position}function i(l){for(var u=0,_=t.length;u<_;u++)l[t[u]]=""}function o(l){A(l),l.cdata!==""&&(C(l,"oncdata",l.cdata),l.cdata=""),l.script!==""&&(C(l,"onscript",l.script),l.script="")}e.prototype={end:function(){x(this)},write:St,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){o(this)}};var s;try{s=require("stream").Stream}catch{s=function(){}}var f=r.EVENTS.filter(function(l){return l!=="error"&&l!=="end"});function p(l,u){return new T(l,u)}function T(l,u){if(!(this instanceof T))return new T(l,u);s.apply(this),this._parser=new e(l,u),this.writable=!0,this.readable=!0;var _=this;this._parser.onend=function(){_.emit("end")},this._parser.onerror=function(D){_.emit("error",D),_._parser.error=null},this._decoder=null,f.forEach(function(D){Object.defineProperty(_,"on"+D,{get:function(){return _._parser["on"+D]},set:function(k){if(!k)return _.removeAllListeners(D),_._parser["on"+D]=k,k;_.on(D,k)},enumerable:!0,configurable:!1})})}T.prototype=Object.create(s.prototype,{constructor:{value:T}}),T.prototype.write=function(l){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(l)){if(!this._decoder){var u=require("string_decoder").StringDecoder;this._decoder=new u("utf8")}l=this._decoder.write(l)}return this._parser.write(l.toString()),this.emit("data",l),!0},T.prototype.end=function(l){return l&&l.length&&this.write(l),this._parser.end(),!0},T.prototype.on=function(l,u){var _=this;return!_._parser["on"+l]&&f.indexOf(l)!==-1&&(_._parser["on"+l]=function(){var D=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);D.splice(0,0,l),_.emit.apply(_,D)}),s.prototype.on.call(_,l,u)};var E="[CDATA[",b="DOCTYPE",v="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",w={xml:v,xmlns:h},O=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,F=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,P=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,R=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(l){return l===" "||l===`
`||l==="\r"||l==="	"}function c(l){return l==='"'||l==="'"}function a(l){return l===">"||g(l)}function y(l,u){return l.test(u)}function S(l,u){return!y(l,u)}var d=0;r.STATE={BEGIN:d++,BEGIN_WHITESPACE:d++,TEXT:d++,TEXT_ENTITY:d++,OPEN_WAKA:d++,SGML_DECL:d++,SGML_DECL_QUOTED:d++,DOCTYPE:d++,DOCTYPE_QUOTED:d++,DOCTYPE_DTD:d++,DOCTYPE_DTD_QUOTED:d++,COMMENT_STARTING:d++,COMMENT:d++,COMMENT_ENDING:d++,COMMENT_ENDED:d++,CDATA:d++,CDATA_ENDING:d++,CDATA_ENDING_2:d++,PROC_INST:d++,PROC_INST_BODY:d++,PROC_INST_ENDING:d++,OPEN_TAG:d++,OPEN_TAG_SLASH:d++,ATTRIB:d++,ATTRIB_NAME:d++,ATTRIB_NAME_SAW_WHITE:d++,ATTRIB_VALUE:d++,ATTRIB_VALUE_QUOTED:d++,ATTRIB_VALUE_CLOSED:d++,ATTRIB_VALUE_UNQUOTED:d++,ATTRIB_VALUE_ENTITY_Q:d++,ATTRIB_VALUE_ENTITY_U:d++,CLOSE_TAG:d++,CLOSE_TAG_SAW_WHITE:d++,SCRIPT:d++,SCRIPT_ENDING:d++},r.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},r.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(r.ENTITIES).forEach(function(l){var u=r.ENTITIES[l],_=typeof u=="number"?String.fromCharCode(u):u;r.ENTITIES[l]=_});for(var N in r.STATE)r.STATE[r.STATE[N]]=N;d=r.STATE;function m(l,u,_){l[u]&&l[u](_)}function C(l,u,_){l.textNode&&A(l),m(l,u,_)}function A(l){l.textNode=I(l.opt,l.textNode),l.textNode&&m(l,"ontext",l.textNode),l.textNode=""}function I(l,u){return l.trim&&(u=u.trim()),l.normalize&&(u=u.replace(/\s+/g," ")),u}function L(l,u){return A(l),l.trackPosition&&(u+=`
Line: `+l.line+`
Column: `+l.column+`
Char: `+l.c),u=new Error(u),l.error=u,m(l,"onerror",u),l}function x(l){return l.sawRoot&&!l.closedRoot&&M(l,"Unclosed root tag"),l.state!==d.BEGIN&&l.state!==d.BEGIN_WHITESPACE&&l.state!==d.TEXT&&L(l,"Unexpected end"),A(l),l.c="",l.closed=!0,m(l,"onend"),e.call(l,l.strict,l.opt),l}function M(l,u){if(typeof l!="object"||!(l instanceof e))throw new Error("bad call to strictFail");l.strict&&L(l,u)}function q(l){l.strict||(l.tagName=l.tagName[l.looseCase]());var u=l.tags[l.tags.length-1]||l,_=l.tag={name:l.tagName,attributes:{}};l.opt.xmlns&&(_.ns=u.ns),l.attribList.length=0,C(l,"onopentagstart",_)}function j(l,u){var _=l.indexOf(":"),D=_<0?["",l]:l.split(":"),k=D[0],Y=D[1];return u&&l==="xmlns"&&(k="xmlns",Y=""),{prefix:k,local:Y}}function B(l){if(l.strict||(l.attribName=l.attribName[l.looseCase]()),l.attribList.indexOf(l.attribName)!==-1||l.tag.attributes.hasOwnProperty(l.attribName)){l.attribName=l.attribValue="";return}if(l.opt.xmlns){var u=j(l.attribName,!0),_=u.prefix,D=u.local;if(_==="xmlns")if(D==="xml"&&l.attribValue!==v)M(l,"xml: prefix must be bound to "+v+`
Actual: `+l.attribValue);else if(D==="xmlns"&&l.attribValue!==h)M(l,"xmlns: prefix must be bound to "+h+`
Actual: `+l.attribValue);else{var k=l.tag,Y=l.tags[l.tags.length-1]||l;k.ns===Y.ns&&(k.ns=Object.create(Y.ns)),k.ns[D]=l.attribValue}l.attribList.push([l.attribName,l.attribValue])}else l.tag.attributes[l.attribName]=l.attribValue,C(l,"onattribute",{name:l.attribName,value:l.attribValue});l.attribName=l.attribValue=""}function U(l,u){if(l.opt.xmlns){var _=l.tag,D=j(l.tagName);_.prefix=D.prefix,_.local=D.local,_.uri=_.ns[D.prefix]||"",_.prefix&&!_.uri&&(M(l,"Unbound namespace prefix: "+JSON.stringify(l.tagName)),_.uri=D.prefix);var k=l.tags[l.tags.length-1]||l;_.ns&&k.ns!==_.ns&&Object.keys(_.ns).forEach(function(jr){C(l,"onopennamespace",{prefix:jr,uri:_.ns[jr]})});for(var Y=0,Z=l.attribList.length;Y<Z;Y++){var ht=l.attribList[Y],Ct=ht[0],re=ht[1],nt=j(Ct,!0),xt=nt.prefix,Gn=nt.local,qr=xt===""?"":_.ns[xt]||"",or={name:Ct,value:re,prefix:xt,local:Gn,uri:qr};xt&&xt!=="xmlns"&&!qr&&(M(l,"Unbound namespace prefix: "+JSON.stringify(xt)),or.uri=xt),l.tag.attributes[Ct]=or,C(l,"onattribute",or)}l.attribList.length=0}l.tag.isSelfClosing=!!u,l.sawRoot=!0,l.tags.push(l.tag),C(l,"onopentag",l.tag),u||(!l.noscript&&l.tagName.toLowerCase()==="script"?l.state=d.SCRIPT:l.state=d.TEXT,l.tag=null,l.tagName=""),l.attribName=l.attribValue="",l.attribList.length=0}function H(l){if(!l.tagName){M(l,"Weird empty close tag."),l.textNode+="</>",l.state=d.TEXT;return}if(l.script){if(l.tagName!=="script"){l.script+="</"+l.tagName+">",l.tagName="",l.state=d.SCRIPT;return}C(l,"onscript",l.script),l.script=""}var u=l.tags.length,_=l.tagName;l.strict||(_=_[l.looseCase]());for(var D=_;u--;){var k=l.tags[u];if(k.name!==D)M(l,"Unexpected close tag");else break}if(u<0){M(l,"Unmatched closing tag: "+l.tagName),l.textNode+="</"+l.tagName+">",l.state=d.TEXT;return}l.tagName=_;for(var Y=l.tags.length;Y-- >u;){var Z=l.tag=l.tags.pop();l.tagName=l.tag.name,C(l,"onclosetag",l.tagName);var ht={};for(var Ct in Z.ns)ht[Ct]=Z.ns[Ct];var re=l.tags[l.tags.length-1]||l;l.opt.xmlns&&Z.ns!==re.ns&&Object.keys(Z.ns).forEach(function(nt){var xt=Z.ns[nt];C(l,"onclosenamespace",{prefix:nt,uri:xt})})}u===0&&(l.closedRoot=!0),l.tagName=l.attribValue=l.attribName="",l.attribList.length=0,l.state=d.TEXT}function W(l){var u=l.entity,_=u.toLowerCase(),D,k="";return l.ENTITIES[u]?l.ENTITIES[u]:l.ENTITIES[_]?l.ENTITIES[_]:(u=_,u.charAt(0)==="#"&&(u.charAt(1)==="x"?(u=u.slice(2),D=parseInt(u,16),k=D.toString(16)):(u=u.slice(1),D=parseInt(u,10),k=D.toString(10))),u=u.replace(/^0+/,""),isNaN(D)||k.toLowerCase()!==u?(M(l,"Invalid character entity"),"&"+l.entity+";"):String.fromCodePoint(D))}function et(l,u){u==="<"?(l.state=d.OPEN_WAKA,l.startTagPosition=l.position):g(u)||(M(l,"Non-whitespace before first tag."),l.textNode=u,l.state=d.TEXT)}function Dt(l,u){var _="";return u<l.length&&(_=l.charAt(u)),_}function St(l){var u=this;if(this.error)throw this.error;if(u.closed)return L(u,"Cannot write after close. Assign an onready handler.");if(l===null)return x(u);typeof l=="object"&&(l=l.toString());for(var _=0,D="";D=Dt(l,_++),u.c=D,!!D;)switch(u.trackPosition&&(u.position++,D===`
`?(u.line++,u.column=0):u.column++),u.state){case d.BEGIN:if(u.state=d.BEGIN_WHITESPACE,D==="\uFEFF")continue;et(u,D);continue;case d.BEGIN_WHITESPACE:et(u,D);continue;case d.TEXT:if(u.sawRoot&&!u.closedRoot){for(var k=_-1;D&&D!=="<"&&D!=="&";)D=Dt(l,_++),D&&u.trackPosition&&(u.position++,D===`
`?(u.line++,u.column=0):u.column++);u.textNode+=l.substring(k,_-1)}D==="<"&&!(u.sawRoot&&u.closedRoot&&!u.strict)?(u.state=d.OPEN_WAKA,u.startTagPosition=u.position):(!g(D)&&(!u.sawRoot||u.closedRoot)&&M(u,"Text data outside of root node."),D==="&"?u.state=d.TEXT_ENTITY:u.textNode+=D);continue;case d.SCRIPT:D==="<"?u.state=d.SCRIPT_ENDING:u.script+=D;continue;case d.SCRIPT_ENDING:D==="/"?u.state=d.CLOSE_TAG:(u.script+="<"+D,u.state=d.SCRIPT);continue;case d.OPEN_WAKA:if(D==="!")u.state=d.SGML_DECL,u.sgmlDecl="";else if(!g(D))if(y(O,D))u.state=d.OPEN_TAG,u.tagName=D;else if(D==="/")u.state=d.CLOSE_TAG,u.tagName="";else if(D==="?")u.state=d.PROC_INST,u.procInstName=u.procInstBody="";else{if(M(u,"Unencoded <"),u.startTagPosition+1<u.position){var Y=u.position-u.startTagPosition;D=new Array(Y).join(" ")+D}u.textNode+="<"+D,u.state=d.TEXT}continue;case d.SGML_DECL:(u.sgmlDecl+D).toUpperCase()===E?(C(u,"onopencdata"),u.state=d.CDATA,u.sgmlDecl="",u.cdata=""):u.sgmlDecl+D==="--"?(u.state=d.COMMENT,u.comment="",u.sgmlDecl=""):(u.sgmlDecl+D).toUpperCase()===b?(u.state=d.DOCTYPE,(u.doctype||u.sawRoot)&&M(u,"Inappropriately located doctype declaration"),u.doctype="",u.sgmlDecl=""):D===">"?(C(u,"onsgmldeclaration",u.sgmlDecl),u.sgmlDecl="",u.state=d.TEXT):(c(D)&&(u.state=d.SGML_DECL_QUOTED),u.sgmlDecl+=D);continue;case d.SGML_DECL_QUOTED:D===u.q&&(u.state=d.SGML_DECL,u.q=""),u.sgmlDecl+=D;continue;case d.DOCTYPE:D===">"?(u.state=d.TEXT,C(u,"ondoctype",u.doctype),u.doctype=!0):(u.doctype+=D,D==="["?u.state=d.DOCTYPE_DTD:c(D)&&(u.state=d.DOCTYPE_QUOTED,u.q=D));continue;case d.DOCTYPE_QUOTED:u.doctype+=D,D===u.q&&(u.q="",u.state=d.DOCTYPE);continue;case d.DOCTYPE_DTD:u.doctype+=D,D==="]"?u.state=d.DOCTYPE:c(D)&&(u.state=d.DOCTYPE_DTD_QUOTED,u.q=D);continue;case d.DOCTYPE_DTD_QUOTED:u.doctype+=D,D===u.q&&(u.state=d.DOCTYPE_DTD,u.q="");continue;case d.COMMENT:D==="-"?u.state=d.COMMENT_ENDING:u.comment+=D;continue;case d.COMMENT_ENDING:D==="-"?(u.state=d.COMMENT_ENDED,u.comment=I(u.opt,u.comment),u.comment&&C(u,"oncomment",u.comment),u.comment=""):(u.comment+="-"+D,u.state=d.COMMENT);continue;case d.COMMENT_ENDED:D!==">"?(M(u,"Malformed comment"),u.comment+="--"+D,u.state=d.COMMENT):u.state=d.TEXT;continue;case d.CDATA:D==="]"?u.state=d.CDATA_ENDING:u.cdata+=D;continue;case d.CDATA_ENDING:D==="]"?u.state=d.CDATA_ENDING_2:(u.cdata+="]"+D,u.state=d.CDATA);continue;case d.CDATA_ENDING_2:D===">"?(u.cdata&&C(u,"oncdata",u.cdata),C(u,"onclosecdata"),u.cdata="",u.state=d.TEXT):D==="]"?u.cdata+="]":(u.cdata+="]]"+D,u.state=d.CDATA);continue;case d.PROC_INST:D==="?"?u.state=d.PROC_INST_ENDING:g(D)?u.state=d.PROC_INST_BODY:u.procInstName+=D;continue;case d.PROC_INST_BODY:if(!u.procInstBody&&g(D))continue;D==="?"?u.state=d.PROC_INST_ENDING:u.procInstBody+=D;continue;case d.PROC_INST_ENDING:D===">"?(C(u,"onprocessinginstruction",{name:u.procInstName,body:u.procInstBody}),u.procInstName=u.procInstBody="",u.state=d.TEXT):(u.procInstBody+="?"+D,u.state=d.PROC_INST_BODY);continue;case d.OPEN_TAG:y(F,D)?u.tagName+=D:(q(u),D===">"?U(u):D==="/"?u.state=d.OPEN_TAG_SLASH:(g(D)||M(u,"Invalid character in tag name"),u.state=d.ATTRIB));continue;case d.OPEN_TAG_SLASH:D===">"?(U(u,!0),H(u)):(M(u,"Forward-slash in opening tag not followed by >"),u.state=d.ATTRIB);continue;case d.ATTRIB:if(g(D))continue;D===">"?U(u):D==="/"?u.state=d.OPEN_TAG_SLASH:y(O,D)?(u.attribName=D,u.attribValue="",u.state=d.ATTRIB_NAME):M(u,"Invalid attribute name");continue;case d.ATTRIB_NAME:D==="="?u.state=d.ATTRIB_VALUE:D===">"?(M(u,"Attribute without value"),u.attribValue=u.attribName,B(u),U(u)):g(D)?u.state=d.ATTRIB_NAME_SAW_WHITE:y(F,D)?u.attribName+=D:M(u,"Invalid attribute name");continue;case d.ATTRIB_NAME_SAW_WHITE:if(D==="=")u.state=d.ATTRIB_VALUE;else{if(g(D))continue;M(u,"Attribute without value"),u.tag.attributes[u.attribName]="",u.attribValue="",C(u,"onattribute",{name:u.attribName,value:""}),u.attribName="",D===">"?U(u):y(O,D)?(u.attribName=D,u.state=d.ATTRIB_NAME):(M(u,"Invalid attribute name"),u.state=d.ATTRIB)}continue;case d.ATTRIB_VALUE:if(g(D))continue;c(D)?(u.q=D,u.state=d.ATTRIB_VALUE_QUOTED):(M(u,"Unquoted attribute value"),u.state=d.ATTRIB_VALUE_UNQUOTED,u.attribValue=D);continue;case d.ATTRIB_VALUE_QUOTED:if(D!==u.q){D==="&"?u.state=d.ATTRIB_VALUE_ENTITY_Q:u.attribValue+=D;continue}B(u),u.q="",u.state=d.ATTRIB_VALUE_CLOSED;continue;case d.ATTRIB_VALUE_CLOSED:g(D)?u.state=d.ATTRIB:D===">"?U(u):D==="/"?u.state=d.OPEN_TAG_SLASH:y(O,D)?(M(u,"No whitespace between attributes"),u.attribName=D,u.attribValue="",u.state=d.ATTRIB_NAME):M(u,"Invalid attribute name");continue;case d.ATTRIB_VALUE_UNQUOTED:if(!a(D)){D==="&"?u.state=d.ATTRIB_VALUE_ENTITY_U:u.attribValue+=D;continue}B(u),D===">"?U(u):u.state=d.ATTRIB;continue;case d.CLOSE_TAG:if(u.tagName)D===">"?H(u):y(F,D)?u.tagName+=D:u.script?(u.script+="</"+u.tagName,u.tagName="",u.state=d.SCRIPT):(g(D)||M(u,"Invalid tagname in closing tag"),u.state=d.CLOSE_TAG_SAW_WHITE);else{if(g(D))continue;S(O,D)?u.script?(u.script+="</"+D,u.state=d.SCRIPT):M(u,"Invalid tagname in closing tag."):u.tagName=D}continue;case d.CLOSE_TAG_SAW_WHITE:if(g(D))continue;D===">"?H(u):M(u,"Invalid characters in closing tag");continue;case d.TEXT_ENTITY:case d.ATTRIB_VALUE_ENTITY_Q:case d.ATTRIB_VALUE_ENTITY_U:var Z,ht;switch(u.state){case d.TEXT_ENTITY:Z=d.TEXT,ht="textNode";break;case d.ATTRIB_VALUE_ENTITY_Q:Z=d.ATTRIB_VALUE_QUOTED,ht="attribValue";break;case d.ATTRIB_VALUE_ENTITY_U:Z=d.ATTRIB_VALUE_UNQUOTED,ht="attribValue";break}D===";"?(u[ht]+=W(u),u.entity="",u.state=Z):y(u.entity.length?R:P,D)?u.entity+=D:(M(u,"Invalid character in entity name"),u[ht]+="&"+u.entity+D,u.entity="",u.state=Z);continue;default:throw new Error(u,"Unknown state: "+u.state)}return u.position>=u.bufferCheckPosition&&n(u),u}String.fromCodePoint||function(){var l=String.fromCharCode,u=Math.floor,_=function(){var D=16384,k=[],Y,Z,ht=-1,Ct=arguments.length;if(!Ct)return"";for(var re="";++ht<Ct;){var nt=Number(arguments[ht]);if(!isFinite(nt)||nt<0||nt>1114111||u(nt)!==nt)throw RangeError("Invalid code point: "+nt);nt<=65535?k.push(nt):(nt-=65536,Y=(nt>>10)+55296,Z=nt%1024+56320,k.push(Y,Z)),(ht+1===Ct||k.length>D)&&(re+=l.apply(null,k),k.length=0)}return re};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:_,configurable:!0,writable:!0}):String.fromCodePoint=_}()})(typeof Ye>"u"?Ye.sax={}:Ye)});var Fn=X(vr=>{(function(){"use strict";vr.stripBOM=function(r){return r[0]==="\uFEFF"?r.substring(1):r}}).call(vr)});var Tr=X(Wt=>{(function(){"use strict";var r;r=new RegExp(/(?!xmlns)^.*:/),Wt.normalize=function(t){return t.toLowerCase()},Wt.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},Wt.stripPrefix=function(t){return t.replace(r,"")},Wt.parseNumbers=function(t){return isNaN(t)||(t=t%1===0?parseInt(t,10):parseFloat(t)),t},Wt.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t=t.toLowerCase()==="true"),t}}).call(Wt)});var Ln=X(qt=>{(function(){"use strict";var r,t,e,n,i,o,s,f,p=function(b,v){return function(){return b.apply(v,arguments)}},T=function(b,v){for(var h in v)E.call(v,h)&&(b[h]=v[h]);function w(){this.constructor=b}return w.prototype=v.prototype,b.prototype=new w,b.__super__=v.prototype,b},E={}.hasOwnProperty;s=Mn(),e=require("events"),r=Fn(),o=Tr(),f=require("timers").setImmediate,t=Le().defaults,n=function(b){return typeof b=="object"&&b!=null&&Object.keys(b).length===0},i=function(b,v,h){var w,O,F;for(w=0,O=b.length;w<O;w++)F=b[w],v=F(v,h);return v},qt.Parser=function(b){T(v,b);function v(h){this.parseStringPromise=p(this.parseStringPromise,this),this.parseString=p(this.parseString,this),this.reset=p(this.reset,this),this.assignOrPush=p(this.assignOrPush,this),this.processAsync=p(this.processAsync,this);var w,O,F;if(!(this instanceof qt.Parser))return new qt.Parser(h);this.options={},O=t["0.2"];for(w in O)!E.call(O,w)||(F=O[w],this.options[w]=F);for(w in h)!E.call(h,w)||(F=h[w],this.options[w]=F);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(o.normalize)),this.reset()}return v.prototype.processAsync=function(){var h,w;try{return this.remaining.length<=this.options.chunkSize?(h=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(h),this.saxParser.close()):(h=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(h),f(this.processAsync))}catch(O){if(w=O,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(w)}},v.prototype.assignOrPush=function(h,w,O){return w in h?(h[w]instanceof Array||(h[w]=[h[w]]),h[w].push(O)):this.options.explicitArray?h[w]=[O]:h[w]=O},v.prototype.reset=function(){var h,w,O,F;return this.removeAllListeners(),this.saxParser=s.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(P){return function(R){if(P.saxParser.resume(),!P.saxParser.errThrown)return P.saxParser.errThrown=!0,P.emit("error",R)}}(this),this.saxParser.onend=function(P){return function(){if(!P.saxParser.ended)return P.saxParser.ended=!0,P.emit("end",P.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,F=[],h=this.options.attrkey,w=this.options.charkey,this.saxParser.onopentag=function(P){return function(R){var g,c,a,y,S;if(a={},a[w]="",!P.options.ignoreAttrs){S=R.attributes;for(g in S)!E.call(S,g)||(!(h in a)&&!P.options.mergeAttrs&&(a[h]={}),c=P.options.attrValueProcessors?i(P.options.attrValueProcessors,R.attributes[g],g):R.attributes[g],y=P.options.attrNameProcessors?i(P.options.attrNameProcessors,g):g,P.options.mergeAttrs?P.assignOrPush(a,y,c):a[h][y]=c)}return a["#name"]=P.options.tagNameProcessors?i(P.options.tagNameProcessors,R.name):R.name,P.options.xmlns&&(a[P.options.xmlnskey]={uri:R.uri,local:R.local}),F.push(a)}}(this),this.saxParser.onclosetag=function(P){return function(){var R,g,c,a,y,S,d,N,m,C;if(S=F.pop(),y=S["#name"],(!P.options.explicitChildren||!P.options.preserveChildrenOrder)&&delete S["#name"],S.cdata===!0&&(R=S.cdata,delete S.cdata),m=F[F.length-1],S[w].match(/^\s*$/)&&!R?(g=S[w],delete S[w]):(P.options.trim&&(S[w]=S[w].trim()),P.options.normalize&&(S[w]=S[w].replace(/\s{2,}/g," ").trim()),S[w]=P.options.valueProcessors?i(P.options.valueProcessors,S[w],y):S[w],Object.keys(S).length===1&&w in S&&!P.EXPLICIT_CHARKEY&&(S=S[w])),n(S)&&(S=P.options.emptyTag!==""?P.options.emptyTag:g),P.options.validator!=null&&(C="/"+function(){var A,I,L;for(L=[],A=0,I=F.length;A<I;A++)a=F[A],L.push(a["#name"]);return L}().concat(y).join("/"),function(){var A;try{return S=P.options.validator(C,m&&m[y],S)}catch(I){return A=I,P.emit("error",A)}}()),P.options.explicitChildren&&!P.options.mergeAttrs&&typeof S=="object"){if(!P.options.preserveChildrenOrder)a={},P.options.attrkey in S&&(a[P.options.attrkey]=S[P.options.attrkey],delete S[P.options.attrkey]),!P.options.charsAsChildren&&P.options.charkey in S&&(a[P.options.charkey]=S[P.options.charkey],delete S[P.options.charkey]),Object.getOwnPropertyNames(S).length>0&&(a[P.options.childkey]=S),S=a;else if(m){m[P.options.childkey]=m[P.options.childkey]||[],d={};for(c in S)!E.call(S,c)||(d[c]=S[c]);m[P.options.childkey].push(d),delete S["#name"],Object.keys(S).length===1&&w in S&&!P.EXPLICIT_CHARKEY&&(S=S[w])}}return F.length>0?P.assignOrPush(m,y,S):(P.options.explicitRoot&&(N=S,S={},S[y]=N),P.resultObject=S,P.saxParser.ended=!0,P.emit("end",P.resultObject))}}(this),O=function(P){return function(R){var g,c;if(c=F[F.length-1],c)return c[w]+=R,P.options.explicitChildren&&P.options.preserveChildrenOrder&&P.options.charsAsChildren&&(P.options.includeWhiteChars||R.replace(/\\n/g,"").trim()!=="")&&(c[P.options.childkey]=c[P.options.childkey]||[],g={"#name":"__text__"},g[w]=R,P.options.normalize&&(g[w]=g[w].replace(/\s{2,}/g," ").trim()),c[P.options.childkey].push(g)),c}}(this),this.saxParser.ontext=O,this.saxParser.oncdata=function(P){return function(R){var g;if(g=O(R),g)return g.cdata=!0}}(this)},v.prototype.parseString=function(h,w){var O;w!=null&&typeof w=="function"&&(this.on("end",function(F){return this.reset(),w(null,F)}),this.on("error",function(F){return this.reset(),w(F)}));try{return h=h.toString(),h.trim()===""?(this.emit("end",null),!0):(h=r.stripBOM(h),this.options.async?(this.remaining=h,f(this.processAsync),this.saxParser):this.saxParser.write(h).close())}catch(F){if(O=F,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw O}else return this.emit("error",O),this.saxParser.errThrown=!0}},v.prototype.parseStringPromise=function(h){return new Promise(function(w){return function(O,F){return w.parseString(h,function(P,R){return P?F(P):O(R)})}}(this))},v}(e),qt.parseString=function(b,v,h){var w,O,F;return h!=null?(typeof h=="function"&&(w=h),typeof v=="object"&&(O=v)):(typeof v=="function"&&(w=v),O={}),F=new qt.Parser(O),F.parseString(b,w)},qt.parseStringPromise=function(b,v){var h,w;return typeof v=="object"&&(h=v),w=new qt.Parser(h),w.parseStringPromise(b)}}).call(qt)});var xn=X(jt=>{(function(){"use strict";var r,t,e,n,i=function(s,f){for(var p in f)o.call(f,p)&&(s[p]=f[p]);function T(){this.constructor=s}return T.prototype=f.prototype,s.prototype=new T,s.__super__=f.prototype,s},o={}.hasOwnProperty;t=Le(),r=An(),e=Ln(),n=Tr(),jt.defaults=t.defaults,jt.processors=n,jt.ValidationError=function(s){i(f,s);function f(p){this.message=p}return f}(Error),jt.Builder=r.Builder,jt.Parser=e.Parser,jt.parseString=e.parseString,jt.parseStringPromise=e.parseStringPromise}).call(jt)});var se=X(At=>{"use strict";var Yo=At&&At.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(At,"__esModule",{value:!0});At.parseSOAPString=At.guid=At.linerase=void 0;var Zo=Yo(xn()),Ko=/^-?([1-9]\d*|0)(\.\d*)?$/,Qo=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d+)?Z$/,Jo=/(?!xmlns)^.*:/;function be(r){if(Array.isArray(r)){if(r.length>1)return r.map(be);[r]=r}if(typeof r=="object"){let t={};return Object.keys(r).forEach(e=>{e==="$"?t={...t,...be(r.$)}:t[e]=be(r[e])}),t}return r==="true"?!0:r==="false"?!1:Ko.test(r)?parseFloat(r):Qo.test(r)?new Date(r):r}At.linerase=be;function Ut(){return((1+Math.random())*65536|0).toString(16).substring(1)}function ts(){return`${Ut()+Ut()}-${Ut()}-${Ut()}-${Ut()}-${Ut()}${Ut()}${Ut()}`}At.guid=ts;async function es(r){let t=r.replace(/xmlns([^=]*?)=(".*?")/g,""),e=await Zo.default.parseStringPromise(t,{tagNameProcessors:[n=>{let i=n.replace(Jo,""),o=i.charAt(1);return o&&o.toUpperCase()!==o?i.charAt(0).toLowerCase()+i.slice(1):i}]});if(!e||!e.envelope||!e.envelope.body)throw new Error("Wrong ONVIF SOAP response");if(e.envelope.body[0].fault){let n=e.envelope.body[0].fault[0],i;try{n.reason[0].text[0]._&&(i=n.reason[0].text[0]._)}catch{i=""}if(!i)try{i=JSON.stringify(be(n.code[0]))}catch{i=""}let o;try{[o]=n.detail[0].text}catch{o=""}throw new Error(`ONVIF SOAP Fault: ${i}${o}`)}return[e.envelope.body,t]}At.parseSOAPString=es});var Dr=X(Lt=>{"use strict";var V=Lt&&Lt.__classPrivateFieldGet||function(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)},$t=Lt&&Lt.__classPrivateFieldSet||function(r,t,e,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,e):i?i.value=e:t.set(r,e),e},rs=Lt&&Lt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},ae,Ft,Yt,pt,vt,ue;Object.defineProperty(Lt,"__esModule",{value:!0});Lt.Device=void 0;var is=rs(require("url")),Mt=se(),br=class{constructor(t){ae.set(this,[]),this.media2Support=!1,Ft.set(this,[]),Yt.set(this,{}),pt.set(this,void 0),vt.set(this,void 0),ue.set(this,void 0),this.onvif=t}get services(){return V(this,ae,"f")}get scopes(){return V(this,Ft,"f")}get serviceCapabilities(){return V(this,Yt,"f")}get NTP(){return V(this,pt,"f")}get DNS(){return V(this,pt,"f")}get newtworkInterfaces(){return V(this,ue,"f")}getSystemDateAndTime(){return this.onvif.getSystemDateAndTime()}setSystemDateAndTime(t){return this.onvif.setSystemDateAndTime(t)}async getServices(t=!0){let[e]=await this.onvif.request({body:`<GetServices xmlns="http://www.onvif.org/ver10/device/wsdl"><IncludeCapability>${t}</IncludeCapability></GetServices>`});return $t(this,ae,(0,Mt.linerase)(e).getServicesResponse.service,"f"),V(this,ae,"f").forEach(n=>{if(Object.prototype.hasOwnProperty.call(n,"namespace")&&Object.prototype.hasOwnProperty.call(n,"XAddr")){let i=is.default.parse(n.namespace);if(i.hostname==="www.onvif.org"&&i.path){let o=i.path.substring(1).split("/");o[1]==="media"&&o[0]==="ver20"?(this.media2Support=!0,o[1]="media2"):o[1]==="ptz"&&(o[1]="PTZ"),this.onvif.uri[o[1]]=this.onvif.parseUrl(n.XAddr)}}}),V(this,ae,"f")}async getCapabilities(){let[t]=await this.onvif.request({body:'<GetCapabilities xmlns="http://www.onvif.org/ver10/device/wsdl"><Category>All</Category></GetCapabilities>'});if(this.onvif.capabilities=(0,Mt.linerase)(t[0].getCapabilitiesResponse[0].capabilities[0]),["PTZ","media","imaging","events","device"].forEach(e=>{let n=e;"XAddr"in this.onvif.capabilities[n]&&(this.onvif.uri[e]=this.onvif.parseUrl(this.onvif.capabilities[n].XAddr))}),this.onvif.capabilities.extension&&(Object.keys(this.onvif.capabilities.extension).forEach(e=>{let n=e;n!=="XAddr"&&"XAddr"in this.onvif.capabilities.extension[n]&&(this.onvif.uri[n]=new URL(this.onvif.capabilities.extension[n].XAddr))}),this.onvif.uri.replay&&!this.onvif.uri.recording)){let e=this.onvif.uri.replay.href.replace("replay","recording");this.onvif.emit("warn",`Adding ${e} for bad Profile G device`),this.onvif.uri.recording=new URL(e)}return this.onvif.capabilities}async getDeviceInformation(){let[t]=await this.onvif.request({body:'<GetDeviceInformation xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return this.onvif.deviceInformation=(0,Mt.linerase)(t).getDeviceInformationResponse,this.onvif.deviceInformation}async getHostname(){let[t]=await this.onvif.request({body:'<GetHostname xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return(0,Mt.linerase)(t).getHostnameResponse.hostnameInformation}async getScopes(){let[t]=await this.onvif.request({body:'<GetScopes xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return $t(this,Ft,(0,Mt.linerase)(t).getScopesResponse.scopes,"f"),V(this,Ft,"f")===void 0?$t(this,Ft,[],"f"):Array.isArray(V(this,Ft,"f"))||$t(this,Ft,[V(this,Ft,"f")],"f"),V(this,Ft,"f")}async setScopes(t){let[e]=await this.onvif.request({body:`<SetScopes xmlns="http://www.onvif.org/ver10/device/wsdl">${t.map(n=>`<Scopes>${n}</Scopes>`).join("")}</SetScopes>`});if((0,Mt.linerase)(e).setScopesResponse!=="")throw new Error("Wrong `SetScopes` response");return this.getScopes()}async getServiceCapabilities(){let[t]=await this.onvif.request({body:'<GetServiceCapabilities xmlns="http://www.onvif.org/ver10/device/wsdl" />'}),e=(0,Mt.linerase)(t);return $t(this,Yt,{network:e.getServiceCapabilitiesResponse.capabilities.network,security:e.getServiceCapabilitiesResponse.capabilities.security,system:e.getServiceCapabilitiesResponse.capabilities.system},"f"),e.getServiceCapabilitiesResponse.capabilities.misc&&(V(this,Yt,"f").misc=e.getServiceCapabilitiesResponse.capabilities.misc,V(this,Yt,"f").auxiliaryCommands=e.getServiceCapabilitiesResponse.capabilities.misc.AuxiliaryCommands.split(" ")),V(this,Yt,"f")}async systemReboot(){return this.onvif.request({service:"device",body:'<SystemReboot xmlns="http://www.onvif.org/ver10/device/wsdl"/>'}).then(([t])=>t[0].systemRebootResponse[0].message[0])}async getNTP(){let[t]=await this.onvif.request({service:"device",body:'<GetNTP xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return $t(this,pt,(0,Mt.linerase)(t[0].getNTPResponse[0].NTPInformation[0]),"f"),V(this,pt,"f")?.NTPManual&&!Array.isArray(V(this,pt,"f").NTPManual)&&(V(this,pt,"f").NTPManual=[V(this,pt,"f").NTPManual]),V(this,pt,"f")?.NTPFromDHCP&&!Array.isArray(V(this,pt,"f").NTPFromDHCP)&&(V(this,pt,"f").NTPFromDHCP=[V(this,pt,"f").NTPFromDHCP]),V(this,pt,"f")}async getDNS(){let[t]=await this.onvif.request({service:"device",body:'<GetDNS xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return $t(this,vt,(0,Mt.linerase)(t[0].getDNSResponse[0].DNSInformation),"f"),V(this,vt,"f")?.DNSManual&&!Array.isArray(V(this,vt,"f").DNSManual)&&(V(this,vt,"f").DNSManual=[V(this,vt,"f").DNSManual]),V(this,vt,"f")?.DNSFromDHCP&&!Array.isArray(V(this,vt,"f").DNSFromDHCP)&&(V(this,vt,"f").DNSFromDHCP=[V(this,vt,"f").DNSFromDHCP]),V(this,vt,"f")}async getNetworkInterfaces(){let[t]=await this.onvif.request({service:"device",body:'<GetNetworkInterfaces xmlns="http://www.onvif.org/ver10/device/wsdl"/>'}),e=(0,Mt.linerase)(t[0].getNetworkInterfacesResponse[0].networkInterfaces);return Array.isArray(e)?$t(this,ue,e,"f"):$t(this,ue,[e],"f"),V(this,ue,"f")}};Lt.Device=br;ae=new WeakMap,Ft=new WeakMap,Yt=new WeakMap,pt=new WeakMap,vt=new WeakMap,ue=new WeakMap});var Er=X(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.Media=void 0;var Zt=se(),Sr=class{constructor(t){this.profiles=[],this.videoSources=[],this.onvif=t}async getProfiles(){if(this.onvif.device.media2Support){let[e]=await this.onvif.request({service:"media2",body:'<GetProfiles xmlns="http://www.onvif.org/ver20/media/wsdl"><Type>All</Type></GetProfiles>'});return this.profiles=e[0].getProfilesResponse[0].profiles.map(n=>{let i=(0,Zt.linerase)(n),o={token:i.token,name:i.name,fixed:i.fixed||!1};return i.configurations.videoSource&&(o.videoSourceConfiguration=i.configurations.videoSource),i.configurations.audioSource&&(o.audioSourceConfiguration=i.configurations.audioSource),i.configurations.videoEncoder&&(o.videoEncoderConfiguration=i.configurations.videoEncoder),i.configurations.audioEncoder&&(o.audioEncoderConfiguration=i.configurations.audioEncoder),i.configurations.PTZ&&(o.PTZConfiguration=i.configurations.PTZ),i.configurations.analytics&&(o.videoAnalyticsConfiguration=i.configurations.analytics),i.configurations.metadata&&(o.metadataConfiguration=i.configurations.metadata),(i.configurations.audioOutput||i.configurations.audioDecoder)&&(o.extension={audioOutputConfiguration:i.configurations.audioOutput,audioDecoderConfiguration:i.configurations.audioDecoder}),o}),this.profiles}let[t]=await this.onvif.request({service:"media",body:'<GetProfiles xmlns="http://www.onvif.org/ver10/media/wsdl"/>'});return this.profiles=t[0].getProfilesResponse[0].profiles.map(Zt.linerase),this.profiles}async getVideoSources(){let[t]=await this.onvif.request({service:"media",body:'<GetVideoSources xmlns="http://www.onvif.org/ver10/media/wsdl"/>'});return this.videoSources=(0,Zt.linerase)(t).getVideoSourcesResponse.videoSources,Array.isArray(this.videoSources)||(this.videoSources=[this.videoSources]),this.videoSources}async getStreamUri(t={}){let{profileToken:e,stream:n="RTP-Unicast"}=t,{protocol:i="RTSP"}=t;if(this.onvif.device.media2Support){i==="HTTP"&&(i="RtspOverHttp"),i==="TCP"&&(i="RTSP"),i==="UDP"&&n==="RTP-Unicast"&&(i="RtspUnicast"),i==="UDP"&&n==="RTP-Multicast"&&(i="RtspMulticast");let[s]=await this.onvif.request({service:"media2",body:`<GetStreamUri xmlns="http://www.onvif.org/ver20/media/wsdl"><Protocol>${i}</Protocol><ProfileToken>${e||this.onvif.activeSource.profileToken}</ProfileToken></GetStreamUri>`});return(0,Zt.linerase)(s).getStreamUriResponse}let[o]=await this.onvif.request({service:"media",body:`<GetStreamUri xmlns="http://www.onvif.org/ver10/media/wsdl"><StreamSetup><Stream xmlns="http://www.onvif.org/ver10/schema">${n}</Stream><Transport xmlns="http://www.onvif.org/ver10/schema"><Protocol>${i||"RTSP"}</Protocol></Transport></StreamSetup><ProfileToken>${e||this.onvif.activeSource.profileToken}</ProfileToken></GetStreamUri>`});return(0,Zt.linerase)(o).getStreamUriResponse.mediaUri}async getSnapshotUri({profileToken:t}={}){if(this.onvif.device.media2Support){let[n]=await this.onvif.request({service:"media2",body:`<GetSnapshotUri xmlns="http://www.onvif.org/ver20/media/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken></GetSnapshotUri>`});return(0,Zt.linerase)(n).getSnapshotUriResponse}let[e]=await this.onvif.request({service:"media",body:`<GetSnapshotUri xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken></GetSnapshotUri>`});return(0,Zt.linerase)(e).getSnapshotUriResponse.mediaUri}};Ze.Media=Sr});var Nr=X(kt=>{"use strict";var Pt=kt&&kt.__classPrivateFieldGet||function(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)},Pr=kt&&kt.__classPrivateFieldSet||function(r,t,e,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,e):i?i.value=e:t.set(r,e),e},ce,Qt,Jt;Object.defineProperty(kt,"__esModule",{value:!0});kt.PTZ=void 0;var Kt=se(),Tt=class{constructor(t){ce.set(this,{}),Qt.set(this,{}),Jt.set(this,{}),this.onvif=t}get nodes(){return Pt(this,ce,"f")}get configurations(){return Pt(this,Qt,"f")}get presets(){return Pt(this,Jt,"f")}async getNodes(){let[t]=await this.onvif.request({service:"PTZ",body:'<GetNodes xmlns="http://www.onvif.org/ver20/ptz/wsdl" />'});return Pr(this,ce,{},"f"),t[0].getNodesResponse.forEach(e=>{let n=(0,Kt.linerase)(e.PTZNode[0]);Pt(this,ce,"f")[n.token]=n}),Pt(this,ce,"f")}async getConfigurations(){let[t]=await this.onvif.request({service:"PTZ",body:'<GetConfigurations xmlns="http://www.onvif.org/ver20/ptz/wsdl"></GetConfigurations>'});return Pr(this,Qt,{},"f"),Array.isArray(t[0].getConfigurationsResponse[0].PTZConfiguration)?(t[0].getConfigurationsResponse[0].PTZConfiguration.forEach(e=>{let n=(0,Kt.linerase)(e);Pt(this,Qt,"f")[n.token]=n}),Pt(this,Qt,"f")):Pt(this,Qt,"f")}async getConfigurationOptions({configurationToken:t}){let[e]=await this.onvif.request({service:"PTZ",body:`<GetConfigurationOptions xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ConfigurationToken>${t}</ConfigurationToken></GetConfigurationOptions>`});return(0,Kt.linerase)(e)}async getPresets({profileToken:t}={}){let[e]=await this.onvif.request({service:"PTZ",body:`<GetPresets xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken></GetPresets>`});Pr(this,Jt,{},"f");let n=(0,Kt.linerase)(e[0].getPresetsResponse[0].preset);return Array.isArray(n)?(0,Kt.linerase)(n).forEach(i=>Pt(this,Jt,"f")[i.token]=i):Pt(this,Jt,"f")[n.token]=n,Pt(this,Jt,"f")}static formatPTZSimpleVector({pan:t,tilt:e,x:n,y:i,zoom:o}={x:0,y:0,zoom:0}){return{panTilt:{x:t||n,y:e||i},zoom:{x:o}}}static PTZVectorToXML(t){let e="x"in t||"pan"in t?Tt.formatPTZSimpleVector(t):t;return(e.panTilt?`<PanTilt x="${e.panTilt.x}" y="${e.panTilt.y}" xmlns="http://www.onvif.org/ver10/schema"/>`:"")+(e.zoom?`<Zoom x="${e.zoom.x}" xmlns="http://www.onvif.org/ver10/schema"/>`:"")}async gotoPreset({profileToken:t,presetToken:e,speed:n}){await this.onvif.request({service:"PTZ",body:`<GotoPreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken><PresetToken>${e}</PresetToken>${n?`<Speed>${Tt.PTZVectorToXML(n)}</Speed>`:""}</GotoPreset>`})}async setPreset({profileToken:t,presetName:e,presetToken:n}){let[i]=await this.onvif.request({service:"PTZ",body:`<SetPreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t??this.onvif.activeSource.profileToken}</ProfileToken><PresetName>${e}</PresetName>${n?`<PresetToken>${n}</PresetToken>`:""}</SetPreset>`});return(0,Kt.linerase)(i[0].setPresetResponse)}async removePreset({profileToken:t=this.onvif.activeSource?.profileToken,presetToken:e}){await this.onvif.request({service:"PTZ",body:`<RemovePreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><PresetToken>${e}</PresetToken></RemovePreset>`})}async gotoHomePosition({profileToken:t=this.onvif.activeSource?.profileToken,speed:e}){await this.onvif.request({service:"PTZ",body:`<GotoHomePosition xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken>${e?`<Speed>${Tt.PTZVectorToXML(e)}</Speed>`:""}</GotoHomePosition>`})}async setHomePosition({profileToken:t=this.onvif.activeSource?.profileToken}){await this.onvif.request({service:"PTZ",body:`<SetHomePosition xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken></SetHomePosition>`})}async getStatus({profileToken:t=this.onvif.activeSource?.profileToken}={}){let[e]=await this.onvif.request({service:"PTZ",body:`<GetStatus xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken></GetStatus>`});return(0,Kt.linerase)(e).getStatusResponse.PTZStatus}async absoluteMove({profileToken:t=this.onvif.activeSource?.profileToken,position:e,speed:n}){await this.onvif.request({service:"PTZ",body:`<AbsoluteMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><Position>${Tt.PTZVectorToXML(e)}</Position>${n?`<Speed>${Tt.PTZVectorToXML(n)}</Speed>`:""}</AbsoluteMove>`})}async relativeMove({profileToken:t=this.onvif.activeSource?.profileToken,translation:e,speed:n}){await this.onvif.request({service:"PTZ",body:`<RelativeMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><Translation>${Tt.PTZVectorToXML(e)}</Translation>${n?`<Speed>${Tt.PTZVectorToXML(n)}</Speed>`:""}</RelativeMove>`})}async continuousMove({profileToken:t=this.onvif.activeSource?.profileToken,velocity:e,timeout:n}){await this.onvif.request({service:"PTZ",body:`<ContinuousMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><Velocity>${Tt.PTZVectorToXML(e)}</Velocity>${n?`<Timeout>${typeof n=="number"?`PT${n/1e3}S`:n}</Timeout>`:""}</ContinuousMove>`})}async stop(t){let e=t?.profileToken||this.onvif?.activeSource?.profileToken,n=t?.panTilt??!0,i=t?.zoom??!0;await this.onvif.request({service:"PTZ",body:`<Stop xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${e}</ProfileToken><PanTilt>${n}</PanTilt><Zoom>${i}</Zoom></Stop>`})}};kt.PTZ=Tt;ce=new WeakMap,Qt=new WeakMap,Jt=new WeakMap});var Qe=X(he=>{"use strict";var Cr=he&&he.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(he,"__esModule",{value:!0});he.Onvif=void 0;var ns=require("events"),os=Cr(require("https")),ss=Cr(require("http")),le=require("buffer"),as=Cr(require("crypto")),Ke=se(),us=Dr(),cs=Er(),ls=Nr(),te=class extends ns.EventEmitter{constructor(t){super(),this.preserveAddress=!1,this.defaultProfiles=[],this.activeSources=[],this.useSecure=t.useSecure??!1,this.secureOptions=t.secureOptions??{},this.hostname=t.hostname,this.username=t.username,this.password=t.password,this.port=t.port??(t.useSecure?443:80),this.path=t.path??"/onvif/device_service",this.timeout=t.timeout||12e4,this.urn=t.urn,this.agent=t.agent??!1,this.preserveAddress=t.preserveAddress??!1,this.events={},this.uri={},this.capabilities={},this.device=new us.Device(this),this.media=new cs.Media(this),this.ptz=new ls.PTZ(this),this.on("newListener",e=>{e==="event"&&this.listeners(e).length===0&&setImmediate(()=>{})}),t.autoConnect&&setImmediate(()=>{this.connect().catch(e=>this.emit("error",e))})}envelopeHeader(t=!1){let e='<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing"><s:Header>';if(this.username&&this.password){let n=this.passwordDigest();e+=`<Security s:mustUnderstand="1" xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"><UsernameToken><Username>${this.username}</Username><Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest">${n.passDigest}</Password><Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">${n.nonce}</Nonce><Created xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">${n.timestamp}</Created></UsernameToken></Security>`}return t!==void 0&&t||(e+='</s:Header><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">'),e}envelopeFooter(){return"</s:Body></s:Envelope>"}passwordDigest(){let t=new Date(process.uptime()*1e3+(this.timeShift||0)).toISOString(),e=le.Buffer.allocUnsafe(16);e.writeUIntLE(Math.ceil(Math.random()*4294967296),0,4),e.writeUIntLE(Math.ceil(Math.random()*4294967296),4,4),e.writeUIntLE(Math.ceil(Math.random()*4294967296),8,4),e.writeUIntLE(Math.ceil(Math.random()*4294967296),12,4);let n=as.default.createHash("sha1");return n.update(le.Buffer.concat([e,le.Buffer.from(t,"ascii"),le.Buffer.from(this.password,"ascii")])),{passDigest:n.digest("base64"),nonce:e.toString("base64"),timestamp:t}}setupSystemDateAndTime(t){let e=t[0].getSystemDateAndTimeResponse[0].systemDateAndTime[0],n=e.UTCDateTime||e.localDateTime,i;if(n===void 0)i=new Date;else{let o=(0,Ke.linerase)(n[0]);i=new Date(Date.UTC(o.date.year,o.date.month-1,o.date.day,o.time.hour,o.time.minute,o.time.second))}return this.timeShift||(this.timeShift=i.getTime()-process.uptime()*1e3),i}async rawRequest(t){return new Promise((e,n)=>{let i=!1,o={...t,hostname:this.hostname,path:t.service?this.uri[t.service]?this.uri[t.service]?.pathname:t.service:this.path,port:this.port,agent:this.agent,timeout:this.timeout};o.headers={"Content-Type":"application/soap+xml","Content-Length":le.Buffer.byteLength(t.body,"utf8"),charset:"utf-8"},o.method="POST";let s=this.useSecure?os.default:ss.default;this.useSecure&&Object.assign(o,this.secureOptions);let f=s.request(o,p=>{let T=[],E=0;p.on("data",b=>{T.push(b),E+=b.length}),p.on("end",()=>{if(i)return;i=!0;let b=le.Buffer.concat(T,E).toString("utf8");this.emit("rawResponse",b),e((0,Ke.parseSOAPString)(b))})});f.setTimeout(this.timeout,()=>{i||(i=!0,f.destroy(),n(new Error("Network timeout")))}),f.on("error",p=>{i||(i=!0,p.code==="ECONNREFUSED"&&p.errno==="ECONNREFUSED"&&p.syscall==="connect"||p.code==="ECONNRESET"&&p.errno==="ECONNRESET"&&p.syscall,n(p))}),this.emit("rawRequest",t.body),f.write(t.body),f.end()})}request(t){if(!t.body)throw new Error("There is no 'body' field in request options");return this.rawRequest({...t,body:`${this.envelopeHeader()}${t.body}${this.envelopeFooter()}`})}parseUrl(t){let e=new URL(t);return this.preserveAddress&&(this.hostname!==e.hostname||this.port.toString()!==e.port)&&(e.hostname=this.hostname,e.host=`${this.hostname}:${this.port}`,e.port=this.port.toString(),e.href=e.toString()),e}async getSystemDateAndTime(){let[t,e]=await this.rawRequest({body:'<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><GetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"/></s:Body></s:Envelope>'});try{return this.setupSystemDateAndTime(t)}catch(n){if(e&&e.toLowerCase().includes("sender not authorized")){let[i]=await this.request({body:'<GetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"/>}'});return this.setupSystemDateAndTime(i)}throw n}}async setSystemDateAndTime(t){if(!["Manual","NTP"].includes(t.dateTimeType))throw new Error("DateTimeType should be `Manual` or `NTP`");let[e]=await this.request({body:`<SetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"><DateTimeType>${t.dateTimeType}</DateTimeType><DaylightSavings>${!!t.daylightSavings}</DaylightSavings>${t.timezone!==void 0?`<TimeZone><TZ xmlns="http://www.onvif.org/ver10/schema">${t.timezone}</TZ></TimeZone>`:""}${t.dateTime!==void 0&&t.dateTime instanceof Date?`<UTCDateTime><Time xmlns="http://www.onvif.org/ver10/schema"><Hour>${t.dateTime.getUTCHours()}</Hour><Minute>${t.dateTime.getUTCMinutes()}</Minute><Second>${t.dateTime.getUTCSeconds()}</Second></Time><Date xmlns="http://www.onvif.org/ver10/schema"><Year>${t.dateTime.getUTCFullYear()}</Year><Month>${t.dateTime.getUTCMonth()+1}</Month><Day>${t.dateTime.getUTCDate()}</Day></Date></UTCDateTime>`:""}</SetSystemDateAndTime>`});if((0,Ke.linerase)(e).setSystemDateAndTimeResponse!=="")throw new Error(`Wrong 'SetSystemDateAndTime' response: '${(0,Ke.linerase)(e).setSystemDateAndTimeResponse}'`);return this.getSystemDateAndTime()}async getActiveSources(){this.media.videoSources.forEach((t,e)=>{let n=t.token,i=this.media.profiles.filter(o=>(o.videoSourceConfiguration?o.videoSourceConfiguration.sourceToken===n:!1)&&o.videoEncoderConfiguration!==void 0);if(i.length===0){if(e===0)throw new Error("Unrecognized configuration");return}if(e===0&&([this.defaultProfile]=i),[this.defaultProfiles[e]]=i,this.activeSources[e]={sourceToken:t.token,profileToken:this.defaultProfiles[e].token,videoSourceConfigurationToken:this.defaultProfiles[e].videoSourceConfiguration.token},this.defaultProfiles[e].videoEncoderConfiguration){let o=this.defaultProfiles[e].videoEncoderConfiguration;this.activeSources[e].encoding=o?.encoding,this.activeSources[e].width=o?.resolution.width,this.activeSources[e].height=o?.resolution.height,this.activeSources[e].fps=o?.rateControl?.frameRateLimit,this.activeSources[e].bitrate=o?.rateControl?.bitrateLimit}e===0&&(this.activeSource=this.activeSources[e]),this.defaultProfiles[e].PTZConfiguration&&(this.activeSources[e].ptz={name:this.defaultProfiles[e].PTZConfiguration.name,token:this.defaultProfiles[e].PTZConfiguration.token})})}async connect(){await this.getSystemDateAndTime();try{await this.device.getServices()}catch{await this.device.getCapabilities()}return await Promise.all([this.media.getProfiles(),this.media.getVideoSources()]),await this.getActiveSources(),this.emit("connect"),this}};he.Onvif=te;te.rawRequest="rawRequest";te.rawResponse="rawResponse";te.warn="warn";te.error="error"});var qn=X(Vt=>{"use strict";var Rn=Vt&&Vt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.Discovery=Vt.DiscoverySingleton=void 0;var hs=require("events"),fs=require("dgram"),ps=Rn(require("url")),ds=Rn(require("os")),Or=se(),ms=Qe();function gs(r,t){return r.filter(n=>n.hostname===t)[0]||r[0]}var Nt=class extends hs.EventEmitter{constructor(){super()}static get getInstance(){return Nt.instance||(Nt.instance=new Nt),Nt.instance}probe(t){return new Promise((e,n)=>{let i=new Map,o=[],s=`urn:uuid:${t.messageId||(0,Or.guid)()}`,f=Buffer.from(`<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope" xmlns:dn="http://www.onvif.org/ver10/network/wsdl"><Header><wsa:MessageID xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">${s}</wsa:MessageID><wsa:To xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">urn:schemas-xmlsoap-org:ws:2005:04:discovery</wsa:To><wsa:Action xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">http://schemas.xmlsoap.org/ws/2005/04/discovery/Probe</wsa:Action></Header><Body><Probe xmlns="http://schemas.xmlsoap.org/ws/2005/04/discovery" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><Types>dn:NetworkVideoTransmitter</Types><Scopes /></Probe></Body></Envelope>`),p=(0,fs.createSocket)(t.type??"udp4");p.on("error",E=>{this.emit("error",E)});let T=async(E,b)=>{let v,h;try{[v,h]=await(0,Or.parseSOAPString)(E.toString())}catch(w){o.push(w),this.emit("error",w,h);return}if(!v[0].probeMatches)o.push(new Error(`Wrong SOAP message from ${b.address}:${b.port}
${h}`)),this.emit("error",`Wrong SOAP message from ${b.address}:${b.port}`,h);else{v=(0,Or.linerase)(v);let w=v.probeMatches.probeMatch.endpointReference.address;if(!i.has(w)){let O;if(t.resolve!==!1){let F=v.probeMatches.probeMatch.XAddrs.split(" ").map(ps.default.parse),P=gs(F,b.address);O=new ms.Onvif({hostname:P.hostname,port:parseInt(P.port,10),path:P.pathname,urn:w})}else O=v;i.set(w,O),this.emit("device",O,b,h)}}};if(t.device){let E=ds.default.networkInterfaces();t.device in E&&E[t.device]?.forEach(b=>{b.family==="IPv4"&&p.bind(t.listeningPort,b.address)})}p.on("message",T),p.send(f,0,f.length,3702,"239.255.255.250"),setTimeout(()=>{p.removeListener("message",T),p.close(),o.length===0?e(Array.from(i.values())):n(o)},t.timeout||5e3)})}};Vt.DiscoverySingleton=Nt;Nt.device="device";Nt.error="error";Vt.Discovery=Nt.getInstance});var jn=X(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.Cam=void 0;var ys=require("events"),ws=Qe(),_r=class extends ys.EventEmitter{constructor(t,e){super(),this.onvif=new ws.Onvif({...t,autoConnect:e!==void 0?!1:t.autoconnect}),e&&this.onvif.connect().then(n=>e(null,n)).catch(e)}get port(){return this.onvif.port}get path(){return this.onvif.path}set hostname(t){this.onvif.hostname=t}set timeout(t){this.onvif.timeout=t}get timeout(){return this.onvif.timeout}get services(){return this.onvif.device.services}get capabilities(){return this.onvif.capabilities}get uri(){return this.onvif.uri}get videoSources(){return this.onvif.media.videoSources}get profiles(){return this.onvif.media.profiles}get defaultProfile(){return this.onvif.defaultProfile}get defaultProfiles(){return this.onvif.defaultProfiles}get activeSource(){return this.onvif.activeSource}get serviceCapabilities(){return this.onvif.device.serviceCapabilities}get deviceInformation(){return this.onvif.deviceInformation}get nodes(){return this.onvif.ptz.nodes}get configurations(){return this.onvif.ptz.configurations}get presets(){return Object.fromEntries(Object.values(this.onvif.ptz.presets).map(t=>[t.name,t.token]))}connect(t){this.onvif.connect().then(e=>t(null,e)).catch(t)}_request(t,e){if(typeof e!="function")throw new Error("`callback` must be a function");this.onvif.request(t).then(n=>e(null,n)).catch(e)}getSystemDateAndTime(t){this.onvif.device.getSystemDateAndTime().then(e=>t(null,e)).catch(t)}setSystemDateAndTime(t,e){this.onvif.device.setSystemDateAndTime(t).then(n=>e(null,n)).catch(e)}getHostname(t){this.onvif.device.getHostname().then(e=>t(null,e)).catch(t)}getScopes(t){this.onvif.device.getScopes().then(e=>t(null,e)).catch(t)}setScopes(t,e){this.onvif.device.setScopes(t).then(n=>e(null,n)).catch(e)}getCapabilities(t){this.onvif.device.getCapabilities().then(e=>t(null,e)).catch(t)}getServiceCapabilities(t){this.onvif.device.getServiceCapabilities().then(e=>t(null,e)).catch(t)}getActiveSources(t){this.onvif.getActiveSources().then(e=>t(null,e)).catch(t)}getVideoSources(t){this.onvif.media.getVideoSources().then(e=>t(null,e)).catch(t)}getServices(t,e){this.onvif.device.getServices(t).then(n=>e(null,n)).catch(e)}getDeviceInformation(t){this.onvif.device.getDeviceInformation().then(e=>t(null,e)).catch(t)}getStreamUri(t,e){e&&this.onvif.media.getStreamUri(t).then(n=>e(null,n)).catch(e),this.onvif.media.getStreamUri().then(n=>t(null,n)).catch(t)}getSnapshotUri(t,e){e&&this.onvif.media.getSnapshotUri(t).then(n=>e(null,n)).catch(e),this.onvif.media.getSnapshotUri().then(n=>t(null,n)).catch(t)}getNodes(t){this.onvif.ptz.getNodes().then(e=>t(null,e)).catch(t)}getConfigurations(t){this.onvif.ptz.getConfigurations().then(e=>t(null,e)).catch(t)}getConfigurationOptions(t,e){this.onvif.ptz.getConfigurationOptions({configurationToken:t}).then(n=>e(null,n)).catch(e)}systemReboot(t){this.onvif.device.systemReboot().then(e=>t(null,e)).catch(t)}getPresets(t,e){e&&this.onvif.ptz.getPresets(t).then(n=>e(null,Object.fromEntries(Object.values(n).map(i=>[i.name,i.token])))).catch(e),this.onvif.ptz.getPresets().then(n=>t(null,Object.fromEntries(Object.values(n).map(i=>[i.name,i.token])))).catch(t)}gotoPreset(t,e){this.onvif.ptz.gotoPreset(t).then(n=>e(null,n)).catch(e)}setPreset(t,e){this.onvif.ptz.setPreset(t).then(n=>e(null,n)).catch(e)}removePreset(t,e){this.onvif.ptz.removePreset(t).then(n=>e(null,n)).catch(e)}gotoHomePosition(t,e){this.onvif.ptz.gotoHomePosition(t).then(n=>e(null,n)).catch(e)}setHomePosition(t,e){this.onvif.ptz.setHomePosition(t).then(n=>e(null,n)).catch(e)}getStatus(t,e){e&&this.onvif.ptz.getStatus(t).then(n=>e(null,n)).catch(e),this.onvif.ptz.getStatus().then(n=>t(null,n)).catch(t)}absoluteMove(t,e){let n={...t,position:{panTilt:{x:t.x,y:t.y},zoom:{x:t.zoom}}};e?this.onvif.ptz.absoluteMove(n).then(i=>e(null,i)).catch(e):this.onvif.ptz.absoluteMove(n).catch(i=>this.emit("error",i))}relativeMove(t,e){let n={...t,translation:{panTilt:{x:t.x,y:t.y},zoom:{x:t.zoom}}};e?this.onvif.ptz.relativeMove(n).then(i=>e(null,i)).catch(e):this.onvif.ptz.relativeMove(n).catch(i=>this.emit("error",i))}continuousMove(t,e){let n={...t,velocity:{...t.x&&t.y&&!t.onlySendZoom&&{panTilt:{x:t.x,y:t.y}},...t.zoom&&!t.onlySendPanTilt&&{zoom:{x:t.zoom}}}};e?this.onvif.ptz.continuousMove(n).then(i=>e(null,i)).catch(e):this.onvif.ptz.continuousMove(n).catch(i=>this.emit("error",i))}stop(t,e){e&&this.onvif.ptz.stop(t).then(n=>e(null,n)).catch(e),this.onvif.ptz.stop().then(n=>{typeof t=="function"&&t(null,n)}).catch(t||(n=>this.emit("error",n)))}getNTP(t){this.onvif.device.getNTP().then(e=>t(null,e)).catch(t)}getDNS(t){this.onvif.device.getDNS().then(e=>t(null,e)).catch(t)}getNetworkInterfaces(t){this.onvif.device.getNetworkInterfaces().then(e=>t(null,e)).catch(t)}};Je.Cam=_r});var $n=X(bt=>{"use strict";var vs=bt&&bt.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,n,i)}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),fe=bt&&bt.__exportStar||function(r,t){for(var e in r)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&vs(t,r,e)};Object.defineProperty(bt,"__esModule",{value:!0});fe(Qe(),bt);fe(Dr(),bt);fe(Er(),bt);fe(qn(),bt);fe(Nr(),bt);fe(jn(),bt)});var yt=dt(require("fs")),Vn=dt(require("path")),Rr=dt(require("sharp")),it=dt(Ae());var tt=dt(require("fs")),Me=dt(require("zlib")),ni=dt(require("http")),oi=dt(require("http2")),K=dt(require("path")),ft=dt(Ae()),$,ko={".html":"text/html; charset=utf-8",".js":"text/javascript; charset=utf-8",".css":"text/css; charset=utf-8",".json":"application/json; charset=utf-8",".png":"image/png",".jpg":"image/jpeg",".gif":"image/gif",".ico":"image/x-icon",".svg":"image/svg+xml",".wav":"audio/wav",".mp4":"video/mp4",".woff":"font/woff",".woff2":"font/woff2",".ttf":"font/ttf",".wasm":"application/wasm",".webmanifest":"application/manifest+json"};function Vo(r){r=r.split(/[?#]/)[0];let t={ok:!1,stat:null,file:"",redirect:null},e=i=>(t.file=i,tt.existsSync(i)&&(t.stat=tt.statSync(i),t.stat.isFile())?(t.ok=!0,!0):!1),n=i=>(t.file=i,tt.existsSync(i)&&(t.stat=tt.statSync(i),t.stat.isDirectory())?(t.ok=!0,!0):!1);return new Promise(i=>{n(K.join(process.cwd(),$.documentRoot,r))&&e(K.join(process.cwd(),$.documentRoot,r,$.defaultFile))?(t.redirect=K.join(r,$.defaultFile),i(t)):(e(K.join(process.cwd(),$.documentRoot,r))||e(K.join(process.cwd(),$.documentRoot,r,$.defaultFile))||e(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r))||e(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r,$.defaultFile))||n(K.join(process.cwd(),$.documentRoot,r))||n(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r))||n(K.join(K.dirname(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r,$.defaultFile,r)))),i(t))})}var si=[];function zo(r,t,e){let n=!1;for(let i of si)r.startsWith(i.url)&&(n=!0,i.callback(t,e));return n}function ai(r,t){ft.state("http api",{url:r}),si.push({url:r,callback:t})}async function ii(r,t){let e=decodeURI(r.url);zo(e,r,t)||Vo(e).then(i=>{let o=(r.headers.forwarded||"").match(/for="\[(.*)\]:/),s=(Array.isArray(o)?o[1]:null)||r.headers["x-forwarded-for"]||r.ip||r.socket.remoteAddress,f=r.headers[":scheme"]||"http";if(!i||!i.ok||!i.stat)t.writeHead(404,{"Content-Type":"text/html; charset=utf-8"}),t.end(`Error 404: Not Found
`,"utf-8"),ft.warn(`${f}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,url:e,remote:s});else if(i.redirect)t.writeHead(301,{Location:i.redirect}),t.end(),ft.data(`${f}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,url:e,redirect:i.redirect,remote:s});else{let p=encodeURIComponent(i.file).replace(/\*/g,"").replace(/\?/g,"").replace(/%2F/g,"/").replace(/%40/g,"@").replace(/%20/g," ").replace(/%3A/g,":").replace(/%5C/g,"\\");if(i?.stat?.isFile()){let T=String(K.extname(p)).toLowerCase(),E=ko[T]||"application/octet-stream",b=r.headers.range,v=b?.replace("bytes=","").split("-")||[0,i.stat.size-1],h=parseInt(v[0]||0),w=parseInt(v[1]||i.stat.size-1),O=r.headers["accept-encoding"]?r.headers["accept-encoding"].includes("br"):!1,F=b?{"Content-Range":"bytes "+h+"-"+w+"/"+i.stat.size,"Accept-Ranges":"bytes","Content-Length":w-h+1}:{},P=$.cors?{"Cross-Origin-Embedder-Policy":"require-corp","Cross-Origin-Opener-Policy":"same-origin"}:{};t.writeHead(b?206:200,{"Content-Size":i.stat.size,"Content-Language":"en","Content-Type":E,"Content-Encoding":O&&!b?"br":"","Last-Modified":i.stat.mtime.toUTCString(),"Cache-Control":"no-cache","X-Content-Type-Options":"nosniff","Content-Security-Policy":"media-src 'self' http: https: data:","`Service-Worker-Allowed":"/",...P,...F});let R=Me.createBrotliCompress({params:{[Me.constants.BROTLI_PARAM_QUALITY]:5}}),g=b?tt.createReadStream(p,{start:h,end:w}):tt.createReadStream(p);!O||b?g.pipe(t):g.pipe(R).pipe(t);let c=b?{range:{start:h,end:w,size:w-h+1}}:{};ft.data(`${f}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,mime:E.replace("; charset=utf-8",""),size:i.stat.size,...c,url:e,remote:s})}if(i?.stat?.isDirectory()){t.writeHead(200,{"Content-Language":"en","Content-Type":"application/json; charset=utf-8","Last-Modified":i.stat.mtime,"Cache-Control":"no-cache","X-Content-Type-Options":"nosniff"});let T=tt.readdirSync(p);T=T.map(E=>K.join(decodeURI(r.url),E)),t.end(JSON.stringify(T),"utf-8"),ft.data(`${f}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,mime:"directory/json",size:i.stat.size,url:e,remote:s})}}})}async function ui(r){if($={insecureHTTPParser:!1,...r},tt.existsSync($.sslKey)&&tt.existsSync($.sslCrt))$.key=tt.readFileSync($.sslKey),$.cert=tt.readFileSync($.sslCrt);else try{let t=require.resolve("@vladmandic/build");$.sslKey=K.join(K.dirname(t),"..",$.sslKey),$.sslCrt=K.join(K.dirname(t),"..",$.sslCrt),$.key=tt.existsSync($.sslKey)?tt.readFileSync($.sslKey):null,$.cert=tt.existsSync($.sslCrt)?tt.readFileSync($.sslCrt):null}catch{}(!$.key||!$.cert)&&ft.warn("cannot read SSL certificate"),$.httpPort&&$.httpPort>0&&await new Promise(t=>{let e=ni.createServer($,ii);e.on("listening",()=>{ft.state("http:",{port:$.httpPort,root:$.documentRoot}),t(!0)}),e.on("error",n=>{ft.error("http:",n.message||n),t(!1)}),e.listen($.httpPort)}),$.httpsPort&&$.httpsPort>0&&$.key&&$.cert&&await new Promise(t=>{let e=oi.createSecureServer($,ii);e.on("listening",()=>{ft.state("https:",{port:$.httpsPort,root:$.documentRoot,sslKey:$.sslKey,sslCrt:$.sslCrt}),t(!0)}),e.on("error",n=>{ft.error("https:",n.message||n),t(!1)}),e.listen($.httpsPort)})}var Fe=dt(Ae()),li=require("url");var oe=[],we={};async function Go(r){let t=oe.find(n=>n.label===r);return t?await t.snapshot():void 0}async function Ho(r,t){let e=new li.URLSearchParams(r.url),n=await Go(e.get("device")),i=r.headers[":scheme"]||"http",o=(r.headers.forwarded||"").match(/for="\[(.*)\]:/),s=(Array.isArray(o)?o[1]:null)||r.headers["x-forwarded-for"]||r.ip||r.socket.remoteAddress;if(!n)Fe.warn(`${i}:`,{method:"API",ver:r.httpVersion,status:404,url:decodeURI(r.url),remote:s}),t.writeHead(404,{"Content-Type":"text/html; charset=utf-8"}),t.end(`Error 404: Not Found
`,"utf-8");else{Fe.data(`${i}:`,{method:"API",ver:r.httpVersion,status:200,mime:n.type,size:n.size,url:decodeURI(r.url),remote:s}),t.writeHead(200,{"Content-Size":n.size,"Content-Language":"en","Content-Type":n.type,"Cache-Control":"no-cache","X-Content-Type-Options":"nosniff"});let f=await n.arrayBuffer(),p=Buffer.from(f);t.end(p)}}function hi(){ai("/snapshot",Ho)}var Bn=dt($n());var Ir=0;var De=r=>bs(Ts(Ds(r)));function Ts(r){return Es(Ps(Ss(r),r.length*8))}function bs(r){try{}catch{Ir=0}let t=Ir?"0123456789ABCDEF":"0123456789abcdef",e="",n;for(let i=0;i<r.length;i++)n=r.charCodeAt(i),e+=t.charAt(n>>>4&15)+t.charAt(n&15);return e}function Ds(r){let t="",e=-1,n,i;for(;++e<r.length;)n=r.charCodeAt(e),i=e+1<r.length?r.charCodeAt(e+1):0,n>=55296&&n<=56319&&i>=56320&&i<=57343&&(n=65536+((n&1023)<<10)+(i&1023),e++),n<=127?t+=String.fromCharCode(n):n<=2047?t+=String.fromCharCode(192|n>>>6&31,128|n&63):n<=65535?t+=String.fromCharCode(224|n>>>12&15,128|n>>>6&63,128|n&63):n<=2097151&&(t+=String.fromCharCode(240|n>>>18&7,128|n>>>12&63,128|n>>>6&63,128|n&63));return t}function Ss(r){let t=Array(r.length>>2);for(let e=0;e<t.length;e++)t[e]=0;for(let e=0;e<r.length*8;e+=8)t[e>>5]|=(r.charCodeAt(e/8)&255)<<e%32;return t}function Es(r){let t="";for(let e=0;e<r.length*32;e+=8)t+=String.fromCharCode(r[e>>5]>>>e%32&255);return t}function Ps(r,t){r[t>>5]|=128<<t%32,r[(t+64>>>9<<4)+14]=t;let e=1732584193,n=-271733879,i=-1732584194,o=271733878;for(let s=0;s<r.length;s+=16){let f=e,p=n,T=i,E=o;e=ot(e,n,i,o,r[s+0],7,-680876936),o=ot(o,e,n,i,r[s+1],12,-389564586),i=ot(i,o,e,n,r[s+2],17,606105819),n=ot(n,i,o,e,r[s+3],22,-1044525330),e=ot(e,n,i,o,r[s+4],7,-176418897),o=ot(o,e,n,i,r[s+5],12,1200080426),i=ot(i,o,e,n,r[s+6],17,-1473231341),n=ot(n,i,o,e,r[s+7],22,-45705983),e=ot(e,n,i,o,r[s+8],7,1770035416),o=ot(o,e,n,i,r[s+9],12,-1958414417),i=ot(i,o,e,n,r[s+10],17,-42063),n=ot(n,i,o,e,r[s+11],22,-1990404162),e=ot(e,n,i,o,r[s+12],7,1804603682),o=ot(o,e,n,i,r[s+13],12,-40341101),i=ot(i,o,e,n,r[s+14],17,-1502002290),n=ot(n,i,o,e,r[s+15],22,1236535329),e=st(e,n,i,o,r[s+1],5,-165796510),o=st(o,e,n,i,r[s+6],9,-1069501632),i=st(i,o,e,n,r[s+11],14,643717713),n=st(n,i,o,e,r[s+0],20,-373897302),e=st(e,n,i,o,r[s+5],5,-701558691),o=st(o,e,n,i,r[s+10],9,38016083),i=st(i,o,e,n,r[s+15],14,-660478335),n=st(n,i,o,e,r[s+4],20,-405537848),e=st(e,n,i,o,r[s+9],5,568446438),o=st(o,e,n,i,r[s+14],9,-1019803690),i=st(i,o,e,n,r[s+3],14,-187363961),n=st(n,i,o,e,r[s+8],20,1163531501),e=st(e,n,i,o,r[s+13],5,-1444681467),o=st(o,e,n,i,r[s+2],9,-51403784),i=st(i,o,e,n,r[s+7],14,1735328473),n=st(n,i,o,e,r[s+12],20,-1926607734),e=at(e,n,i,o,r[s+5],4,-378558),o=at(o,e,n,i,r[s+8],11,-2022574463),i=at(i,o,e,n,r[s+11],16,1839030562),n=at(n,i,o,e,r[s+14],23,-35309556),e=at(e,n,i,o,r[s+1],4,-1530992060),o=at(o,e,n,i,r[s+4],11,1272893353),i=at(i,o,e,n,r[s+7],16,-155497632),n=at(n,i,o,e,r[s+10],23,-1094730640),e=at(e,n,i,o,r[s+13],4,681279174),o=at(o,e,n,i,r[s+0],11,-358537222),i=at(i,o,e,n,r[s+3],16,-722521979),n=at(n,i,o,e,r[s+6],23,76029189),e=at(e,n,i,o,r[s+9],4,-640364487),o=at(o,e,n,i,r[s+12],11,-421815835),i=at(i,o,e,n,r[s+15],16,530742520),n=at(n,i,o,e,r[s+2],23,-995338651),e=ut(e,n,i,o,r[s+0],6,-198630844),o=ut(o,e,n,i,r[s+7],10,1126891415),i=ut(i,o,e,n,r[s+14],15,-1416354905),n=ut(n,i,o,e,r[s+5],21,-57434055),e=ut(e,n,i,o,r[s+12],6,1700485571),o=ut(o,e,n,i,r[s+3],10,-1894986606),i=ut(i,o,e,n,r[s+10],15,-1051523),n=ut(n,i,o,e,r[s+1],21,-2054922799),e=ut(e,n,i,o,r[s+8],6,1873313359),o=ut(o,e,n,i,r[s+15],10,-30611744),i=ut(i,o,e,n,r[s+6],15,-1560198380),n=ut(n,i,o,e,r[s+13],21,1309151649),e=ut(e,n,i,o,r[s+4],6,-145523070),o=ut(o,e,n,i,r[s+11],10,-1120210379),i=ut(i,o,e,n,r[s+2],15,718787259),n=ut(n,i,o,e,r[s+9],21,-343485551),e=zt(e,f),n=zt(n,p),i=zt(i,T),o=zt(o,E)}return[e,n,i,o]}function tr(r,t,e,n,i,o){return zt(Ns(zt(zt(t,r),zt(n,o)),i),e)}function ot(r,t,e,n,i,o,s){return tr(t&e|~t&n,r,t,i,o,s)}function st(r,t,e,n,i,o,s){return tr(t&n|e&~n,r,t,i,o,s)}function at(r,t,e,n,i,o,s){return tr(t^e^n,r,t,i,o,s)}function ut(r,t,e,n,i,o,s){return tr(e^(t|~n),r,t,i,o,s)}function zt(r,t){let e=(r&65535)+(t&65535);return(r>>16)+(t>>16)+(e>>16)<<16|e&65535}function Ns(r,t){return r<<t|r>>>32-t}var er=(r,t,e=!0)=>{let i=new RegExp(`${t}=("[^"]*"|[^,]*)`,"i").exec(r);return i?e?i[1].replace(/[\s"]/g,""):i[1]:null},Cs=r=>{let t=er(r,"qop");if(t){let e=t.split(",");if(e.includes("auth"))return"auth";if(e.includes("auth-int"))return"auth-int"}return null},Os=()=>{let r="",t="abcdef0123456789";for(let e=0;e<32;++e)r+=t[Math.floor(Math.random()*t.length)];return r},pe=class{constructor(t,e,n){rt(this,"user");rt(this,"password");rt(this,"basic");rt(this,"statusCode");rt(this,"digest");rt(this,"header");rt(this,"hasAuth");rt(this,"lastAuth");this.user=t,this.password=e,this.digest={nc:0,algorithm:"MD5",realm:""},this.header="",this.hasAuth=!1,this.statusCode=n?.statusCode||401,this.basic=n?.basic||!1}async fetch(t,e={}){if(this.basic)return fetch(t,this.addBasicAuth(e));let n=await fetch(t,this.addAuth(t,e));if(n.status===401||n.status===this.statusCode&&this.statusCode){if(this.hasAuth=!1,await this.parseAuth(n.headers.get("www-authenticate")),this.hasAuth){let i=this.addAuth(t,e);this.header=i?.headers?.get("authorization");let o=await fetch(t,i);return o.status===this.statusCode?this.hasAuth=!1:this.digest.nc++,o}}else this.digest.nc++;return n}addBasicAuth(t){let e=t,n="Basic "+Buffer.from(this.user+":"+this.password).toString("base64");return e.headers=new Headers,e.headers.set("Authorization",n),e}static computeHash(t,e,n){return De(`${t}:${e}:${n}`)}addAuth(t,e){if(!this.hasAuth)return e;let o=(typeof t=="object"&&typeof t.url=="string"?t.url:t).replace("//",""),s=o.indexOf("/")===-1?"/":o.slice(o.indexOf("/")),f=e.method?e.method.toUpperCase():"GET",p=pe.computeHash(this.user,this.digest.realm,this.password);if(this.digest.algorithm==="MD5-sess"&&(p=De(`${p}:${this.digest.nonce}:${this.digest.cnonce}`)),this.digest.qop==="auth-int")throw new Error("auth-int is not implemented");let T=De(`${f}:${s}`),E=("00000000"+this.digest.nc).slice(-8),b=`${p}:${this.digest.nonce}:${E}:${this.digest.cnonce}:${this.digest.qop}:${T}`;this.digest.qop||(b=`${p}:${this.digest.nonce}:${T}`);let v=De(b),h=this.digest.opaque!==null?`opaque="${this.digest.opaque}",`:"",w=this.digest.qop?`qop="${this.digest.qop}",`:"",O=`${this.digest.scheme} username="${this.user}",realm="${this.digest.realm}",nonce="${this.digest.nonce}",uri="${s}",${h}${w}algorithm="${this.digest.algorithm}",response="${v}",nc=${E},cnonce="${this.digest.cnonce}"`;e.headers=new Headers,e.headers.set("Authorization",O);let F={};return Object.assign(F,e),F}async parseAuth(t){if(this.lastAuth=t,!t||t.length<5){this.hasAuth=!1;return}this.hasAuth=!0,this.digest.scheme=t.split(/\s/)[0],this.digest.realm=(er(t,"realm",!1)||"").replace(/["]/g,""),this.digest.qop=Cs(t),this.digest.opaque=er(t,"opaque"),this.digest.nonce=er(t,"nonce")||"",this.digest.cnonce=Os(),this.digest.nc++}};var rr=class{constructor(t){rt(this,"label");rt(this,"config");rt(this,"cam");rt(this,"video");rt(this,"image");rt(this,"settings",{});rt(this,"client");rt(this,"init",()=>new Promise(t=>{this.cam=new Bn.Cam({hostname:this.config.hostname,username:this.config.username,password:this.config.password,port:this.config.port},async()=>{let e=[new Promise(s=>{this.cam?.getStreamUri((f,p)=>s(p))}),new Promise(s=>{this.cam?.getSnapshotUri((f,p)=>s(p))}),new Promise(s=>{this.cam?.getVideoSources((f,p)=>s(p))})],[n,i,o]=await Promise.all(e);this.video=n?.uri,this.image=i?.uri,this.settings={fps:o?.[0]?.framerate,resolution:[o?.[0]?.resolution?.width||0,o?.[0]?.resolution?.height||0]},t(this.cam)})}));rt(this,"snapshot",async()=>{if(!this.image)return;let t=await this.client.fetch(this.image);if(t.status===200)return t.blob()});this.config=t,this.label=this.config.label,this.client=new pe(this.config.username,this.config.password)}get profile(){return this.cam?this.cam.defaultProfile:{}}get imaging(){return new Promise(t=>{this.cam?.getVideoSources((e,n)=>t(n?.[0]?.imaging))})}};var Un="@vladmandic/snaps",kn="0.1.0";var Ar={};Jn(Ar,{default:()=>qs,defaultFile:()=>Ls,defaultFolder:()=>Fs,devices:()=>nr,documentRoot:()=>Ms,folder:()=>ee,httpPort:()=>Is,httpsPort:()=>As,index:()=>Mr,interval:()=>Fr,log:()=>ir,quality:()=>xr,resizeWidth:()=>Lr,secrets:()=>Se,sslCrt:()=>Rs,sslKey:()=>xs});var Se="secrets.json",ir="snaps.log",ee="images",nr="images/devices.json",Mr="images/index.json",Fr=60,Is=8e3,As=8001,Ms=".",Fs="/",Ls="public/index.html",xs="node_modules/@vladmandic/build/cert/https.key",Rs="node_modules/@vladmandic/build/cert/https.crt",Lr=1280,xr=60,qs={secrets:Se,log:ir,folder:ee,devices:nr,index:Mr,interval:Fr,httpPort:Is,httpsPort:As,documentRoot:Ms,defaultFolder:Fs,defaultFile:Ls,sslKey:xs,sslCrt:Rs,resizeWidth:Lr,quality:xr};var js=r=>{let t=yt.readdirSync(ee),e=0;for(let n of t){if(!n.startsWith(`${r}-`))continue;let i=Number(n.replace(`${r}-`,"").split(".")[0]);i>e&&(e=i)}return e++,it.info("sequence:",{name:r,start:e}),e},zn=()=>{let r=new Date,t=e=>e.toString().padStart(2,"0");return`${r.getFullYear()}:${t(r.getMonth()+1)}:${t(r.getDate())} ${t(r.getHours())}:${t(r.getMinutes())}:${t(r.getSeconds())}`},$s=()=>({IFD0:{Software:`${Un} ${kn}`},IFD2:{DateTimeOriginal:zn(),OffsetTime:(new Date().getTimezoneOffset()/60).toString()}});async function Bs(r,t){if(t.type!=="image/jpeg"&&t.type!=="image/png"){it.warn("unrecognized file type:",{name:r,data:t});return}we[r]||(we[r]=js(r));let e=we[r].toString().padStart(5,"0"),n=Vn.join(ee,`${r}-${e}.jpg`),i=new Uint8Array(await t.arrayBuffer()),o=await(0,Rr.default)(i).metadata(),s=await(0,Rr.default)(i).normalize().resize(Lr,null).jpeg({quality:xr,mozjpeg:!0}).withMetadata({exif:$s()}).toFile(n);we[r]++;let f={seq:e,file:n,date:new Date,input:{name:r,size:t.size,type:t.type,resolution:[o.width,o.height]},output:{size:s.size,resolution:[s.width,s.height]}};yt.appendFileSync(Mr,JSON.stringify(f)+`
`),it.data("image:",f)}async function Xs(){for(let r of oe){let t=await r.snapshot();t&&await Bs(r.label,t)}}async function Us(){it.configure({inspect:{breakLength:500}}),ir?.length>0&&it.logFile(ir),it.headerJson(),yt.existsSync(Se)||(it.error("cannot read secrets:",Se),process.exit(1)),(!yt.existsSync(ee)||!yt.statSync(ee).isDirectory())&&(it.error("desitnation folder does not exist:",ee),process.exit(1));let r=yt.readFileSync(Se,"utf8"),t=JSON.parse(r);for(let n of t){let i=new rr(n);await i.init(),it.state("device",{label:i.label,resolution:i.settings.resolution}),i.image&&(await i.snapshot(),oe.push(i))}let e=oe.map(n=>({label:n.label,hostname:n.config.hostname,resolution:n.settings.resolution}));yt.writeFileSync(nr,JSON.stringify(e)),it.state("device info",{file:nr}),ui(Ar),hi(),setInterval(Xs,Fr*1e3),zn()}Us();
//# sourceMappingURL=snaps.js.map
