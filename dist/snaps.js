/*
  snaps
  homepage: <https://github.com/vladmandic/snaps>
  author: <https://github.com/vladmandic>'
*/

"use strict";var Ln=Object.create;var ge=Object.defineProperty;var xn=Object.getOwnPropertyDescriptor;var Fn=Object.getOwnPropertyNames;var Rn=Object.getPrototypeOf,qn=Object.prototype.hasOwnProperty;var jn=(r,t,e)=>t in r?ge(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var X=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),$n=(r,t)=>{for(var e in t)ge(r,e,{get:t[e],enumerable:!0})},Bn=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Fn(t))!qn.call(r,n)&&n!==e&&ge(r,n,{get:()=>t[n],enumerable:!(i=xn(t,n))||i.enumerable});return r};var ft=(r,t,e)=>(e=r!=null?Ln(Rn(r)):{},Bn(t||!r||!r.__esModule?ge(e,"default",{value:r,enumerable:!0}):e,r));var rt=(r,t,e)=>(jn(r,typeof t!="symbol"?t+"":t,e),e);var er=X((Ds,Gr)=>{"use strict";var Xn=Object.create,De=Object.defineProperty,Un=Object.getOwnPropertyDescriptor,qr=Object.getOwnPropertyNames,kn=Object.getPrototypeOf,Vn=Object.prototype.hasOwnProperty,zn=(r,t)=>function(){return t||(0,r[qr(r)[0]])((t={exports:{}}).exports,t),t.exports},Gn=(r,t)=>{for(var e in t)De(r,e,{get:t[e],enumerable:!0})},jr=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of qr(t))!Vn.call(r,n)&&n!==e&&De(r,n,{get:()=>t[n],enumerable:!(i=Un(t,n))||i.enumerable});return r},Ut=(r,t,e)=>(e=r!=null?Xn(kn(r)):{},jr(t||!r||!r.__esModule?De(e,"default",{value:r,enumerable:!0}):e,r)),Hn=r=>jr(De({},"__esModule",{value:!0}),r),Wn=zn({"node_modules/.pnpm/dayjs@1.11.4/node_modules/dayjs/dayjs.min.js"(r,t){(function(e,i){typeof r=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(e=typeof globalThis<"u"?globalThis:e||self).dayjs=i()})(r,function(){"use strict";var e=1e3,i=6e4,n=36e5,c="millisecond",l="second",f="minute",d="hour",T="day",S="week",b="month",v="quarter",h="year",w="date",C="Invalid Date",L=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,R={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},g=function(_,x,F){var M=String(_);return!M||M.length>=x?_:""+Array(x+1-M.length).join(F)+_},a={s:g,z:function(_){var x=-_.utcOffset(),F=Math.abs(x),M=Math.floor(F/60),q=F%60;return(x<=0?"+":"-")+g(M,2,"0")+":"+g(q,2,"0")},m:function _(x,F){if(x.date()<F.date())return-_(F,x);var M=12*(F.year()-x.year())+(F.month()-x.month()),q=x.clone().add(M,b),j=F-q<0,B=x.clone().add(M+(j?-1:1),b);return+(-(M+(F-q)/(j?q-B:B-q))||0)},a:function(_){return _<0?Math.ceil(_)||0:Math.floor(_)},p:function(_){return{M:b,y:h,w:S,d:T,D:w,h:d,m:f,s:l,ms:c,Q:v}[_]||String(_||"").toLowerCase().replace(/s$/,"")},u:function(_){return _===void 0}},o="en",y={};y[o]=R;var E=function(_){return _ instanceof O},p=function _(x,F,M){var q;if(!x)return o;if(typeof x=="string"){var j=x.toLowerCase();y[j]&&(q=j),F&&(y[j]=F,q=j);var B=x.split("-");if(!q&&B.length>1)return _(B[0])}else{var U=x.name;y[U]=x,q=U}return!M&&q&&(o=q),q||!M&&o},N=function(_,x){if(E(_))return _.clone();var F=typeof x=="object"?x:{};return F.date=_,F.args=arguments,new O(F)},m=a;m.l=p,m.i=E,m.w=function(_,x){return N(_,{locale:x.$L,utc:x.$u,x:x.$x,$offset:x.$offset})};var O=function(){function _(F){this.$L=p(F.locale,null,!0),this.parse(F)}var x=_.prototype;return x.parse=function(F){this.$d=function(M){var q=M.date,j=M.utc;if(q===null)return new Date(NaN);if(m.u(q))return new Date;if(q instanceof Date)return new Date(q);if(typeof q=="string"&&!/Z$/i.test(q)){var B=q.match(L);if(B){var U=B[2]-1||0,H=(B[7]||"0").substring(0,3);return j?new Date(Date.UTC(B[1],U,B[3]||1,B[4]||0,B[5]||0,B[6]||0,H)):new Date(B[1],U,B[3]||1,B[4]||0,B[5]||0,B[6]||0,H)}}return new Date(q)}(F),this.$x=F.x||{},this.init()},x.init=function(){var F=this.$d;this.$y=F.getFullYear(),this.$M=F.getMonth(),this.$D=F.getDate(),this.$W=F.getDay(),this.$H=F.getHours(),this.$m=F.getMinutes(),this.$s=F.getSeconds(),this.$ms=F.getMilliseconds()},x.$utils=function(){return m},x.isValid=function(){return this.$d.toString()!==C},x.isSame=function(F,M){var q=N(F);return this.startOf(M)<=q&&q<=this.endOf(M)},x.isAfter=function(F,M){return N(F)<this.startOf(M)},x.isBefore=function(F,M){return this.endOf(M)<N(F)},x.$g=function(F,M,q){return m.u(F)?this[M]:this.set(q,F)},x.unix=function(){return Math.floor(this.valueOf()/1e3)},x.valueOf=function(){return this.$d.getTime()},x.startOf=function(F,M){var q=this,j=!!m.u(M)||M,B=m.p(F),U=function(I,D){var k=m.w(q.$u?Date.UTC(q.$y,D,I):new Date(q.$y,D,I),q);return j?k:k.endOf(T)},H=function(I,D){return m.w(q.toDate()[I].apply(q.toDate("s"),(j?[0,0,0,0]:[23,59,59,999]).slice(D)),q)},W=this.$W,et=this.$M,yt=this.$D,wt="set"+(this.$u?"UTC":"");switch(B){case h:return j?U(1,0):U(31,11);case b:return j?U(1,et):U(0,et+1);case S:var u=this.$locale().weekStart||0,s=(W<u?W+7:W)-u;return U(j?yt-s:yt+(6-s),et);case T:case w:return H(wt+"Hours",0);case d:return H(wt+"Minutes",1);case f:return H(wt+"Seconds",2);case l:return H(wt+"Milliseconds",3);default:return this.clone()}},x.endOf=function(F){return this.startOf(F,!1)},x.$set=function(F,M){var q,j=m.p(F),B="set"+(this.$u?"UTC":""),U=(q={},q[T]=B+"Date",q[w]=B+"Date",q[b]=B+"Month",q[h]=B+"FullYear",q[d]=B+"Hours",q[f]=B+"Minutes",q[l]=B+"Seconds",q[c]=B+"Milliseconds",q)[j],H=j===T?this.$D+(M-this.$W):M;if(j===b||j===h){var W=this.clone().set(w,1);W.$d[U](H),W.init(),this.$d=W.set(w,Math.min(this.$D,W.daysInMonth())).$d}else U&&this.$d[U](H);return this.init(),this},x.set=function(F,M){return this.clone().$set(F,M)},x.get=function(F){return this[m.p(F)]()},x.add=function(F,M){var q,j=this;F=Number(F);var B=m.p(M),U=function(et){var yt=N(j);return m.w(yt.date(yt.date()+Math.round(et*F)),j)};if(B===b)return this.set(b,this.$M+F);if(B===h)return this.set(h,this.$y+F);if(B===T)return U(1);if(B===S)return U(7);var H=(q={},q[f]=i,q[d]=n,q[l]=e,q)[B]||1,W=this.$d.getTime()+F*H;return m.w(W,this)},x.subtract=function(F,M){return this.add(-1*F,M)},x.format=function(F){var M=this,q=this.$locale();if(!this.isValid())return q.invalidDate||C;var j=F||"YYYY-MM-DDTHH:mm:ssZ",B=m.z(this),U=this.$H,H=this.$m,W=this.$M,et=q.weekdays,yt=q.months,wt=function(D,k,Y,Z){return D&&(D[k]||D(M,j))||Y[k].slice(0,Z)},u=function(D){return m.s(U%12||12,D,"0")},s=q.meridiem||function(D,k,Y){var Z=D<12?"AM":"PM";return Y?Z.toLowerCase():Z},I={YY:String(this.$y).slice(-2),YYYY:this.$y,M:W+1,MM:m.s(W+1,2,"0"),MMM:wt(q.monthsShort,W,yt,3),MMMM:wt(yt,W),D:this.$D,DD:m.s(this.$D,2,"0"),d:String(this.$W),dd:wt(q.weekdaysMin,this.$W,et,2),ddd:wt(q.weekdaysShort,this.$W,et,3),dddd:et[this.$W],H:String(U),HH:m.s(U,2,"0"),h:u(1),hh:u(2),a:s(U,H,!0),A:s(U,H,!1),m:String(H),mm:m.s(H,2,"0"),s:String(this.$s),ss:m.s(this.$s,2,"0"),SSS:m.s(this.$ms,3,"0"),Z:B};return j.replace(P,function(D,k){return k||I[D]||B.replace(":","")})},x.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},x.diff=function(F,M,q){var j,B=m.p(M),U=N(F),H=(U.utcOffset()-this.utcOffset())*i,W=this-U,et=m.m(this,U);return et=(j={},j[h]=et/12,j[b]=et,j[v]=et/3,j[S]=(W-H)/6048e5,j[T]=(W-H)/864e5,j[d]=W/n,j[f]=W/i,j[l]=W/e,j)[B]||W,q?et:m.a(et)},x.daysInMonth=function(){return this.endOf(b).$D},x.$locale=function(){return y[this.$L]},x.locale=function(F,M){if(!F)return this.$L;var q=this.clone(),j=p(F,M,!0);return j&&(q.$L=j),q},x.clone=function(){return m.w(this.$d,this)},x.toDate=function(){return new Date(this.valueOf())},x.toJSON=function(){return this.isValid()?this.toISOString():null},x.toISOString=function(){return this.$d.toISOString()},x.toString=function(){return this.$d.toUTCString()},_}(),A=O.prototype;return N.prototype=A,[["$ms",c],["$s",l],["$m",f],["$H",d],["$W",T],["$M",b],["$y",h],["$D",w]].forEach(function(_){A[_[1]]=function(x){return this.$g(x,_[0],_[1])}}),N.extend=function(_,x){return _.$i||(_(x,O,N),_.$i=!0),N},N.locale=p,N.isDayjs=E,N.unix=function(_){return N(1e3*_)},N.en=y[o],N.Ls=y,N.p={},N})}}),$r={};Gn($r,{access:()=>po,accessFile:()=>Vr,assert:()=>fo,blank:()=>vo,client:()=>mo,clientFile:()=>zr,configure:()=>go,console:()=>Co,data:()=>Do,debug:()=>Oo,error:()=>So,fatal:()=>Po,header:()=>yo,headerJson:()=>wo,info:()=>To,logFile:()=>kr,options:()=>z,print:()=>Pt,ring:()=>ye,state:()=>bo,tags:()=>ct,timed:()=>ho,verbose:()=>No,warn:()=>Eo});Gr.exports=Hn($r);var Br=Ut(require("os")),Xt=Ut(require("fs")),Mt=Ut(require("path")),le=Ut(Wn()),Ze=10,Ir=(r=0)=>t=>`\x1B[${t+r}m`,_r=(r=0)=>t=>`\x1B[${38+r};5;${t}m`,Ar=(r=0)=>(t,e,i)=>`\x1B[${38+r};2;${t};${e};${i}m`;function Yn(){let r=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(let[e,i]of Object.entries(t)){for(let[n,c]of Object.entries(i))t[n]={open:`\x1B[${c[0]}m`,close:`\x1B[${c[1]}m`},i[n]=t[n],r.set(c[0],c[1]);Object.defineProperty(t,e,{value:i,enumerable:!1})}return Object.defineProperty(t,"codes",{value:r,enumerable:!1}),t.color.close="\x1B[39m",t.bgColor.close="\x1B[49m",t.color.ansi=Ir(),t.color.ansi256=_r(),t.color.ansi16m=Ar(),t.bgColor.ansi=Ir(Ze),t.bgColor.ansi256=_r(Ze),t.bgColor.ansi16m=Ar(Ze),Object.defineProperties(t,{rgbToAnsi256:{value:(e,i,n)=>e===i&&i===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(i/255*5)+Math.round(n/255*5),enumerable:!1},hexToRgb:{value:e=>{let i=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!i)return[0,0,0];let{colorString:n}=i.groups;n.length===3&&(n=[...n].map(l=>l+l).join(""));let c=Number.parseInt(n,16);return[c>>16&255,c>>8&255,c&255]},enumerable:!1},hexToAnsi256:{value:e=>t.rgbToAnsi256(...t.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value:e=>{if(e<8)return 30+e;if(e<16)return 90+(e-8);let i,n,c;if(e>=232)i=((e-232)*10+8)/255,n=i,c=i;else{e-=16;let d=e%36;i=Math.floor(e/36)/5,n=Math.floor(d/6)/5,c=d%6/5}let l=Math.max(i,n,c)*2;if(l===0)return 30;let f=30+(Math.round(c)<<2|Math.round(n)<<1|Math.round(i));return l===2&&(f+=60),f},enumerable:!1},rgbToAnsi:{value:(e,i,n)=>t.ansi256ToAnsi(t.rgbToAnsi256(e,i,n)),enumerable:!1},hexToAnsi:{value:e=>t.ansi256ToAnsi(t.hexToAnsi256(e)),enumerable:!1}}),t}var Zn=Yn(),St=Zn,tr=Ut(require("process"),1),Kn=Ut(require("os"),1),Mr=Ut(require("tty"),1);function pt(r,t=tr.default.argv){let e=r.startsWith("-")?"":r.length===1?"-":"--",i=t.indexOf(e+r),n=t.indexOf("--");return i!==-1&&(n===-1||i<n)}var{env:J}=tr.default,ve;pt("no-color")||pt("no-colors")||pt("color=false")||pt("color=never")?ve=0:(pt("color")||pt("colors")||pt("color=true")||pt("color=always"))&&(ve=1);function Qn(){if("FORCE_COLOR"in J)return J.FORCE_COLOR==="true"?1:J.FORCE_COLOR==="false"?0:J.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(J.FORCE_COLOR,10),3)}function Jn(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function to(r,{streamIsTTY:t,sniffFlags:e=!0}={}){let i=Qn();i!==void 0&&(ve=i);let n=e?ve:i;if(n===0)return 0;if(e){if(pt("color=16m")||pt("color=full")||pt("color=truecolor"))return 3;if(pt("color=256"))return 2}if(r&&!t&&n===void 0)return 0;let c=n||0;if(J.TERM==="dumb")return c;if(tr.default.platform==="win32"){let l=Kn.default.release().split(".");return Number(l[0])>=10&&Number(l[2])>=10586?Number(l[2])>=14931?3:2:1}if("CI"in J)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(l=>l in J)||J.CI_NAME==="codeship"?1:c;if("TEAMCITY_VERSION"in J)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(J.TEAMCITY_VERSION)?1:0;if("TF_BUILD"in J&&"AGENT_NAME"in J)return 1;if(J.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in J){let l=Number.parseInt((J.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(J.TERM_PROGRAM){case"iTerm.app":return l>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(J.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(J.TERM)||"COLORTERM"in J?1:c}function Lr(r,t={}){let e=to(r,{streamIsTTY:r&&r.isTTY,...t});return Jn(e)}var eo={stdout:Lr({isTTY:Mr.default.isatty(1)}),stderr:Lr({isTTY:Mr.default.isatty(2)})},ro=eo;function io(r,t,e){let i=r.indexOf(t);if(i===-1)return r;let n=t.length,c=0,l="";do l+=r.substr(c,i-c)+t+e,c=i+n,i=r.indexOf(t,c);while(i!==-1);return l+=r.slice(c),l}function no(r,t,e,i){let n=0,c="";do{let l=r[i-1]==="\r";c+=r.substr(n,(l?i-1:i)-n)+t+(l?`\r
`:`
`)+e,n=i+1,i=r.indexOf(`
`,n)}while(i!==-1);return c+=r.slice(n),c}var{stdout:xr,stderr:Fr}=ro,Ke=Symbol("GENERATOR"),Qt=Symbol("STYLER"),ue=Symbol("IS_EMPTY"),Rr=["ansi","ansi","ansi256","ansi16m"],Jt=Object.create(null),oo=(r,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let e=xr?xr.level:0;r.level=t.level===void 0?e:t.level},so=class{constructor(r){return Xr(r)}},Xr=r=>{let t=(...e)=>e.join(" ");return oo(t,r),Object.setPrototypeOf(t,he.prototype),t};function he(r){return Xr(r)}Object.setPrototypeOf(he.prototype,Function.prototype);for(let[r,t]of Object.entries(St))Jt[r]={get(){let e=Te(this,Je(t.open,t.close,this[Qt]),this[ue]);return Object.defineProperty(this,r,{value:e}),e}};Jt.visible={get(){let r=Te(this,this[Qt],!0);return Object.defineProperty(this,"visible",{value:r}),r}};var Qe=(r,t,e,...i)=>r==="rgb"?t==="ansi16m"?St[e].ansi16m(...i):t==="ansi256"?St[e].ansi256(St.rgbToAnsi256(...i)):St[e].ansi(St.rgbToAnsi(...i)):r==="hex"?Qe("rgb",t,e,...St.hexToRgb(...i)):St[e][r](...i),ao=["rgb","hex","ansi256"];for(let r of ao){Jt[r]={get(){let{level:e}=this;return function(...i){let n=Je(Qe(r,Rr[e],"color",...i),St.color.close,this[Qt]);return Te(this,n,this[ue])}}};let t="bg"+r[0].toUpperCase()+r.slice(1);Jt[t]={get(){let{level:e}=this;return function(...i){let n=Je(Qe(r,Rr[e],"bgColor",...i),St.bgColor.close,this[Qt]);return Te(this,n,this[ue])}}}}var uo=Object.defineProperties(()=>{},{...Jt,level:{enumerable:!0,get(){return this[Ke].level},set(r){this[Ke].level=r}}}),Je=(r,t,e)=>{let i,n;return e===void 0?(i=r,n=t):(i=e.openAll+r,n=t+e.closeAll),{open:r,close:t,openAll:i,closeAll:n,parent:e}},Te=(r,t,e)=>{let i=(...n)=>co(i,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(i,uo),i[Ke]=r,i[Qt]=t,i[ue]=e,i},co=(r,t)=>{if(r.level<=0||!t)return r[ue]?"":t;let e=r[Qt];if(e===void 0)return t;let{openAll:i,closeAll:n}=e;if(t.includes("\x1B"))for(;e!==void 0;)t=io(t,e.close,e.open),e=e.parent;let c=t.indexOf(`
`);return c!==-1&&(t=no(t,n,i,c)),i+t+n};Object.defineProperties(he.prototype,Jt);var Ts=he(),bs=he({level:Fr?Fr.level:0}),Ur=require("console"),vt=new so({level:2}),ye=[],z={dateFormat:"YYYY-MM-DD HH:mm:ss",ringLength:100,console:!0,timeStamp:!0},G={logFile:!1,accessFile:!1,clientFile:!1,logStream:void 0,accessStream:void 0,clientStream:void 0},ct={blank:"",continue:":     ",info:vt.cyan("INFO: "),warn:vt.yellow("WARN: "),data:vt.green("DATA: "),error:vt.red("ERROR:"),fatal:vt.bold.red("FATAL:"),assert:vt.italic.bold.red("ASSERT:"),timed:vt.magentaBright("TIMED:"),state:vt.magenta("STATE:"),verbose:vt.bgGray.yellowBright("VERB: "),debug:vt.bgGray.redBright("DEBUG:"),console:vt.gray("CONSOLE:")},we={showHidden:!1,depth:5,colors:!0,showProxy:!0,maxArrayLength:1024,maxStringLength:10240,breakLength:200,compact:64,sorted:!1,getters:!1},be=new Ur.Console({stdout:process.stdout,stderr:process.stderr,ignoreErrors:!0,inspectOptions:we});function lo(r){let t="";try{t=JSON.stringify(r)}catch{}return t}function ce(...r){let t="";for(let e of r)t+=typeof e=="object"?lo(e):e,t+=" ";return t}function Pt(...r){let t=(0,le.default)(Date.now()).format(z.dateFormat);z.console&&(z.timeStamp?be.log(t,...r):be.log(...r))}function kr(r){typeof r=="string"&&(z.logFile=r,G.logFile=!0,G.logStream=Xt.createWriteStream(Mt.resolve(z.logFile||""),{flags:"a"}),G.logStream&&G.logStream.on("error",t=>{Pt(ct.error,"Cannot open application log",z.logFile,t),G.logFile=!1}))}function Vr(r){typeof r=="string"&&(z.accessFile=r,G.accessFile=!0,G.accessStream=Xt.createWriteStream(Mt.resolve(z.accessFile),{flags:"a"}),G.accessStream&&G.accessStream.on("error",t=>{Pt(ct.error,"Cannot open application log",z.accessFile,t),G.accessFile=!1}))}function zr(r){typeof r=="string"&&(z.clientFile=r,G.clientFile=!0,G.clientStream=Xt.createWriteStream(Mt.resolve(z.clientFile),{flags:"a"}),G.clientStream&&G.clientStream.on("error",t=>{Pt(ct.error,"Cannot open application log",z.clientFile,t),G.clientFile=!1}))}async function ho(r,...t){arguments.length<2&&(t=[r],r=process.hrtime.bigint());let e=process.hrtime.bigint(),i=0;try{i=parseInt((e-r).toString())}catch{}i=Math.round(i/1e6);let n=(0,le.default)(Date.now()).format(z.dateFormat);z.console&&be.log(n,ct.timed,`${i.toLocaleString()} ms`,...t),G.logFile&&G.logStream&&G.logStream.write(`${ct.timed} ${n} ${i.toLocaleString()} ms ${ce(...t)}
`)}async function ot(r,...t){let e=(0,le.default)(Date.now()).format(z.dateFormat);ct[r]?Pt(ct[r],...t):Pt(...t),G.logFile&&G.logStream&&G.logStream.write(`${e} ${ct[r]} ${ce(...t)}
`),ye.push({tag:r,time:e,msg:ce(...t)}),ye.length>z.ringLength&&ye.shift()}async function fo(r,t,...e){r!==t&&ot("assert",...e,{res:r,exp:t})}async function po(...r){let t=(0,le.default)(Date.now()).format(z.dateFormat);G.accessFile&&G.accessStream&&G.accessStream.write(`${t} ${ce(...r)}
`)}async function mo(...r){let t=(0,le.default)(Date.now()).format(z.dateFormat);G.clientFile&&G.clientStream&&G.clientStream.write(`${t} ${ce(...r)}
`)}function go(r){!r||(r.dateFormat&&(z.dateFormat=r.dateFormat),r.ringLength&&(z.ringLength=r.ringLength),r.logFile&&kr(r.logFile),r.accessFile&&Vr(r.accessFile),r.clientFile&&zr(r.clientFile),r.inspect&&(we={...we,...r.inspect}),be=new Ur.Console({stdout:process.stdout,stderr:process.stderr,ignoreErrors:!0,inspectOptions:we}))}function yo(){let r="./package.json";if(!Xt.existsSync(r))return;let t=JSON.parse(Xt.readFileSync(r).toString());process.title=t.name,ot("info",t.name,"version",t.version),ot("info","User:",Br.userInfo().username,"Platform:",process.platform,"Arch:",process.arch,"Node:",process.version),z.logFile&&G.logFile&&Pt(ct.state,"Application log:",Mt.resolve(z.logFile)),z.accessFile&&G.accessFile&&Pt(ct.state,"Access log:",Mt.resolve(z.accessFile)),z.clientFile&&G.clientFile&&Pt(ct.state,"Client log:",Mt.resolve(z.clientFile))}function wo(){let r="./package.json";if(!Xt.existsSync(r))return;let t=JSON.parse(Xt.readFileSync(r).toString());process.title=t.name,ot("info",{application:t.name,version:t.version}),ot("info",{user:Br.userInfo().username,platform:process.platform,arch:process.arch,node:process.version}),(z.logFile||z.accessFile||z.clientFile)&&Pt(ct.state,{log:Mt.resolve(z.logFile||""),access:Mt.resolve(z.accessFile||""),client:Mt.resolve(z.clientFile||"")})}var vo=(...r)=>ot("blank",...r),To=(...r)=>ot("info",...r),bo=(...r)=>ot("state",...r),Do=(...r)=>ot("data",...r),Eo=(...r)=>ot("warn",...r),So=(...r)=>ot("error",...r),Po=(...r)=>ot("fatal",...r),No=(...r)=>ot("verbose",...r),Oo=(...r)=>ot("debug",...r),Co=(...r)=>ot("console",...r)});var Se=X(rr=>{(function(){rr.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(rr)});var Nt=X((Kr,Rt)=>{(function(){var r,t,e,i,n,c,l,f=[].slice,d={}.hasOwnProperty;r=function(){var T,S,b,v,h,w;if(w=arguments[0],h=2<=arguments.length?f.call(arguments,1):[],n(Object.assign))Object.assign.apply(null,arguments);else for(T=0,b=h.length;T<b;T++)if(v=h[T],v!=null)for(S in v)!d.call(v,S)||(w[S]=v[S]);return w},n=function(T){return!!T&&Object.prototype.toString.call(T)==="[object Function]"},c=function(T){var S;return!!T&&((S=typeof T)=="function"||S==="object")},e=function(T){return n(Array.isArray)?Array.isArray(T):Object.prototype.toString.call(T)==="[object Array]"},i=function(T){var S;if(e(T))return!T.length;for(S in T)if(!!d.call(T,S))return!1;return!0},l=function(T){var S,b;return c(T)&&(b=Object.getPrototypeOf(T))&&(S=b.constructor)&&typeof S=="function"&&S instanceof S&&Function.prototype.toString.call(S)===Function.prototype.toString.call(Object)},t=function(T){return n(T.valueOf)?T.valueOf():T},Rt.exports.assign=r,Rt.exports.isFunction=n,Rt.exports.isObject=c,Rt.exports.isArray=e,Rt.exports.isEmpty=i,Rt.exports.isPlainObject=l,Rt.exports.getValue=t}).call(Kr)});var ir=X((Qr,Jr)=>{(function(){var r;Jr.exports=r=function(){function t(){}return t.prototype.hasFeature=function(e,i){return!0},t.prototype.createDocumentType=function(e,i,n){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(e,i,n){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(e,i){throw new Error("This DOM method is not implemented.")},t}()}).call(Qr)});var ri=X((ti,ei)=>{(function(){var r;ei.exports=r=function(){function t(){}return t.prototype.handleError=function(e){throw new Error(e)},t}()}).call(ti)});var oi=X((ii,ni)=>{(function(){var r;ni.exports=r=function(){function t(e){this.arr=e||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(e){return this.arr[e]||null},t.prototype.contains=function(e){return this.arr.indexOf(e)!==-1},t}()}).call(ii)});var ui=X((si,ai)=>{(function(){var r,t,e;t=ri(),e=oi(),ai.exports=r=function(){function i(){var n;this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=n=Object.create(this.defaultParams)}return Object.defineProperty(i.prototype,"parameterNames",{get:function(){return new e(Object.keys(this.defaultParams))}}),i.prototype.getParameter=function(n){return this.params.hasOwnProperty(n)?this.params[n]:null},i.prototype.canSetParameter=function(n,c){return!0},i.prototype.setParameter=function(n,c){return c!=null?this.params[n]=c:delete this.params[n]},i}()}).call(si)});var Q=X((ci,li)=>{(function(){li.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(ci)});var nr=X((hi,fi)=>{(function(){var r,t,e;r=Q(),e=ht(),fi.exports=t=function(){function i(n,c,l){if(this.parent=n,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),c==null)throw new Error("Missing attribute name. "+this.debugInfo(c));this.name=this.stringify.name(c),this.value=this.stringify.attValue(l),this.type=r.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(i.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(i.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(i.prototype,"textContent",{get:function(){return this.value},set:function(n){return this.value=n||""}}),Object.defineProperty(i.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(i.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(i.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"specified",{get:function(){return!0}}),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(n){return this.options.writer.attribute(this,this.options.writer.filterOptions(n))},i.prototype.debugInfo=function(n){return n=n||this.name,n==null?"parent: <"+this.parent.name+">":"attribute: {"+n+"}, parent: <"+this.parent.name+">"},i.prototype.isEqualNode=function(n){return!(n.namespaceURI!==this.namespaceURI||n.prefix!==this.prefix||n.localName!==this.localName||n.value!==this.value)},i}()}).call(hi)});var Pe=X((pi,di)=>{(function(){var r;di.exports=r=function(){function t(e){this.nodes=e}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(e){return this.nodes[e]},t.prototype.setNamedItem=function(e){var i;return i=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,i||null},t.prototype.removeNamedItem=function(e){var i;return i=this.nodes[e],delete this.nodes[e],i||null},t.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},t.prototype.getNamedItemNS=function(e,i){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(e,i){throw new Error("This DOM method is not implemented.")},t}()}).call(pi)});var Ne=X((mi,gi)=>{(function(){var r,t,e,i,n,c,l,f,d,T=function(b,v){for(var h in v)S.call(v,h)&&(b[h]=v[h]);function w(){this.constructor=b}return w.prototype=v.prototype,b.prototype=new w,b.__super__=v.prototype,b},S={}.hasOwnProperty;d=Nt(),f=d.isObject,l=d.isFunction,c=d.getValue,n=ht(),r=Q(),t=nr(),i=Pe(),gi.exports=e=function(b){T(v,b);function v(h,w,C){var L,P,R,g;if(v.__super__.constructor.call(this,h),w==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(w),this.type=r.Element,this.attribs={},this.schemaTypeInfo=null,C!=null&&this.attribute(C),h.type===r.Document&&(this.isRoot=!0,this.documentObject=h,h.rootObject=this,h.children)){for(g=h.children,P=0,R=g.length;P<R;P++)if(L=g[P],L.type===r.DocType){L.name=this.name;break}}}return Object.defineProperty(v.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(v.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(v.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(v.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(v.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(v.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(v.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(v.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new i(this.attribs)),this.attributeMap}}),v.prototype.clone=function(){var h,w,C,L;C=Object.create(this),C.isRoot&&(C.documentObject=null),C.attribs={},L=this.attribs;for(w in L)!S.call(L,w)||(h=L[w],C.attribs[w]=h.clone());return C.children=[],this.children.forEach(function(P){var R;return R=P.clone(),R.parent=C,C.children.push(R)}),C},v.prototype.attribute=function(h,w){var C,L;if(h!=null&&(h=c(h)),f(h))for(C in h)!S.call(h,C)||(L=h[C],this.attribute(C,L));else l(w)&&(w=w.apply()),this.options.keepNullAttributes&&w==null?this.attribs[h]=new t(this,h,""):w!=null&&(this.attribs[h]=new t(this,h,w));return this},v.prototype.removeAttribute=function(h){var w,C,L;if(h==null)throw new Error("Missing attribute name. "+this.debugInfo());if(h=c(h),Array.isArray(h))for(C=0,L=h.length;C<L;C++)w=h[C],delete this.attribs[w];else delete this.attribs[h];return this},v.prototype.toString=function(h){return this.options.writer.element(this,this.options.writer.filterOptions(h))},v.prototype.att=function(h,w){return this.attribute(h,w)},v.prototype.a=function(h,w){return this.attribute(h,w)},v.prototype.getAttribute=function(h){return this.attribs.hasOwnProperty(h)?this.attribs[h].value:null},v.prototype.setAttribute=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getAttributeNode=function(h){return this.attribs.hasOwnProperty(h)?this.attribs[h]:null},v.prototype.setAttributeNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.removeAttributeNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getAttributeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setAttributeNS=function(h,w,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.removeAttributeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getAttributeNodeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setAttributeNodeNS=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagNameNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.hasAttribute=function(h){return this.attribs.hasOwnProperty(h)},v.prototype.hasAttributeNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setIdAttribute=function(h,w){return this.attribs.hasOwnProperty(h)?this.attribs[h].isId:w},v.prototype.setIdAttributeNS=function(h,w,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setIdAttributeNode=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByTagNameNS=function(h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getElementsByClassName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isEqualNode=function(h){var w,C,L;if(!v.__super__.isEqualNode.apply(this,arguments).isEqualNode(h)||h.namespaceURI!==this.namespaceURI||h.prefix!==this.prefix||h.localName!==this.localName||h.attribs.length!==this.attribs.length)return!1;for(w=C=0,L=this.attribs.length-1;0<=L?C<=L:C>=L;w=0<=L?++C:--C)if(!this.attribs[w].isEqualNode(h.attribs[w]))return!1;return!0},v}(n)}).call(mi)});var fe=X((yi,wi)=>{(function(){var r,t,e=function(n,c){for(var l in c)i.call(c,l)&&(n[l]=c[l]);function f(){this.constructor=n}return f.prototype=c.prototype,n.prototype=new f,n.__super__=c.prototype,n},i={}.hasOwnProperty;t=ht(),wi.exports=r=function(n){e(c,n);function c(l){c.__super__.constructor.call(this,l),this.value=""}return Object.defineProperty(c.prototype,"data",{get:function(){return this.value},set:function(l){return this.value=l||""}}),Object.defineProperty(c.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(c.prototype,"textContent",{get:function(){return this.value},set:function(l){return this.value=l||""}}),c.prototype.clone=function(){return Object.create(this)},c.prototype.substringData=function(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.appendData=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.insertData=function(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.deleteData=function(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.replaceData=function(l,f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.isEqualNode=function(l){return!(!c.__super__.isEqualNode.apply(this,arguments).isEqualNode(l)||l.data!==this.data)},c}(t)}).call(yi)});var Oe=X((vi,Ti)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;r=Q(),e=fe(),Ti.exports=t=function(c){i(l,c);function l(f,d){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=r.CData,this.value=this.stringify.cdata(d)}return l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(f){return this.options.writer.cdata(this,this.options.writer.filterOptions(f))},l}(e)}).call(vi)});var Ce=X((bi,Di)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;r=Q(),t=fe(),Di.exports=e=function(c){i(l,c);function l(f,d){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=r.Comment,this.value=this.stringify.comment(d)}return l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(f){return this.options.writer.comment(this,this.options.writer.filterOptions(f))},l}(t)}).call(bi)});var Ie=X((Ei,Si)=>{(function(){var r,t,e,i,n=function(l,f){for(var d in f)c.call(f,d)&&(l[d]=f[d]);function T(){this.constructor=l}return T.prototype=f.prototype,l.prototype=new T,l.__super__=f.prototype,l},c={}.hasOwnProperty;i=Nt().isObject,e=ht(),r=Q(),Si.exports=t=function(l){n(f,l);function f(d,T,S,b){var v;f.__super__.constructor.call(this,d),i(T)&&(v=T,T=v.version,S=v.encoding,b=v.standalone),T||(T="1.0"),this.type=r.Declaration,this.version=this.stringify.xmlVersion(T),S!=null&&(this.encoding=this.stringify.xmlEncoding(S)),b!=null&&(this.standalone=this.stringify.xmlStandalone(b))}return f.prototype.toString=function(d){return this.options.writer.declaration(this,this.options.writer.filterOptions(d))},f}(e)}).call(Ei)});var _e=X((Pi,Ni)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;e=ht(),r=Q(),Ni.exports=t=function(c){i(l,c);function l(f,d,T,S,b,v){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(T==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(d));if(!S)throw new Error("Missing DTD attribute type. "+this.debugInfo(d));if(!b)throw new Error("Missing DTD attribute default. "+this.debugInfo(d));if(b.indexOf("#")!==0&&(b="#"+b),!b.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(d));if(v&&!b.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(d));this.elementName=this.stringify.name(d),this.type=r.AttributeDeclaration,this.attributeName=this.stringify.name(T),this.attributeType=this.stringify.dtdAttType(S),v&&(this.defaultValue=this.stringify.dtdAttDefault(v)),this.defaultValueType=b}return l.prototype.toString=function(f){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(f))},l}(e)}).call(Pi)});var Ae=X((Oi,Ci)=>{(function(){var r,t,e,i,n=function(l,f){for(var d in f)c.call(f,d)&&(l[d]=f[d]);function T(){this.constructor=l}return T.prototype=f.prototype,l.prototype=new T,l.__super__=f.prototype,l},c={}.hasOwnProperty;i=Nt().isObject,e=ht(),r=Q(),Ci.exports=t=function(l){n(f,l);function f(d,T,S,b){if(f.__super__.constructor.call(this,d),S==null)throw new Error("Missing DTD entity name. "+this.debugInfo(S));if(b==null)throw new Error("Missing DTD entity value. "+this.debugInfo(S));if(this.pe=!!T,this.name=this.stringify.name(S),this.type=r.EntityDeclaration,!i(b))this.value=this.stringify.dtdEntityValue(b),this.internal=!0;else{if(!b.pubID&&!b.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(S));if(b.pubID&&!b.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(S));if(this.internal=!1,b.pubID!=null&&(this.pubID=this.stringify.dtdPubID(b.pubID)),b.sysID!=null&&(this.sysID=this.stringify.dtdSysID(b.sysID)),b.nData!=null&&(this.nData=this.stringify.dtdNData(b.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(S))}}return Object.defineProperty(f.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(f.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(f.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(f.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(f.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(f.prototype,"xmlVersion",{get:function(){return null}}),f.prototype.toString=function(d){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(d))},f}(e)}).call(Oi)});var Me=X((Ii,_i)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;e=ht(),r=Q(),_i.exports=t=function(c){i(l,c);function l(f,d,T){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing DTD element name. "+this.debugInfo());T||(T="(#PCDATA)"),Array.isArray(T)&&(T="("+T.join(",")+")"),this.name=this.stringify.name(d),this.type=r.ElementDeclaration,this.value=this.stringify.dtdElementValue(T)}return l.prototype.toString=function(f){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(f))},l}(e)}).call(Ii)});var Le=X((Ai,Mi)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;e=ht(),r=Q(),Mi.exports=t=function(c){i(l,c);function l(f,d,T){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing DTD notation name. "+this.debugInfo(d));if(!T.pubID&&!T.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(d));this.name=this.stringify.name(d),this.type=r.NotationDeclaration,T.pubID!=null&&(this.pubID=this.stringify.dtdPubID(T.pubID)),T.sysID!=null&&(this.sysID=this.stringify.dtdSysID(T.sysID))}return Object.defineProperty(l.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(l.prototype,"systemId",{get:function(){return this.sysID}}),l.prototype.toString=function(f){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(f))},l}(e)}).call(Ai)});var xe=X((Li,xi)=>{(function(){var r,t,e,i,n,c,l,f,d,T=function(b,v){for(var h in v)S.call(v,h)&&(b[h]=v[h]);function w(){this.constructor=b}return w.prototype=v.prototype,b.prototype=new w,b.__super__=v.prototype,b},S={}.hasOwnProperty;d=Nt().isObject,f=ht(),r=Q(),t=_e(),i=Ae(),e=Me(),n=Le(),l=Pe(),xi.exports=c=function(b){T(v,b);function v(h,w,C){var L,P,R,g,a,o;if(v.__super__.constructor.call(this,h),this.type=r.DocType,h.children){for(g=h.children,P=0,R=g.length;P<R;P++)if(L=g[P],L.type===r.Element){this.name=L.name;break}}this.documentObject=h,d(w)&&(a=w,w=a.pubID,C=a.sysID),C==null&&(o=[w,C],C=o[0],w=o[1]),w!=null&&(this.pubID=this.stringify.dtdPubID(w)),C!=null&&(this.sysID=this.stringify.dtdSysID(C))}return Object.defineProperty(v.prototype,"entities",{get:function(){var h,w,C,L,P;for(L={},P=this.children,w=0,C=P.length;w<C;w++)h=P[w],h.type===r.EntityDeclaration&&!h.pe&&(L[h.name]=h);return new l(L)}}),Object.defineProperty(v.prototype,"notations",{get:function(){var h,w,C,L,P;for(L={},P=this.children,w=0,C=P.length;w<C;w++)h=P[w],h.type===r.NotationDeclaration&&(L[h.name]=h);return new l(L)}}),Object.defineProperty(v.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(v.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(v.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),v.prototype.element=function(h,w){var C;return C=new e(this,h,w),this.children.push(C),this},v.prototype.attList=function(h,w,C,L,P){var R;return R=new t(this,h,w,C,L,P),this.children.push(R),this},v.prototype.entity=function(h,w){var C;return C=new i(this,!1,h,w),this.children.push(C),this},v.prototype.pEntity=function(h,w){var C;return C=new i(this,!0,h,w),this.children.push(C),this},v.prototype.notation=function(h,w){var C;return C=new n(this,h,w),this.children.push(C),this},v.prototype.toString=function(h){return this.options.writer.docType(this,this.options.writer.filterOptions(h))},v.prototype.ele=function(h,w){return this.element(h,w)},v.prototype.att=function(h,w,C,L,P){return this.attList(h,w,C,L,P)},v.prototype.ent=function(h,w){return this.entity(h,w)},v.prototype.pent=function(h,w){return this.pEntity(h,w)},v.prototype.not=function(h,w){return this.notation(h,w)},v.prototype.up=function(){return this.root()||this.documentObject},v.prototype.isEqualNode=function(h){return!(!v.__super__.isEqualNode.apply(this,arguments).isEqualNode(h)||h.name!==this.name||h.publicId!==this.publicId||h.systemId!==this.systemId)},v}(f)}).call(Li)});var Fe=X((Fi,Ri)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;r=Q(),t=ht(),Ri.exports=e=function(c){i(l,c);function l(f,d){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=r.Raw,this.value=this.stringify.raw(d)}return l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(f){return this.options.writer.raw(this,this.options.writer.filterOptions(f))},l}(t)}).call(Fi)});var Re=X((qi,ji)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;r=Q(),t=fe(),ji.exports=e=function(c){i(l,c);function l(f,d){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=r.Text,this.value=this.stringify.text(d)}return Object.defineProperty(l.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(l.prototype,"wholeText",{get:function(){var f,d,T;for(T="",d=this.previousSibling;d;)T=d.data+T,d=d.previousSibling;for(T+=this.data,f=this.nextSibling;f;)T=T+f.data,f=f.nextSibling;return T}}),l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(f){return this.options.writer.text(this,this.options.writer.filterOptions(f))},l.prototype.splitText=function(f){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.replaceWholeText=function(f){throw new Error("This DOM method is not implemented."+this.debugInfo())},l}(t)}).call(qi)});var qe=X(($i,Bi)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;r=Q(),t=fe(),Bi.exports=e=function(c){i(l,c);function l(f,d,T){if(l.__super__.constructor.call(this,f),d==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=r.ProcessingInstruction,this.target=this.stringify.insTarget(d),this.name=this.target,T&&(this.value=this.stringify.insValue(T))}return l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(f){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(f))},l.prototype.isEqualNode=function(f){return!(!l.__super__.isEqualNode.apply(this,arguments).isEqualNode(f)||f.target!==this.target)},l}(t)}).call($i)});var or=X((Xi,Ui)=>{(function(){var r,t,e,i=function(c,l){for(var f in l)n.call(l,f)&&(c[f]=l[f]);function d(){this.constructor=c}return d.prototype=l.prototype,c.prototype=new d,c.__super__=l.prototype,c},n={}.hasOwnProperty;e=ht(),r=Q(),Ui.exports=t=function(c){i(l,c);function l(f){l.__super__.constructor.call(this,f),this.type=r.Dummy}return l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(f){return""},l}(e)}).call(Xi)});var zi=X((ki,Vi)=>{(function(){var r;Vi.exports=r=function(){function t(e){this.nodes=e}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(e){return this.nodes[e]||null},t}()}).call(ki)});var Wi=X((Gi,Hi)=>{(function(){Hi.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(Gi)});var ht=X((Yi,Zi)=>{(function(){var r,t,e,i,n,c,l,f,d,T,S,b,v,h,w,C,L,P,R,g={}.hasOwnProperty;R=Nt(),P=R.isObject,L=R.isFunction,C=R.isEmpty,w=R.getValue,f=null,e=null,i=null,n=null,c=null,v=null,h=null,b=null,l=null,t=null,S=null,d=null,r=null,Zi.exports=T=function(){function a(o){this.parent=o,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,f||(f=Ne(),e=Oe(),i=Ce(),n=Ie(),c=xe(),v=Fe(),h=Re(),b=qe(),l=or(),t=Q(),S=zi(),d=Pe(),r=Wi())}return Object.defineProperty(a.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(a.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(a.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(a.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(a.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new S(this.children)),this.childNodeList}}),Object.defineProperty(a.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(a.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(a.prototype,"previousSibling",{get:function(){var o;return o=this.parent.children.indexOf(this),this.parent.children[o-1]||null}}),Object.defineProperty(a.prototype,"nextSibling",{get:function(){var o;return o=this.parent.children.indexOf(this),this.parent.children[o+1]||null}}),Object.defineProperty(a.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(a.prototype,"textContent",{get:function(){var o,y,E,p,N;if(this.nodeType===t.Element||this.nodeType===t.DocumentFragment){for(N="",p=this.children,y=0,E=p.length;y<E;y++)o=p[y],o.textContent&&(N+=o.textContent);return N}else return null},set:function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),a.prototype.setParent=function(o){var y,E,p,N,m;for(this.parent=o,o&&(this.options=o.options,this.stringify=o.stringify),N=this.children,m=[],E=0,p=N.length;E<p;E++)y=N[E],m.push(y.setParent(this));return m},a.prototype.element=function(o,y,E){var p,N,m,O,A,_,x,F,M,q,j;if(_=null,y===null&&E==null&&(M=[{},null],y=M[0],E=M[1]),y==null&&(y={}),y=w(y),P(y)||(q=[y,E],E=q[0],y=q[1]),o!=null&&(o=w(o)),Array.isArray(o))for(m=0,x=o.length;m<x;m++)N=o[m],_=this.element(N);else if(L(o))_=this.element(o.apply());else if(P(o)){for(A in o)if(!!g.call(o,A))if(j=o[A],L(j)&&(j=j.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&A.indexOf(this.stringify.convertAttKey)===0)_=this.attribute(A.substr(this.stringify.convertAttKey.length),j);else if(!this.options.separateArrayItems&&Array.isArray(j)&&C(j))_=this.dummy();else if(P(j)&&C(j))_=this.element(A);else if(!this.options.keepNullNodes&&j==null)_=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(j))for(O=0,F=j.length;O<F;O++)N=j[O],p={},p[A]=N,_=this.element(p);else P(j)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&A.indexOf(this.stringify.convertTextKey)===0?_=this.element(j):(_=this.element(A),_.element(j)):_=this.element(A,j)}else!this.options.keepNullNodes&&E===null?_=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&o.indexOf(this.stringify.convertTextKey)===0?_=this.text(E):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&o.indexOf(this.stringify.convertCDataKey)===0?_=this.cdata(E):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&o.indexOf(this.stringify.convertCommentKey)===0?_=this.comment(E):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&o.indexOf(this.stringify.convertRawKey)===0?_=this.raw(E):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&o.indexOf(this.stringify.convertPIKey)===0?_=this.instruction(o.substr(this.stringify.convertPIKey.length),E):_=this.node(o,y,E);if(_==null)throw new Error("Could not create any elements with: "+o+". "+this.debugInfo());return _},a.prototype.insertBefore=function(o,y,E){var p,N,m,O,A;if(o?.type)return m=o,O=y,m.setParent(this),O?(N=children.indexOf(O),A=children.splice(N),children.push(m),Array.prototype.push.apply(children,A)):children.push(m),m;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(o));return N=this.parent.children.indexOf(this),A=this.parent.children.splice(N),p=this.parent.element(o,y,E),Array.prototype.push.apply(this.parent.children,A),p},a.prototype.insertAfter=function(o,y,E){var p,N,m;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(o));return N=this.parent.children.indexOf(this),m=this.parent.children.splice(N+1),p=this.parent.element(o,y,E),Array.prototype.push.apply(this.parent.children,m),p},a.prototype.remove=function(){var o,y;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return o=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[o,o-o+1].concat(y=[])),this.parent},a.prototype.node=function(o,y,E){var p,N;return o!=null&&(o=w(o)),y||(y={}),y=w(y),P(y)||(N=[y,E],E=N[0],y=N[1]),p=new f(this,o,y),E!=null&&p.text(E),this.children.push(p),p},a.prototype.text=function(o){var y;return P(o)&&this.element(o),y=new h(this,o),this.children.push(y),this},a.prototype.cdata=function(o){var y;return y=new e(this,o),this.children.push(y),this},a.prototype.comment=function(o){var y;return y=new i(this,o),this.children.push(y),this},a.prototype.commentBefore=function(o){var y,E,p;return E=this.parent.children.indexOf(this),p=this.parent.children.splice(E),y=this.parent.comment(o),Array.prototype.push.apply(this.parent.children,p),this},a.prototype.commentAfter=function(o){var y,E,p;return E=this.parent.children.indexOf(this),p=this.parent.children.splice(E+1),y=this.parent.comment(o),Array.prototype.push.apply(this.parent.children,p),this},a.prototype.raw=function(o){var y;return y=new v(this,o),this.children.push(y),this},a.prototype.dummy=function(){var o;return o=new l(this),o},a.prototype.instruction=function(o,y){var E,p,N,m,O;if(o!=null&&(o=w(o)),y!=null&&(y=w(y)),Array.isArray(o))for(m=0,O=o.length;m<O;m++)E=o[m],this.instruction(E);else if(P(o))for(E in o)!g.call(o,E)||(p=o[E],this.instruction(E,p));else L(y)&&(y=y.apply()),N=new b(this,o,y),this.children.push(N);return this},a.prototype.instructionBefore=function(o,y){var E,p,N;return p=this.parent.children.indexOf(this),N=this.parent.children.splice(p),E=this.parent.instruction(o,y),Array.prototype.push.apply(this.parent.children,N),this},a.prototype.instructionAfter=function(o,y){var E,p,N;return p=this.parent.children.indexOf(this),N=this.parent.children.splice(p+1),E=this.parent.instruction(o,y),Array.prototype.push.apply(this.parent.children,N),this},a.prototype.declaration=function(o,y,E){var p,N;return p=this.document(),N=new n(p,o,y,E),p.children.length===0?p.children.unshift(N):p.children[0].type===t.Declaration?p.children[0]=N:p.children.unshift(N),p.root()||p},a.prototype.dtd=function(o,y){var E,p,N,m,O,A,_,x,F,M;for(p=this.document(),N=new c(p,o,y),F=p.children,m=O=0,_=F.length;O<_;m=++O)if(E=F[m],E.type===t.DocType)return p.children[m]=N,N;for(M=p.children,m=A=0,x=M.length;A<x;m=++A)if(E=M[m],E.isRoot)return p.children.splice(m,0,N),N;return p.children.push(N),N},a.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},a.prototype.root=function(){var o;for(o=this;o;){if(o.type===t.Document)return o.rootObject;if(o.isRoot)return o;o=o.parent}},a.prototype.document=function(){var o;for(o=this;o;){if(o.type===t.Document)return o;o=o.parent}},a.prototype.end=function(o){return this.document().end(o)},a.prototype.prev=function(){var o;if(o=this.parent.children.indexOf(this),o<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[o-1]},a.prototype.next=function(){var o;if(o=this.parent.children.indexOf(this),o===-1||o===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[o+1]},a.prototype.importDocument=function(o){var y;return y=o.root().clone(),y.parent=this,y.isRoot=!1,this.children.push(y),this},a.prototype.debugInfo=function(o){var y,E;return o=o||this.name,o==null&&!((y=this.parent)!=null&&y.name)?"":o==null?"parent: <"+this.parent.name+">":(E=this.parent)!=null&&E.name?"node: <"+o+">, parent: <"+this.parent.name+">":"node: <"+o+">"},a.prototype.ele=function(o,y,E){return this.element(o,y,E)},a.prototype.nod=function(o,y,E){return this.node(o,y,E)},a.prototype.txt=function(o){return this.text(o)},a.prototype.dat=function(o){return this.cdata(o)},a.prototype.com=function(o){return this.comment(o)},a.prototype.ins=function(o,y){return this.instruction(o,y)},a.prototype.doc=function(){return this.document()},a.prototype.dec=function(o,y,E){return this.declaration(o,y,E)},a.prototype.e=function(o,y,E){return this.element(o,y,E)},a.prototype.n=function(o,y,E){return this.node(o,y,E)},a.prototype.t=function(o){return this.text(o)},a.prototype.d=function(o){return this.cdata(o)},a.prototype.c=function(o){return this.comment(o)},a.prototype.r=function(o){return this.raw(o)},a.prototype.i=function(o,y){return this.instruction(o,y)},a.prototype.u=function(){return this.up()},a.prototype.importXMLBuilder=function(o){return this.importDocument(o)},a.prototype.replaceChild=function(o,y){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.removeChild=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.appendChild=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.hasChildNodes=function(){return this.children.length!==0},a.prototype.cloneNode=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.isSupported=function(o,y){return!0},a.prototype.hasAttributes=function(){return this.attribs.length!==0},a.prototype.compareDocumentPosition=function(o){var y,E;return y=this,y===o?0:this.document()!==o.document()?(E=r.Disconnected|r.ImplementationSpecific,Math.random()<.5?E|=r.Preceding:E|=r.Following,E):y.isAncestor(o)?r.Contains|r.Preceding:y.isDescendant(o)?r.Contains|r.Following:y.isPreceding(o)?r.Preceding:r.Following},a.prototype.isSameNode=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.lookupPrefix=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.isDefaultNamespace=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.lookupNamespaceURI=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.isEqualNode=function(o){var y,E,p;if(o.nodeType!==this.nodeType||o.children.length!==this.children.length)return!1;for(y=E=0,p=this.children.length-1;0<=p?E<=p:E>=p;y=0<=p?++E:--E)if(!this.children[y].isEqualNode(o.children[y]))return!1;return!0},a.prototype.getFeature=function(o,y){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.setUserData=function(o,y,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getUserData=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.contains=function(o){return o?o===this||this.isDescendant(o):!1},a.prototype.isDescendant=function(o){var y,E,p,N,m;for(m=this.children,p=0,N=m.length;p<N;p++)if(y=m[p],o===y||(E=y.isDescendant(o),E))return!0;return!1},a.prototype.isAncestor=function(o){return o.isDescendant(this)},a.prototype.isPreceding=function(o){var y,E;return y=this.treePosition(o),E=this.treePosition(this),y===-1||E===-1?!1:y<E},a.prototype.isFollowing=function(o){var y,E;return y=this.treePosition(o),E=this.treePosition(this),y===-1||E===-1?!1:y>E},a.prototype.treePosition=function(o){var y,E;return E=0,y=!1,this.foreachTreeNode(this.document(),function(p){if(E++,!y&&p===o)return y=!0}),y?E:-1},a.prototype.foreachTreeNode=function(o,y){var E,p,N,m,O;for(o||(o=this.document()),m=o.children,p=0,N=m.length;p<N;p++){if(E=m[p],O=y(E))return O;if(O=this.foreachTreeNode(E,y),O)return O}},a}()}).call(Yi)});var sr=X((Ki,Qi)=>{(function(){var r,t=function(i,n){return function(){return i.apply(n,arguments)}},e={}.hasOwnProperty;Qi.exports=r=function(){function i(n){this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this);var c,l,f;n||(n={}),this.options=n,this.options.version||(this.options.version="1.0"),l=n.stringify||{};for(c in l)!e.call(l,c)||(f=l[c],this[c]=f)}return i.prototype.name=function(n){return this.options.noValidation?n:this.assertLegalName(""+n||"")},i.prototype.text=function(n){return this.options.noValidation?n:this.assertLegalChar(this.textEscape(""+n||""))},i.prototype.cdata=function(n){return this.options.noValidation?n:(n=""+n||"",n=n.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(n))},i.prototype.comment=function(n){if(this.options.noValidation)return n;if(n=""+n||"",n.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+n);return this.assertLegalChar(n)},i.prototype.raw=function(n){return this.options.noValidation?n:""+n||""},i.prototype.attValue=function(n){return this.options.noValidation?n:this.assertLegalChar(this.attEscape(n=""+n||""))},i.prototype.insTarget=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.insValue=function(n){if(this.options.noValidation)return n;if(n=""+n||"",n.match(/\?>/))throw new Error("Invalid processing instruction value: "+n);return this.assertLegalChar(n)},i.prototype.xmlVersion=function(n){if(this.options.noValidation)return n;if(n=""+n||"",!n.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+n);return n},i.prototype.xmlEncoding=function(n){if(this.options.noValidation)return n;if(n=""+n||"",!n.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+n);return this.assertLegalChar(n)},i.prototype.xmlStandalone=function(n){return this.options.noValidation?n:n?"yes":"no"},i.prototype.dtdPubID=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.dtdSysID=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.dtdElementValue=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.dtdAttType=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.dtdAttDefault=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.dtdEntityValue=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.dtdNData=function(n){return this.options.noValidation?n:this.assertLegalChar(""+n||"")},i.prototype.convertAttKey="@",i.prototype.convertPIKey="?",i.prototype.convertTextKey="#text",i.prototype.convertCDataKey="#cdata",i.prototype.convertCommentKey="#comment",i.prototype.convertRawKey="#raw",i.prototype.assertLegalChar=function(n){var c,l;if(this.options.noValidation)return n;if(c="",this.options.version==="1.0"){if(c=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,l=n.match(c))throw new Error("Invalid character in string: "+n+" at index "+l.index)}else if(this.options.version==="1.1"&&(c=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,l=n.match(c)))throw new Error("Invalid character in string: "+n+" at index "+l.index);return n},i.prototype.assertLegalName=function(n){var c;if(this.options.noValidation)return n;if(this.assertLegalChar(n),c=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!n.match(c))throw new Error("Invalid character in name");return n},i.prototype.textEscape=function(n){var c;return this.options.noValidation?n:(c=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,n.replace(c,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},i.prototype.attEscape=function(n){var c;return this.options.noValidation?n:(c=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,n.replace(c,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},i}()}).call(Ki)});var pe=X((Ji,tn)=>{(function(){tn.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(Ji)});var ar=X((en,rn)=>{(function(){var r,t,e,i,n,c,l,f,d,T,S,b,v,h,w,C,L,P={}.hasOwnProperty;L=Nt().assign,r=Q(),d=Ie(),T=xe(),e=Oe(),i=Ce(),b=Ne(),h=Fe(),w=Re(),v=qe(),S=or(),n=_e(),c=Me(),l=Ae(),f=Le(),t=pe(),rn.exports=C=function(){function R(g){var a,o,y;g||(g={}),this.options=g,o=g.writer||{};for(a in o)!P.call(o,a)||(y=o[a],this["_"+a]=this[a],this[a]=y)}return R.prototype.filterOptions=function(g){var a,o,y,E,p,N,m,O;return g||(g={}),g=L({},this.options,g),a={writer:this},a.pretty=g.pretty||!1,a.allowEmpty=g.allowEmpty||!1,a.indent=(o=g.indent)!=null?o:"  ",a.newline=(y=g.newline)!=null?y:`
`,a.offset=(E=g.offset)!=null?E:0,a.dontPrettyTextNodes=(p=(N=g.dontPrettyTextNodes)!=null?N:g.dontprettytextnodes)!=null?p:0,a.spaceBeforeSlash=(m=(O=g.spaceBeforeSlash)!=null?O:g.spacebeforeslash)!=null?m:"",a.spaceBeforeSlash===!0&&(a.spaceBeforeSlash=" "),a.suppressPrettyCount=0,a.user={},a.state=t.None,a},R.prototype.indent=function(g,a,o){var y;return!a.pretty||a.suppressPrettyCount?"":a.pretty&&(y=(o||0)+a.offset+1,y>0)?new Array(y).join(a.indent):""},R.prototype.endline=function(g,a,o){return!a.pretty||a.suppressPrettyCount?"":a.newline},R.prototype.attribute=function(g,a,o){var y;return this.openAttribute(g,a,o),y=" "+g.name+'="'+g.value+'"',this.closeAttribute(g,a,o),y},R.prototype.cdata=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<![CDATA[",a.state=t.InsideTag,y+=g.value,a.state=t.CloseTag,y+="]]>"+this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.comment=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<!-- ",a.state=t.InsideTag,y+=g.value,a.state=t.CloseTag,y+=" -->"+this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.declaration=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<?xml",a.state=t.InsideTag,y+=' version="'+g.version+'"',g.encoding!=null&&(y+=' encoding="'+g.encoding+'"'),g.standalone!=null&&(y+=' standalone="'+g.standalone+'"'),a.state=t.CloseTag,y+=a.spaceBeforeSlash+"?>",y+=this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.docType=function(g,a,o){var y,E,p,N,m;if(o||(o=0),this.openNode(g,a,o),a.state=t.OpenTag,N=this.indent(g,a,o),N+="<!DOCTYPE "+g.root().name,g.pubID&&g.sysID?N+=' PUBLIC "'+g.pubID+'" "'+g.sysID+'"':g.sysID&&(N+=' SYSTEM "'+g.sysID+'"'),g.children.length>0){for(N+=" [",N+=this.endline(g,a,o),a.state=t.InsideTag,m=g.children,E=0,p=m.length;E<p;E++)y=m[E],N+=this.writeChildNode(y,a,o+1);a.state=t.CloseTag,N+="]"}return a.state=t.CloseTag,N+=a.spaceBeforeSlash+">",N+=this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),N},R.prototype.element=function(g,a,o){var y,E,p,N,m,O,A,_,x,F,M,q,j,B;o||(o=0),F=!1,M="",this.openNode(g,a,o),a.state=t.OpenTag,M+=this.indent(g,a,o)+"<"+g.name,q=g.attribs;for(x in q)!P.call(q,x)||(y=q[x],M+=this.attribute(y,a,o));if(p=g.children.length,N=p===0?null:g.children[0],p===0||g.children.every(function(U){return(U.type===r.Text||U.type===r.Raw)&&U.value===""}))a.allowEmpty?(M+=">",a.state=t.CloseTag,M+="</"+g.name+">"+this.endline(g,a,o)):(a.state=t.CloseTag,M+=a.spaceBeforeSlash+"/>"+this.endline(g,a,o));else if(a.pretty&&p===1&&(N.type===r.Text||N.type===r.Raw)&&N.value!=null)M+=">",a.state=t.InsideTag,a.suppressPrettyCount++,F=!0,M+=this.writeChildNode(N,a,o+1),a.suppressPrettyCount--,F=!1,a.state=t.CloseTag,M+="</"+g.name+">"+this.endline(g,a,o);else{if(a.dontPrettyTextNodes){for(j=g.children,m=0,A=j.length;m<A;m++)if(E=j[m],(E.type===r.Text||E.type===r.Raw)&&E.value!=null){a.suppressPrettyCount++,F=!0;break}}for(M+=">"+this.endline(g,a,o),a.state=t.InsideTag,B=g.children,O=0,_=B.length;O<_;O++)E=B[O],M+=this.writeChildNode(E,a,o+1);a.state=t.CloseTag,M+=this.indent(g,a,o)+"</"+g.name+">",F&&a.suppressPrettyCount--,M+=this.endline(g,a,o),a.state=t.None}return this.closeNode(g,a,o),M},R.prototype.writeChildNode=function(g,a,o){switch(g.type){case r.CData:return this.cdata(g,a,o);case r.Comment:return this.comment(g,a,o);case r.Element:return this.element(g,a,o);case r.Raw:return this.raw(g,a,o);case r.Text:return this.text(g,a,o);case r.ProcessingInstruction:return this.processingInstruction(g,a,o);case r.Dummy:return"";case r.Declaration:return this.declaration(g,a,o);case r.DocType:return this.docType(g,a,o);case r.AttributeDeclaration:return this.dtdAttList(g,a,o);case r.ElementDeclaration:return this.dtdElement(g,a,o);case r.EntityDeclaration:return this.dtdEntity(g,a,o);case r.NotationDeclaration:return this.dtdNotation(g,a,o);default:throw new Error("Unknown XML node type: "+g.constructor.name)}},R.prototype.processingInstruction=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<?",a.state=t.InsideTag,y+=g.target,g.value&&(y+=" "+g.value),a.state=t.CloseTag,y+=a.spaceBeforeSlash+"?>",y+=this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.raw=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o),a.state=t.InsideTag,y+=g.value,a.state=t.CloseTag,y+=this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.text=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o),a.state=t.InsideTag,y+=g.value,a.state=t.CloseTag,y+=this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.dtdAttList=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<!ATTLIST",a.state=t.InsideTag,y+=" "+g.elementName+" "+g.attributeName+" "+g.attributeType,g.defaultValueType!=="#DEFAULT"&&(y+=" "+g.defaultValueType),g.defaultValue&&(y+=' "'+g.defaultValue+'"'),a.state=t.CloseTag,y+=a.spaceBeforeSlash+">"+this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.dtdElement=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<!ELEMENT",a.state=t.InsideTag,y+=" "+g.name+" "+g.value,a.state=t.CloseTag,y+=a.spaceBeforeSlash+">"+this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.dtdEntity=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<!ENTITY",a.state=t.InsideTag,g.pe&&(y+=" %"),y+=" "+g.name,g.value?y+=' "'+g.value+'"':(g.pubID&&g.sysID?y+=' PUBLIC "'+g.pubID+'" "'+g.sysID+'"':g.sysID&&(y+=' SYSTEM "'+g.sysID+'"'),g.nData&&(y+=" NDATA "+g.nData)),a.state=t.CloseTag,y+=a.spaceBeforeSlash+">"+this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.dtdNotation=function(g,a,o){var y;return this.openNode(g,a,o),a.state=t.OpenTag,y=this.indent(g,a,o)+"<!NOTATION",a.state=t.InsideTag,y+=" "+g.name,g.pubID&&g.sysID?y+=' PUBLIC "'+g.pubID+'" "'+g.sysID+'"':g.pubID?y+=' PUBLIC "'+g.pubID+'"':g.sysID&&(y+=' SYSTEM "'+g.sysID+'"'),a.state=t.CloseTag,y+=a.spaceBeforeSlash+">"+this.endline(g,a,o),a.state=t.None,this.closeNode(g,a,o),y},R.prototype.openNode=function(g,a,o){},R.prototype.closeNode=function(g,a,o){},R.prototype.openAttribute=function(g,a,o){},R.prototype.closeAttribute=function(g,a,o){},R}()}).call(en)});var je=X((nn,on)=>{(function(){var r,t,e=function(n,c){for(var l in c)i.call(c,l)&&(n[l]=c[l]);function f(){this.constructor=n}return f.prototype=c.prototype,n.prototype=new f,n.__super__=c.prototype,n},i={}.hasOwnProperty;t=ar(),on.exports=r=function(n){e(c,n);function c(l){c.__super__.constructor.call(this,l)}return c.prototype.document=function(l,f){var d,T,S,b,v;for(f=this.filterOptions(f),b="",v=l.children,T=0,S=v.length;T<S;T++)d=v[T],b+=this.writeChildNode(d,f,0);return f.pretty&&b.slice(-f.newline.length)===f.newline&&(b=b.slice(0,-f.newline.length)),b},c}(t)}).call(nn)});var ur=X((sn,an)=>{(function(){var r,t,e,i,n,c,l,f,d=function(S,b){for(var v in b)T.call(b,v)&&(S[v]=b[v]);function h(){this.constructor=S}return h.prototype=b.prototype,S.prototype=new h,S.__super__=b.prototype,S},T={}.hasOwnProperty;f=Nt().isPlainObject,e=ir(),t=ui(),n=ht(),r=Q(),l=sr(),c=je(),an.exports=i=function(S){d(b,S);function b(v){b.__super__.constructor.call(this,null),this.name="#document",this.type=r.Document,this.documentURI=null,this.domConfig=new t,v||(v={}),v.writer||(v.writer=new c),this.options=v,this.stringify=new l(v)}return Object.defineProperty(b.prototype,"implementation",{value:new e}),Object.defineProperty(b.prototype,"doctype",{get:function(){var v,h,w,C;for(C=this.children,h=0,w=C.length;h<w;h++)if(v=C[h],v.type===r.DocType)return v;return null}}),Object.defineProperty(b.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(b.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(b.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(b.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].encoding:null}}),Object.defineProperty(b.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(b.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(b.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(b.prototype,"origin",{get:function(){return null}}),Object.defineProperty(b.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(b.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(b.prototype,"contentType",{get:function(){return null}}),b.prototype.end=function(v){var h;return h={},v?f(v)&&(h=v,v=this.options.writer):v=this.options.writer,v.document(this,v.filterOptions(h))},b.prototype.toString=function(v){return this.options.writer.document(this,this.options.writer.filterOptions(v))},b.prototype.createElement=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createTextNode=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createComment=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createCDATASection=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createProcessingInstruction=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createAttribute=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createEntityReference=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByTagName=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.importNode=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createElementNS=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createAttributeNS=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByTagNameNS=function(v,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementById=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.adoptNode=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.renameNode=function(v,h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByClassName=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createEvent=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createNodeIterator=function(v,h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createTreeWalker=function(v,h,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b}(n)}).call(sn)});var ln=X((un,cn)=>{(function(){var r,t,e,i,n,c,l,f,d,T,S,b,v,h,w,C,L,P,R,g,a,o,y,E,p={}.hasOwnProperty;E=Nt(),o=E.isObject,a=E.isFunction,y=E.isPlainObject,g=E.getValue,r=Q(),b=ur(),h=Ne(),i=Oe(),n=Ce(),C=Fe(),R=Re(),w=qe(),T=Ie(),S=xe(),c=_e(),f=Ae(),l=Me(),d=Le(),e=nr(),P=sr(),L=je(),t=pe(),cn.exports=v=function(){function N(m,O,A){var _;this.name="?xml",this.type=r.Document,m||(m={}),_={},m.writer?y(m.writer)&&(_=m.writer,m.writer=new L):m.writer=new L,this.options=m,this.writer=m.writer,this.writerOptions=this.writer.filterOptions(_),this.stringify=new P(m),this.onDataCallback=O||function(){},this.onEndCallback=A||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return N.prototype.createChildNode=function(m){var O,A,_,x,F,M,q,j;switch(m.type){case r.CData:this.cdata(m.value);break;case r.Comment:this.comment(m.value);break;case r.Element:_={},q=m.attribs;for(A in q)!p.call(q,A)||(O=q[A],_[A]=O.value);this.node(m.name,_);break;case r.Dummy:this.dummy();break;case r.Raw:this.raw(m.value);break;case r.Text:this.text(m.value);break;case r.ProcessingInstruction:this.instruction(m.target,m.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+m.constructor.name)}for(j=m.children,F=0,M=j.length;F<M;F++)x=j[F],this.createChildNode(x),x.type===r.Element&&this.up();return this},N.prototype.dummy=function(){return this},N.prototype.node=function(m,O,A){var _;if(m==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(m));return this.openCurrent(),m=g(m),O==null&&(O={}),O=g(O),o(O)||(_=[O,A],A=_[0],O=_[1]),this.currentNode=new h(this,m,O),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,A!=null&&this.text(A),this},N.prototype.element=function(m,O,A){var _,x,F,M,q,j;if(this.currentNode&&this.currentNode.type===r.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(m)||o(m)||a(m))for(M=this.options.noValidation,this.options.noValidation=!0,j=new b(this.options).element("TEMP_ROOT"),j.element(m),this.options.noValidation=M,q=j.children,x=0,F=q.length;x<F;x++)_=q[x],this.createChildNode(_),_.type===r.Element&&this.up();else this.node(m,O,A);return this},N.prototype.attribute=function(m,O){var A,_;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(m));if(m!=null&&(m=g(m)),o(m))for(A in m)!p.call(m,A)||(_=m[A],this.attribute(A,_));else a(O)&&(O=O.apply()),this.options.keepNullAttributes&&O==null?this.currentNode.attribs[m]=new e(this,m,""):O!=null&&(this.currentNode.attribs[m]=new e(this,m,O));return this},N.prototype.text=function(m){var O;return this.openCurrent(),O=new R(this,m),this.onData(this.writer.text(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.cdata=function(m){var O;return this.openCurrent(),O=new i(this,m),this.onData(this.writer.cdata(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.comment=function(m){var O;return this.openCurrent(),O=new n(this,m),this.onData(this.writer.comment(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.raw=function(m){var O;return this.openCurrent(),O=new C(this,m),this.onData(this.writer.raw(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.instruction=function(m,O){var A,_,x,F,M;if(this.openCurrent(),m!=null&&(m=g(m)),O!=null&&(O=g(O)),Array.isArray(m))for(A=0,F=m.length;A<F;A++)_=m[A],this.instruction(_);else if(o(m))for(_ in m)!p.call(m,_)||(x=m[_],this.instruction(_,x));else a(O)&&(O=O.apply()),M=new w(this,m,O),this.onData(this.writer.processingInstruction(M,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},N.prototype.declaration=function(m,O,A){var _;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return _=new T(this,m,O,A),this.onData(this.writer.declaration(_,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.doctype=function(m,O,A){if(this.openCurrent(),m==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new S(this,O,A),this.currentNode.rootNodeName=m,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},N.prototype.dtdElement=function(m,O){var A;return this.openCurrent(),A=new l(this,m,O),this.onData(this.writer.dtdElement(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.attList=function(m,O,A,_,x){var F;return this.openCurrent(),F=new c(this,m,O,A,_,x),this.onData(this.writer.dtdAttList(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.entity=function(m,O){var A;return this.openCurrent(),A=new f(this,!1,m,O),this.onData(this.writer.dtdEntity(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.pEntity=function(m,O){var A;return this.openCurrent(),A=new f(this,!0,m,O),this.onData(this.writer.dtdEntity(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.notation=function(m,O){var A;return this.openCurrent(),A=new d(this,m,O),this.onData(this.writer.dtdNotation(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},N.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},N.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},N.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},N.prototype.openNode=function(m){var O,A,_,x;if(!m.isOpen){if(!this.root&&this.currentLevel===0&&m.type===r.Element&&(this.root=m),A="",m.type===r.Element){this.writerOptions.state=t.OpenTag,A=this.writer.indent(m,this.writerOptions,this.currentLevel)+"<"+m.name,x=m.attribs;for(_ in x)!p.call(x,_)||(O=x[_],A+=this.writer.attribute(O,this.writerOptions,this.currentLevel));A+=(m.children?">":"/>")+this.writer.endline(m,this.writerOptions,this.currentLevel),this.writerOptions.state=t.InsideTag}else this.writerOptions.state=t.OpenTag,A=this.writer.indent(m,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+m.rootNodeName,m.pubID&&m.sysID?A+=' PUBLIC "'+m.pubID+'" "'+m.sysID+'"':m.sysID&&(A+=' SYSTEM "'+m.sysID+'"'),m.children?(A+=" [",this.writerOptions.state=t.InsideTag):(this.writerOptions.state=t.CloseTag,A+=">"),A+=this.writer.endline(m,this.writerOptions,this.currentLevel);return this.onData(A,this.currentLevel),m.isOpen=!0}},N.prototype.closeNode=function(m){var O;if(!m.isClosed)return O="",this.writerOptions.state=t.CloseTag,m.type===r.Element?O=this.writer.indent(m,this.writerOptions,this.currentLevel)+"</"+m.name+">"+this.writer.endline(m,this.writerOptions,this.currentLevel):O=this.writer.indent(m,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(m,this.writerOptions,this.currentLevel),this.writerOptions.state=t.None,this.onData(O,this.currentLevel),m.isClosed=!0},N.prototype.onData=function(m,O){return this.documentStarted=!0,this.onDataCallback(m,O+1)},N.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},N.prototype.debugInfo=function(m){return m==null?"":"node: <"+m+">"},N.prototype.ele=function(){return this.element.apply(this,arguments)},N.prototype.nod=function(m,O,A){return this.node(m,O,A)},N.prototype.txt=function(m){return this.text(m)},N.prototype.dat=function(m){return this.cdata(m)},N.prototype.com=function(m){return this.comment(m)},N.prototype.ins=function(m,O){return this.instruction(m,O)},N.prototype.dec=function(m,O,A){return this.declaration(m,O,A)},N.prototype.dtd=function(m,O,A){return this.doctype(m,O,A)},N.prototype.e=function(m,O,A){return this.element(m,O,A)},N.prototype.n=function(m,O,A){return this.node(m,O,A)},N.prototype.t=function(m){return this.text(m)},N.prototype.d=function(m){return this.cdata(m)},N.prototype.c=function(m){return this.comment(m)},N.prototype.r=function(m){return this.raw(m)},N.prototype.i=function(m,O){return this.instruction(m,O)},N.prototype.att=function(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},N.prototype.a=function(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},N.prototype.ent=function(m,O){return this.entity(m,O)},N.prototype.pent=function(m,O){return this.pEntity(m,O)},N.prototype.not=function(m,O){return this.notation(m,O)},N}()}).call(un)});var pn=X((hn,fn)=>{(function(){var r,t,e,i,n=function(l,f){for(var d in f)c.call(f,d)&&(l[d]=f[d]);function T(){this.constructor=l}return T.prototype=f.prototype,l.prototype=new T,l.__super__=f.prototype,l},c={}.hasOwnProperty;r=Q(),i=ar(),t=pe(),fn.exports=e=function(l){n(f,l);function f(d,T){this.stream=d,f.__super__.constructor.call(this,T)}return f.prototype.endline=function(d,T,S){return d.isLastRootNode&&T.state===t.CloseTag?"":f.__super__.endline.call(this,d,T,S)},f.prototype.document=function(d,T){var S,b,v,h,w,C,L,P,R;for(L=d.children,b=v=0,w=L.length;v<w;b=++v)S=L[b],S.isLastRootNode=b===d.children.length-1;for(T=this.filterOptions(T),P=d.children,R=[],h=0,C=P.length;h<C;h++)S=P[h],R.push(this.writeChildNode(S,T,0));return R},f.prototype.attribute=function(d,T,S){return this.stream.write(f.__super__.attribute.call(this,d,T,S))},f.prototype.cdata=function(d,T,S){return this.stream.write(f.__super__.cdata.call(this,d,T,S))},f.prototype.comment=function(d,T,S){return this.stream.write(f.__super__.comment.call(this,d,T,S))},f.prototype.declaration=function(d,T,S){return this.stream.write(f.__super__.declaration.call(this,d,T,S))},f.prototype.docType=function(d,T,S){var b,v,h,w;if(S||(S=0),this.openNode(d,T,S),T.state=t.OpenTag,this.stream.write(this.indent(d,T,S)),this.stream.write("<!DOCTYPE "+d.root().name),d.pubID&&d.sysID?this.stream.write(' PUBLIC "'+d.pubID+'" "'+d.sysID+'"'):d.sysID&&this.stream.write(' SYSTEM "'+d.sysID+'"'),d.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(d,T,S)),T.state=t.InsideTag,w=d.children,v=0,h=w.length;v<h;v++)b=w[v],this.writeChildNode(b,T,S+1);T.state=t.CloseTag,this.stream.write("]")}return T.state=t.CloseTag,this.stream.write(T.spaceBeforeSlash+">"),this.stream.write(this.endline(d,T,S)),T.state=t.None,this.closeNode(d,T,S)},f.prototype.element=function(d,T,S){var b,v,h,w,C,L,P,R,g,a;S||(S=0),this.openNode(d,T,S),T.state=t.OpenTag,this.stream.write(this.indent(d,T,S)+"<"+d.name),g=d.attribs;for(P in g)!c.call(g,P)||(b=g[P],this.attribute(b,T,S));if(h=d.children.length,w=h===0?null:d.children[0],h===0||d.children.every(function(o){return(o.type===r.Text||o.type===r.Raw)&&o.value===""}))T.allowEmpty?(this.stream.write(">"),T.state=t.CloseTag,this.stream.write("</"+d.name+">")):(T.state=t.CloseTag,this.stream.write(T.spaceBeforeSlash+"/>"));else if(T.pretty&&h===1&&(w.type===r.Text||w.type===r.Raw)&&w.value!=null)this.stream.write(">"),T.state=t.InsideTag,T.suppressPrettyCount++,R=!0,this.writeChildNode(w,T,S+1),T.suppressPrettyCount--,R=!1,T.state=t.CloseTag,this.stream.write("</"+d.name+">");else{for(this.stream.write(">"+this.endline(d,T,S)),T.state=t.InsideTag,a=d.children,C=0,L=a.length;C<L;C++)v=a[C],this.writeChildNode(v,T,S+1);T.state=t.CloseTag,this.stream.write(this.indent(d,T,S)+"</"+d.name+">")}return this.stream.write(this.endline(d,T,S)),T.state=t.None,this.closeNode(d,T,S)},f.prototype.processingInstruction=function(d,T,S){return this.stream.write(f.__super__.processingInstruction.call(this,d,T,S))},f.prototype.raw=function(d,T,S){return this.stream.write(f.__super__.raw.call(this,d,T,S))},f.prototype.text=function(d,T,S){return this.stream.write(f.__super__.text.call(this,d,T,S))},f.prototype.dtdAttList=function(d,T,S){return this.stream.write(f.__super__.dtdAttList.call(this,d,T,S))},f.prototype.dtdElement=function(d,T,S){return this.stream.write(f.__super__.dtdElement.call(this,d,T,S))},f.prototype.dtdEntity=function(d,T,S){return this.stream.write(f.__super__.dtdEntity.call(this,d,T,S))},f.prototype.dtdNotation=function(d,T,S){return this.stream.write(f.__super__.dtdNotation.call(this,d,T,S))},f}(i)}).call(hn)});var mn=X((dn,qt)=>{(function(){var r,t,e,i,n,c,l,f,d,T;T=Nt(),f=T.assign,d=T.isFunction,e=ir(),i=ur(),n=ln(),l=je(),c=pn(),r=Q(),t=pe(),qt.exports.create=function(S,b,v,h){var w,C;if(S==null)throw new Error("Root element needs a name.");return h=f({},b,v,h),w=new i(h),C=w.element(S),h.headless||(w.declaration(h),(h.pubID!=null||h.sysID!=null)&&w.dtd(h)),C},qt.exports.begin=function(S,b,v){var h;return d(S)&&(h=[S,b],b=h[0],v=h[1],S={}),b?new n(S,b,v):new i(S)},qt.exports.stringWriter=function(S){return new l(S)},qt.exports.streamWriter=function(S,b){return new c(S,b)},qt.exports.implementation=new e,qt.exports.nodeType=r,qt.exports.writerState=t}).call(dn)});var gn=X(cr=>{(function(){"use strict";var r,t,e,i,n,c={}.hasOwnProperty;r=mn(),t=Se().defaults,i=function(l){return typeof l=="string"&&(l.indexOf("&")>=0||l.indexOf(">")>=0||l.indexOf("<")>=0)},n=function(l){return"<![CDATA["+e(l)+"]]>"},e=function(l){return l.replace("]]>","]]]]><![CDATA[>")},cr.Builder=function(){function l(f){var d,T,S;this.options={},T=t["0.2"];for(d in T)!c.call(T,d)||(S=T[d],this.options[d]=S);for(d in f)!c.call(f,d)||(S=f[d],this.options[d]=S)}return l.prototype.buildObject=function(f){var d,T,S,b,v;return d=this.options.attrkey,T=this.options.charkey,Object.keys(f).length===1&&this.options.rootName===t["0.2"].rootName?(v=Object.keys(f)[0],f=f[v]):v=this.options.rootName,S=function(h){return function(w,C){var L,P,R,g,a,o;if(typeof C!="object")h.options.cdata&&i(C)?w.raw(n(C)):w.txt(C);else if(Array.isArray(C)){for(g in C)if(!!c.call(C,g)){P=C[g];for(a in P)R=P[a],w=S(w.ele(a),R).up()}}else for(a in C)if(!!c.call(C,a))if(P=C[a],a===d){if(typeof P=="object")for(L in P)o=P[L],w=w.att(L,o)}else if(a===T)h.options.cdata&&i(P)?w=w.raw(n(P)):w=w.txt(P);else if(Array.isArray(P))for(g in P)!c.call(P,g)||(R=P[g],typeof R=="string"?h.options.cdata&&i(R)?w=w.ele(a).raw(n(R)).up():w=w.ele(a,R).up():w=S(w.ele(a),R).up());else typeof P=="object"?w=S(w.ele(a),P).up():typeof P=="string"&&h.options.cdata&&i(P)?w=w.ele(a).raw(n(P)).up():(P==null&&(P=""),w=w.ele(a,P.toString()).up());return w}}(this),b=r.create(v,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),S(b,f).end(this.options.renderOpts)},l}()}).call(cr)});var yn=X($e=>{(function(r){r.parser=function(u,s){return new e(u,s)},r.SAXParser=e,r.SAXStream=T,r.createStream=d,r.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];r.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function e(u,s){if(!(this instanceof e))return new e(u,s);var I=this;n(I),I.q=I.c="",I.bufferCheckPosition=r.MAX_BUFFER_LENGTH,I.opt=s||{},I.opt.lowercase=I.opt.lowercase||I.opt.lowercasetags,I.looseCase=I.opt.lowercase?"toLowerCase":"toUpperCase",I.tags=[],I.closed=I.closedRoot=I.sawRoot=!1,I.tag=I.error=null,I.strict=!!u,I.noscript=!!(u||I.opt.noscript),I.state=p.BEGIN,I.strictEntities=I.opt.strictEntities,I.ENTITIES=I.strictEntities?Object.create(r.XML_ENTITIES):Object.create(r.ENTITIES),I.attribList=[],I.opt.xmlns&&(I.ns=Object.create(w)),I.trackPosition=I.opt.position!==!1,I.trackPosition&&(I.position=I.line=I.column=0),m(I,"onready")}Object.create||(Object.create=function(u){function s(){}s.prototype=u;var I=new s;return I}),Object.keys||(Object.keys=function(u){var s=[];for(var I in u)u.hasOwnProperty(I)&&s.push(I);return s});function i(u){for(var s=Math.max(r.MAX_BUFFER_LENGTH,10),I=0,D=0,k=t.length;D<k;D++){var Y=u[t[D]].length;if(Y>s)switch(t[D]){case"textNode":A(u);break;case"cdata":O(u,"oncdata",u.cdata),u.cdata="";break;case"script":O(u,"onscript",u.script),u.script="";break;default:x(u,"Max buffer length exceeded: "+t[D])}I=Math.max(I,Y)}var Z=r.MAX_BUFFER_LENGTH-I;u.bufferCheckPosition=Z+u.position}function n(u){for(var s=0,I=t.length;s<I;s++)u[t[s]]=""}function c(u){A(u),u.cdata!==""&&(O(u,"oncdata",u.cdata),u.cdata=""),u.script!==""&&(O(u,"onscript",u.script),u.script="")}e.prototype={end:function(){F(this)},write:wt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){c(this)}};var l;try{l=require("stream").Stream}catch{l=function(){}}var f=r.EVENTS.filter(function(u){return u!=="error"&&u!=="end"});function d(u,s){return new T(u,s)}function T(u,s){if(!(this instanceof T))return new T(u,s);l.apply(this),this._parser=new e(u,s),this.writable=!0,this.readable=!0;var I=this;this._parser.onend=function(){I.emit("end")},this._parser.onerror=function(D){I.emit("error",D),I._parser.error=null},this._decoder=null,f.forEach(function(D){Object.defineProperty(I,"on"+D,{get:function(){return I._parser["on"+D]},set:function(k){if(!k)return I.removeAllListeners(D),I._parser["on"+D]=k,k;I.on(D,k)},enumerable:!0,configurable:!1})})}T.prototype=Object.create(l.prototype,{constructor:{value:T}}),T.prototype.write=function(u){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(u)){if(!this._decoder){var s=require("string_decoder").StringDecoder;this._decoder=new s("utf8")}u=this._decoder.write(u)}return this._parser.write(u.toString()),this.emit("data",u),!0},T.prototype.end=function(u){return u&&u.length&&this.write(u),this._parser.end(),!0},T.prototype.on=function(u,s){var I=this;return!I._parser["on"+u]&&f.indexOf(u)!==-1&&(I._parser["on"+u]=function(){var D=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);D.splice(0,0,u),I.emit.apply(I,D)}),l.prototype.on.call(I,u,s)};var S="[CDATA[",b="DOCTYPE",v="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",w={xml:v,xmlns:h},C=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,L=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,P=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,R=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(u){return u===" "||u===`
`||u==="\r"||u==="	"}function a(u){return u==='"'||u==="'"}function o(u){return u===">"||g(u)}function y(u,s){return u.test(s)}function E(u,s){return!y(u,s)}var p=0;r.STATE={BEGIN:p++,BEGIN_WHITESPACE:p++,TEXT:p++,TEXT_ENTITY:p++,OPEN_WAKA:p++,SGML_DECL:p++,SGML_DECL_QUOTED:p++,DOCTYPE:p++,DOCTYPE_QUOTED:p++,DOCTYPE_DTD:p++,DOCTYPE_DTD_QUOTED:p++,COMMENT_STARTING:p++,COMMENT:p++,COMMENT_ENDING:p++,COMMENT_ENDED:p++,CDATA:p++,CDATA_ENDING:p++,CDATA_ENDING_2:p++,PROC_INST:p++,PROC_INST_BODY:p++,PROC_INST_ENDING:p++,OPEN_TAG:p++,OPEN_TAG_SLASH:p++,ATTRIB:p++,ATTRIB_NAME:p++,ATTRIB_NAME_SAW_WHITE:p++,ATTRIB_VALUE:p++,ATTRIB_VALUE_QUOTED:p++,ATTRIB_VALUE_CLOSED:p++,ATTRIB_VALUE_UNQUOTED:p++,ATTRIB_VALUE_ENTITY_Q:p++,ATTRIB_VALUE_ENTITY_U:p++,CLOSE_TAG:p++,CLOSE_TAG_SAW_WHITE:p++,SCRIPT:p++,SCRIPT_ENDING:p++},r.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},r.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(r.ENTITIES).forEach(function(u){var s=r.ENTITIES[u],I=typeof s=="number"?String.fromCharCode(s):s;r.ENTITIES[u]=I});for(var N in r.STATE)r.STATE[r.STATE[N]]=N;p=r.STATE;function m(u,s,I){u[s]&&u[s](I)}function O(u,s,I){u.textNode&&A(u),m(u,s,I)}function A(u){u.textNode=_(u.opt,u.textNode),u.textNode&&m(u,"ontext",u.textNode),u.textNode=""}function _(u,s){return u.trim&&(s=s.trim()),u.normalize&&(s=s.replace(/\s+/g," ")),s}function x(u,s){return A(u),u.trackPosition&&(s+=`
Line: `+u.line+`
Column: `+u.column+`
Char: `+u.c),s=new Error(s),u.error=s,m(u,"onerror",s),u}function F(u){return u.sawRoot&&!u.closedRoot&&M(u,"Unclosed root tag"),u.state!==p.BEGIN&&u.state!==p.BEGIN_WHITESPACE&&u.state!==p.TEXT&&x(u,"Unexpected end"),A(u),u.c="",u.closed=!0,m(u,"onend"),e.call(u,u.strict,u.opt),u}function M(u,s){if(typeof u!="object"||!(u instanceof e))throw new Error("bad call to strictFail");u.strict&&x(u,s)}function q(u){u.strict||(u.tagName=u.tagName[u.looseCase]());var s=u.tags[u.tags.length-1]||u,I=u.tag={name:u.tagName,attributes:{}};u.opt.xmlns&&(I.ns=s.ns),u.attribList.length=0,O(u,"onopentagstart",I)}function j(u,s){var I=u.indexOf(":"),D=I<0?["",u]:u.split(":"),k=D[0],Y=D[1];return s&&u==="xmlns"&&(k="xmlns",Y=""),{prefix:k,local:Y}}function B(u){if(u.strict||(u.attribName=u.attribName[u.looseCase]()),u.attribList.indexOf(u.attribName)!==-1||u.tag.attributes.hasOwnProperty(u.attribName)){u.attribName=u.attribValue="";return}if(u.opt.xmlns){var s=j(u.attribName,!0),I=s.prefix,D=s.local;if(I==="xmlns")if(D==="xml"&&u.attribValue!==v)M(u,"xml: prefix must be bound to "+v+`
Actual: `+u.attribValue);else if(D==="xmlns"&&u.attribValue!==h)M(u,"xmlns: prefix must be bound to "+h+`
Actual: `+u.attribValue);else{var k=u.tag,Y=u.tags[u.tags.length-1]||u;k.ns===Y.ns&&(k.ns=Object.create(Y.ns)),k.ns[D]=u.attribValue}u.attribList.push([u.attribName,u.attribValue])}else u.tag.attributes[u.attribName]=u.attribValue,O(u,"onattribute",{name:u.attribName,value:u.attribValue});u.attribName=u.attribValue=""}function U(u,s){if(u.opt.xmlns){var I=u.tag,D=j(u.tagName);I.prefix=D.prefix,I.local=D.local,I.uri=I.ns[D.prefix]||"",I.prefix&&!I.uri&&(M(u,"Unbound namespace prefix: "+JSON.stringify(u.tagName)),I.uri=D.prefix);var k=u.tags[u.tags.length-1]||u;I.ns&&k.ns!==I.ns&&Object.keys(I.ns).forEach(function(Cr){O(u,"onopennamespace",{prefix:Cr,uri:I.ns[Cr]})});for(var Y=0,Z=u.attribList.length;Y<Z;Y++){var at=u.attribList[Y],Et=at[0],Kt=at[1],it=j(Et,!0),At=it.prefix,Mn=it.local,Or=At===""?"":I.ns[At]||"",Ye={name:Et,value:Kt,prefix:At,local:Mn,uri:Or};At&&At!=="xmlns"&&!Or&&(M(u,"Unbound namespace prefix: "+JSON.stringify(At)),Ye.uri=At),u.tag.attributes[Et]=Ye,O(u,"onattribute",Ye)}u.attribList.length=0}u.tag.isSelfClosing=!!s,u.sawRoot=!0,u.tags.push(u.tag),O(u,"onopentag",u.tag),s||(!u.noscript&&u.tagName.toLowerCase()==="script"?u.state=p.SCRIPT:u.state=p.TEXT,u.tag=null,u.tagName=""),u.attribName=u.attribValue="",u.attribList.length=0}function H(u){if(!u.tagName){M(u,"Weird empty close tag."),u.textNode+="</>",u.state=p.TEXT;return}if(u.script){if(u.tagName!=="script"){u.script+="</"+u.tagName+">",u.tagName="",u.state=p.SCRIPT;return}O(u,"onscript",u.script),u.script=""}var s=u.tags.length,I=u.tagName;u.strict||(I=I[u.looseCase]());for(var D=I;s--;){var k=u.tags[s];if(k.name!==D)M(u,"Unexpected close tag");else break}if(s<0){M(u,"Unmatched closing tag: "+u.tagName),u.textNode+="</"+u.tagName+">",u.state=p.TEXT;return}u.tagName=I;for(var Y=u.tags.length;Y-- >s;){var Z=u.tag=u.tags.pop();u.tagName=u.tag.name,O(u,"onclosetag",u.tagName);var at={};for(var Et in Z.ns)at[Et]=Z.ns[Et];var Kt=u.tags[u.tags.length-1]||u;u.opt.xmlns&&Z.ns!==Kt.ns&&Object.keys(Z.ns).forEach(function(it){var At=Z.ns[it];O(u,"onclosenamespace",{prefix:it,uri:At})})}s===0&&(u.closedRoot=!0),u.tagName=u.attribValue=u.attribName="",u.attribList.length=0,u.state=p.TEXT}function W(u){var s=u.entity,I=s.toLowerCase(),D,k="";return u.ENTITIES[s]?u.ENTITIES[s]:u.ENTITIES[I]?u.ENTITIES[I]:(s=I,s.charAt(0)==="#"&&(s.charAt(1)==="x"?(s=s.slice(2),D=parseInt(s,16),k=D.toString(16)):(s=s.slice(1),D=parseInt(s,10),k=D.toString(10))),s=s.replace(/^0+/,""),isNaN(D)||k.toLowerCase()!==s?(M(u,"Invalid character entity"),"&"+u.entity+";"):String.fromCodePoint(D))}function et(u,s){s==="<"?(u.state=p.OPEN_WAKA,u.startTagPosition=u.position):g(s)||(M(u,"Non-whitespace before first tag."),u.textNode=s,u.state=p.TEXT)}function yt(u,s){var I="";return s<u.length&&(I=u.charAt(s)),I}function wt(u){var s=this;if(this.error)throw this.error;if(s.closed)return x(s,"Cannot write after close. Assign an onready handler.");if(u===null)return F(s);typeof u=="object"&&(u=u.toString());for(var I=0,D="";D=yt(u,I++),s.c=D,!!D;)switch(s.trackPosition&&(s.position++,D===`
`?(s.line++,s.column=0):s.column++),s.state){case p.BEGIN:if(s.state=p.BEGIN_WHITESPACE,D==="\uFEFF")continue;et(s,D);continue;case p.BEGIN_WHITESPACE:et(s,D);continue;case p.TEXT:if(s.sawRoot&&!s.closedRoot){for(var k=I-1;D&&D!=="<"&&D!=="&";)D=yt(u,I++),D&&s.trackPosition&&(s.position++,D===`
`?(s.line++,s.column=0):s.column++);s.textNode+=u.substring(k,I-1)}D==="<"&&!(s.sawRoot&&s.closedRoot&&!s.strict)?(s.state=p.OPEN_WAKA,s.startTagPosition=s.position):(!g(D)&&(!s.sawRoot||s.closedRoot)&&M(s,"Text data outside of root node."),D==="&"?s.state=p.TEXT_ENTITY:s.textNode+=D);continue;case p.SCRIPT:D==="<"?s.state=p.SCRIPT_ENDING:s.script+=D;continue;case p.SCRIPT_ENDING:D==="/"?s.state=p.CLOSE_TAG:(s.script+="<"+D,s.state=p.SCRIPT);continue;case p.OPEN_WAKA:if(D==="!")s.state=p.SGML_DECL,s.sgmlDecl="";else if(!g(D))if(y(C,D))s.state=p.OPEN_TAG,s.tagName=D;else if(D==="/")s.state=p.CLOSE_TAG,s.tagName="";else if(D==="?")s.state=p.PROC_INST,s.procInstName=s.procInstBody="";else{if(M(s,"Unencoded <"),s.startTagPosition+1<s.position){var Y=s.position-s.startTagPosition;D=new Array(Y).join(" ")+D}s.textNode+="<"+D,s.state=p.TEXT}continue;case p.SGML_DECL:(s.sgmlDecl+D).toUpperCase()===S?(O(s,"onopencdata"),s.state=p.CDATA,s.sgmlDecl="",s.cdata=""):s.sgmlDecl+D==="--"?(s.state=p.COMMENT,s.comment="",s.sgmlDecl=""):(s.sgmlDecl+D).toUpperCase()===b?(s.state=p.DOCTYPE,(s.doctype||s.sawRoot)&&M(s,"Inappropriately located doctype declaration"),s.doctype="",s.sgmlDecl=""):D===">"?(O(s,"onsgmldeclaration",s.sgmlDecl),s.sgmlDecl="",s.state=p.TEXT):(a(D)&&(s.state=p.SGML_DECL_QUOTED),s.sgmlDecl+=D);continue;case p.SGML_DECL_QUOTED:D===s.q&&(s.state=p.SGML_DECL,s.q=""),s.sgmlDecl+=D;continue;case p.DOCTYPE:D===">"?(s.state=p.TEXT,O(s,"ondoctype",s.doctype),s.doctype=!0):(s.doctype+=D,D==="["?s.state=p.DOCTYPE_DTD:a(D)&&(s.state=p.DOCTYPE_QUOTED,s.q=D));continue;case p.DOCTYPE_QUOTED:s.doctype+=D,D===s.q&&(s.q="",s.state=p.DOCTYPE);continue;case p.DOCTYPE_DTD:s.doctype+=D,D==="]"?s.state=p.DOCTYPE:a(D)&&(s.state=p.DOCTYPE_DTD_QUOTED,s.q=D);continue;case p.DOCTYPE_DTD_QUOTED:s.doctype+=D,D===s.q&&(s.state=p.DOCTYPE_DTD,s.q="");continue;case p.COMMENT:D==="-"?s.state=p.COMMENT_ENDING:s.comment+=D;continue;case p.COMMENT_ENDING:D==="-"?(s.state=p.COMMENT_ENDED,s.comment=_(s.opt,s.comment),s.comment&&O(s,"oncomment",s.comment),s.comment=""):(s.comment+="-"+D,s.state=p.COMMENT);continue;case p.COMMENT_ENDED:D!==">"?(M(s,"Malformed comment"),s.comment+="--"+D,s.state=p.COMMENT):s.state=p.TEXT;continue;case p.CDATA:D==="]"?s.state=p.CDATA_ENDING:s.cdata+=D;continue;case p.CDATA_ENDING:D==="]"?s.state=p.CDATA_ENDING_2:(s.cdata+="]"+D,s.state=p.CDATA);continue;case p.CDATA_ENDING_2:D===">"?(s.cdata&&O(s,"oncdata",s.cdata),O(s,"onclosecdata"),s.cdata="",s.state=p.TEXT):D==="]"?s.cdata+="]":(s.cdata+="]]"+D,s.state=p.CDATA);continue;case p.PROC_INST:D==="?"?s.state=p.PROC_INST_ENDING:g(D)?s.state=p.PROC_INST_BODY:s.procInstName+=D;continue;case p.PROC_INST_BODY:if(!s.procInstBody&&g(D))continue;D==="?"?s.state=p.PROC_INST_ENDING:s.procInstBody+=D;continue;case p.PROC_INST_ENDING:D===">"?(O(s,"onprocessinginstruction",{name:s.procInstName,body:s.procInstBody}),s.procInstName=s.procInstBody="",s.state=p.TEXT):(s.procInstBody+="?"+D,s.state=p.PROC_INST_BODY);continue;case p.OPEN_TAG:y(L,D)?s.tagName+=D:(q(s),D===">"?U(s):D==="/"?s.state=p.OPEN_TAG_SLASH:(g(D)||M(s,"Invalid character in tag name"),s.state=p.ATTRIB));continue;case p.OPEN_TAG_SLASH:D===">"?(U(s,!0),H(s)):(M(s,"Forward-slash in opening tag not followed by >"),s.state=p.ATTRIB);continue;case p.ATTRIB:if(g(D))continue;D===">"?U(s):D==="/"?s.state=p.OPEN_TAG_SLASH:y(C,D)?(s.attribName=D,s.attribValue="",s.state=p.ATTRIB_NAME):M(s,"Invalid attribute name");continue;case p.ATTRIB_NAME:D==="="?s.state=p.ATTRIB_VALUE:D===">"?(M(s,"Attribute without value"),s.attribValue=s.attribName,B(s),U(s)):g(D)?s.state=p.ATTRIB_NAME_SAW_WHITE:y(L,D)?s.attribName+=D:M(s,"Invalid attribute name");continue;case p.ATTRIB_NAME_SAW_WHITE:if(D==="=")s.state=p.ATTRIB_VALUE;else{if(g(D))continue;M(s,"Attribute without value"),s.tag.attributes[s.attribName]="",s.attribValue="",O(s,"onattribute",{name:s.attribName,value:""}),s.attribName="",D===">"?U(s):y(C,D)?(s.attribName=D,s.state=p.ATTRIB_NAME):(M(s,"Invalid attribute name"),s.state=p.ATTRIB)}continue;case p.ATTRIB_VALUE:if(g(D))continue;a(D)?(s.q=D,s.state=p.ATTRIB_VALUE_QUOTED):(M(s,"Unquoted attribute value"),s.state=p.ATTRIB_VALUE_UNQUOTED,s.attribValue=D);continue;case p.ATTRIB_VALUE_QUOTED:if(D!==s.q){D==="&"?s.state=p.ATTRIB_VALUE_ENTITY_Q:s.attribValue+=D;continue}B(s),s.q="",s.state=p.ATTRIB_VALUE_CLOSED;continue;case p.ATTRIB_VALUE_CLOSED:g(D)?s.state=p.ATTRIB:D===">"?U(s):D==="/"?s.state=p.OPEN_TAG_SLASH:y(C,D)?(M(s,"No whitespace between attributes"),s.attribName=D,s.attribValue="",s.state=p.ATTRIB_NAME):M(s,"Invalid attribute name");continue;case p.ATTRIB_VALUE_UNQUOTED:if(!o(D)){D==="&"?s.state=p.ATTRIB_VALUE_ENTITY_U:s.attribValue+=D;continue}B(s),D===">"?U(s):s.state=p.ATTRIB;continue;case p.CLOSE_TAG:if(s.tagName)D===">"?H(s):y(L,D)?s.tagName+=D:s.script?(s.script+="</"+s.tagName,s.tagName="",s.state=p.SCRIPT):(g(D)||M(s,"Invalid tagname in closing tag"),s.state=p.CLOSE_TAG_SAW_WHITE);else{if(g(D))continue;E(C,D)?s.script?(s.script+="</"+D,s.state=p.SCRIPT):M(s,"Invalid tagname in closing tag."):s.tagName=D}continue;case p.CLOSE_TAG_SAW_WHITE:if(g(D))continue;D===">"?H(s):M(s,"Invalid characters in closing tag");continue;case p.TEXT_ENTITY:case p.ATTRIB_VALUE_ENTITY_Q:case p.ATTRIB_VALUE_ENTITY_U:var Z,at;switch(s.state){case p.TEXT_ENTITY:Z=p.TEXT,at="textNode";break;case p.ATTRIB_VALUE_ENTITY_Q:Z=p.ATTRIB_VALUE_QUOTED,at="attribValue";break;case p.ATTRIB_VALUE_ENTITY_U:Z=p.ATTRIB_VALUE_UNQUOTED,at="attribValue";break}D===";"?(s[at]+=W(s),s.entity="",s.state=Z):y(s.entity.length?R:P,D)?s.entity+=D:(M(s,"Invalid character in entity name"),s[at]+="&"+s.entity+D,s.entity="",s.state=Z);continue;default:throw new Error(s,"Unknown state: "+s.state)}return s.position>=s.bufferCheckPosition&&i(s),s}String.fromCodePoint||function(){var u=String.fromCharCode,s=Math.floor,I=function(){var D=16384,k=[],Y,Z,at=-1,Et=arguments.length;if(!Et)return"";for(var Kt="";++at<Et;){var it=Number(arguments[at]);if(!isFinite(it)||it<0||it>1114111||s(it)!==it)throw RangeError("Invalid code point: "+it);it<=65535?k.push(it):(it-=65536,Y=(it>>10)+55296,Z=it%1024+56320,k.push(Y,Z)),(at+1===Et||k.length>D)&&(Kt+=u.apply(null,k),k.length=0)}return Kt};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:I,configurable:!0,writable:!0}):String.fromCodePoint=I}()})(typeof $e>"u"?$e.sax={}:$e)});var wn=X(lr=>{(function(){"use strict";lr.stripBOM=function(r){return r[0]==="\uFEFF"?r.substring(1):r}}).call(lr)});var hr=X(kt=>{(function(){"use strict";var r;r=new RegExp(/(?!xmlns)^.*:/),kt.normalize=function(t){return t.toLowerCase()},kt.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},kt.stripPrefix=function(t){return t.replace(r,"")},kt.parseNumbers=function(t){return isNaN(t)||(t=t%1===0?parseInt(t,10):parseFloat(t)),t},kt.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t=t.toLowerCase()==="true"),t}}).call(kt)});var vn=X(Lt=>{(function(){"use strict";var r,t,e,i,n,c,l,f,d=function(b,v){return function(){return b.apply(v,arguments)}},T=function(b,v){for(var h in v)S.call(v,h)&&(b[h]=v[h]);function w(){this.constructor=b}return w.prototype=v.prototype,b.prototype=new w,b.__super__=v.prototype,b},S={}.hasOwnProperty;l=yn(),e=require("events"),r=wn(),c=hr(),f=require("timers").setImmediate,t=Se().defaults,i=function(b){return typeof b=="object"&&b!=null&&Object.keys(b).length===0},n=function(b,v,h){var w,C,L;for(w=0,C=b.length;w<C;w++)L=b[w],v=L(v,h);return v},Lt.Parser=function(b){T(v,b);function v(h){this.parseStringPromise=d(this.parseStringPromise,this),this.parseString=d(this.parseString,this),this.reset=d(this.reset,this),this.assignOrPush=d(this.assignOrPush,this),this.processAsync=d(this.processAsync,this);var w,C,L;if(!(this instanceof Lt.Parser))return new Lt.Parser(h);this.options={},C=t["0.2"];for(w in C)!S.call(C,w)||(L=C[w],this.options[w]=L);for(w in h)!S.call(h,w)||(L=h[w],this.options[w]=L);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(c.normalize)),this.reset()}return v.prototype.processAsync=function(){var h,w;try{return this.remaining.length<=this.options.chunkSize?(h=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(h),this.saxParser.close()):(h=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(h),f(this.processAsync))}catch(C){if(w=C,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(w)}},v.prototype.assignOrPush=function(h,w,C){return w in h?(h[w]instanceof Array||(h[w]=[h[w]]),h[w].push(C)):this.options.explicitArray?h[w]=[C]:h[w]=C},v.prototype.reset=function(){var h,w,C,L;return this.removeAllListeners(),this.saxParser=l.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(P){return function(R){if(P.saxParser.resume(),!P.saxParser.errThrown)return P.saxParser.errThrown=!0,P.emit("error",R)}}(this),this.saxParser.onend=function(P){return function(){if(!P.saxParser.ended)return P.saxParser.ended=!0,P.emit("end",P.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,L=[],h=this.options.attrkey,w=this.options.charkey,this.saxParser.onopentag=function(P){return function(R){var g,a,o,y,E;if(o={},o[w]="",!P.options.ignoreAttrs){E=R.attributes;for(g in E)!S.call(E,g)||(!(h in o)&&!P.options.mergeAttrs&&(o[h]={}),a=P.options.attrValueProcessors?n(P.options.attrValueProcessors,R.attributes[g],g):R.attributes[g],y=P.options.attrNameProcessors?n(P.options.attrNameProcessors,g):g,P.options.mergeAttrs?P.assignOrPush(o,y,a):o[h][y]=a)}return o["#name"]=P.options.tagNameProcessors?n(P.options.tagNameProcessors,R.name):R.name,P.options.xmlns&&(o[P.options.xmlnskey]={uri:R.uri,local:R.local}),L.push(o)}}(this),this.saxParser.onclosetag=function(P){return function(){var R,g,a,o,y,E,p,N,m,O;if(E=L.pop(),y=E["#name"],(!P.options.explicitChildren||!P.options.preserveChildrenOrder)&&delete E["#name"],E.cdata===!0&&(R=E.cdata,delete E.cdata),m=L[L.length-1],E[w].match(/^\s*$/)&&!R?(g=E[w],delete E[w]):(P.options.trim&&(E[w]=E[w].trim()),P.options.normalize&&(E[w]=E[w].replace(/\s{2,}/g," ").trim()),E[w]=P.options.valueProcessors?n(P.options.valueProcessors,E[w],y):E[w],Object.keys(E).length===1&&w in E&&!P.EXPLICIT_CHARKEY&&(E=E[w])),i(E)&&(E=P.options.emptyTag!==""?P.options.emptyTag:g),P.options.validator!=null&&(O="/"+function(){var A,_,x;for(x=[],A=0,_=L.length;A<_;A++)o=L[A],x.push(o["#name"]);return x}().concat(y).join("/"),function(){var A;try{return E=P.options.validator(O,m&&m[y],E)}catch(_){return A=_,P.emit("error",A)}}()),P.options.explicitChildren&&!P.options.mergeAttrs&&typeof E=="object"){if(!P.options.preserveChildrenOrder)o={},P.options.attrkey in E&&(o[P.options.attrkey]=E[P.options.attrkey],delete E[P.options.attrkey]),!P.options.charsAsChildren&&P.options.charkey in E&&(o[P.options.charkey]=E[P.options.charkey],delete E[P.options.charkey]),Object.getOwnPropertyNames(E).length>0&&(o[P.options.childkey]=E),E=o;else if(m){m[P.options.childkey]=m[P.options.childkey]||[],p={};for(a in E)!S.call(E,a)||(p[a]=E[a]);m[P.options.childkey].push(p),delete E["#name"],Object.keys(E).length===1&&w in E&&!P.EXPLICIT_CHARKEY&&(E=E[w])}}return L.length>0?P.assignOrPush(m,y,E):(P.options.explicitRoot&&(N=E,E={},E[y]=N),P.resultObject=E,P.saxParser.ended=!0,P.emit("end",P.resultObject))}}(this),C=function(P){return function(R){var g,a;if(a=L[L.length-1],a)return a[w]+=R,P.options.explicitChildren&&P.options.preserveChildrenOrder&&P.options.charsAsChildren&&(P.options.includeWhiteChars||R.replace(/\\n/g,"").trim()!=="")&&(a[P.options.childkey]=a[P.options.childkey]||[],g={"#name":"__text__"},g[w]=R,P.options.normalize&&(g[w]=g[w].replace(/\s{2,}/g," ").trim()),a[P.options.childkey].push(g)),a}}(this),this.saxParser.ontext=C,this.saxParser.oncdata=function(P){return function(R){var g;if(g=C(R),g)return g.cdata=!0}}(this)},v.prototype.parseString=function(h,w){var C;w!=null&&typeof w=="function"&&(this.on("end",function(L){return this.reset(),w(null,L)}),this.on("error",function(L){return this.reset(),w(L)}));try{return h=h.toString(),h.trim()===""?(this.emit("end",null),!0):(h=r.stripBOM(h),this.options.async?(this.remaining=h,f(this.processAsync),this.saxParser):this.saxParser.write(h).close())}catch(L){if(C=L,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw C}else return this.emit("error",C),this.saxParser.errThrown=!0}},v.prototype.parseStringPromise=function(h){return new Promise(function(w){return function(C,L){return w.parseString(h,function(P,R){return P?L(P):C(R)})}}(this))},v}(e),Lt.parseString=function(b,v,h){var w,C,L;return h!=null?(typeof h=="function"&&(w=h),typeof v=="object"&&(C=v)):(typeof v=="function"&&(w=v),C={}),L=new Lt.Parser(C),L.parseString(b,w)},Lt.parseStringPromise=function(b,v){var h,w;return typeof v=="object"&&(h=v),w=new Lt.Parser(h),w.parseStringPromise(b)}}).call(Lt)});var Tn=X(xt=>{(function(){"use strict";var r,t,e,i,n=function(l,f){for(var d in f)c.call(f,d)&&(l[d]=f[d]);function T(){this.constructor=l}return T.prototype=f.prototype,l.prototype=new T,l.__super__=f.prototype,l},c={}.hasOwnProperty;t=Se(),r=gn(),e=vn(),i=hr(),xt.defaults=t.defaults,xt.processors=i,xt.ValidationError=function(l){n(f,l);function f(d){this.message=d}return f}(Error),xt.Builder=r.Builder,xt.Parser=e.Parser,xt.parseString=e.parseString,xt.parseStringPromise=e.parseStringPromise}).call(xt)});var te=X(Ot=>{"use strict";var Mo=Ot&&Ot.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.parseSOAPString=Ot.guid=Ot.linerase=void 0;var Lo=Mo(Tn()),xo=/^-?([1-9]\d*|0)(\.\d*)?$/,Fo=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d+)?Z$/,Ro=/(?!xmlns)^.*:/;function de(r){if(Array.isArray(r)){if(r.length>1)return r.map(de);[r]=r}if(typeof r=="object"){let t={};return Object.keys(r).forEach(e=>{e==="$"?t={...t,...de(r.$)}:t[e]=de(r[e])}),t}return r==="true"?!0:r==="false"?!1:xo.test(r)?parseFloat(r):Fo.test(r)?new Date(r):r}Ot.linerase=de;function jt(){return((1+Math.random())*65536|0).toString(16).substring(1)}function qo(){return`${jt()+jt()}-${jt()}-${jt()}-${jt()}-${jt()}${jt()}${jt()}`}Ot.guid=qo;async function jo(r){let t=r.replace(/xmlns([^=]*?)=(".*?")/g,""),e=await Lo.default.parseStringPromise(t,{tagNameProcessors:[i=>{let n=i.replace(Ro,""),c=n.charAt(1);return c&&c.toUpperCase()!==c?n.charAt(0).toLowerCase()+n.slice(1):n}]});if(!e||!e.envelope||!e.envelope.body)throw new Error("Wrong ONVIF SOAP response");if(e.envelope.body[0].fault){let i=e.envelope.body[0].fault[0],n;try{i.reason[0].text[0]._&&(n=i.reason[0].text[0]._)}catch{n=""}if(!n)try{n=JSON.stringify(de(i.code[0]))}catch{n=""}let c;try{[c]=i.detail[0].text}catch{c=""}throw new Error(`ONVIF SOAP Fault: ${n}${c}`)}return[e.envelope.body,t]}Ot.parseSOAPString=jo});var pr=X(_t=>{"use strict";var V=_t&&_t.__classPrivateFieldGet||function(r,t,e,i){if(e==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(r):i?i.value:t.get(r)},Ft=_t&&_t.__classPrivateFieldSet||function(r,t,e,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(r,e):n?n.value=e:t.set(r,e),e},$o=_t&&_t.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},ee,It,Vt,ut,dt,re;Object.defineProperty(_t,"__esModule",{value:!0});_t.Device=void 0;var Bo=$o(require("url")),Ct=te(),fr=class{constructor(t){ee.set(this,[]),this.media2Support=!1,It.set(this,[]),Vt.set(this,{}),ut.set(this,void 0),dt.set(this,void 0),re.set(this,void 0),this.onvif=t}get services(){return V(this,ee,"f")}get scopes(){return V(this,It,"f")}get serviceCapabilities(){return V(this,Vt,"f")}get NTP(){return V(this,ut,"f")}get DNS(){return V(this,ut,"f")}get newtworkInterfaces(){return V(this,re,"f")}getSystemDateAndTime(){return this.onvif.getSystemDateAndTime()}setSystemDateAndTime(t){return this.onvif.setSystemDateAndTime(t)}async getServices(t=!0){let[e]=await this.onvif.request({body:`<GetServices xmlns="http://www.onvif.org/ver10/device/wsdl"><IncludeCapability>${t}</IncludeCapability></GetServices>`});return Ft(this,ee,(0,Ct.linerase)(e).getServicesResponse.service,"f"),V(this,ee,"f").forEach(i=>{if(Object.prototype.hasOwnProperty.call(i,"namespace")&&Object.prototype.hasOwnProperty.call(i,"XAddr")){let n=Bo.default.parse(i.namespace);if(n.hostname==="www.onvif.org"&&n.path){let c=n.path.substring(1).split("/");c[1]==="media"&&c[0]==="ver20"?(this.media2Support=!0,c[1]="media2"):c[1]==="ptz"&&(c[1]="PTZ"),this.onvif.uri[c[1]]=this.onvif.parseUrl(i.XAddr)}}}),V(this,ee,"f")}async getCapabilities(){let[t]=await this.onvif.request({body:'<GetCapabilities xmlns="http://www.onvif.org/ver10/device/wsdl"><Category>All</Category></GetCapabilities>'});if(this.onvif.capabilities=(0,Ct.linerase)(t[0].getCapabilitiesResponse[0].capabilities[0]),["PTZ","media","imaging","events","device"].forEach(e=>{let i=e;"XAddr"in this.onvif.capabilities[i]&&(this.onvif.uri[e]=this.onvif.parseUrl(this.onvif.capabilities[i].XAddr))}),this.onvif.capabilities.extension&&(Object.keys(this.onvif.capabilities.extension).forEach(e=>{let i=e;i!=="XAddr"&&"XAddr"in this.onvif.capabilities.extension[i]&&(this.onvif.uri[i]=new URL(this.onvif.capabilities.extension[i].XAddr))}),this.onvif.uri.replay&&!this.onvif.uri.recording)){let e=this.onvif.uri.replay.href.replace("replay","recording");this.onvif.emit("warn",`Adding ${e} for bad Profile G device`),this.onvif.uri.recording=new URL(e)}return this.onvif.capabilities}async getDeviceInformation(){let[t]=await this.onvif.request({body:'<GetDeviceInformation xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return this.onvif.deviceInformation=(0,Ct.linerase)(t).getDeviceInformationResponse,this.onvif.deviceInformation}async getHostname(){let[t]=await this.onvif.request({body:'<GetHostname xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return(0,Ct.linerase)(t).getHostnameResponse.hostnameInformation}async getScopes(){let[t]=await this.onvif.request({body:'<GetScopes xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return Ft(this,It,(0,Ct.linerase)(t).getScopesResponse.scopes,"f"),V(this,It,"f")===void 0?Ft(this,It,[],"f"):Array.isArray(V(this,It,"f"))||Ft(this,It,[V(this,It,"f")],"f"),V(this,It,"f")}async setScopes(t){let[e]=await this.onvif.request({body:`<SetScopes xmlns="http://www.onvif.org/ver10/device/wsdl">${t.map(i=>`<Scopes>${i}</Scopes>`).join("")}</SetScopes>`});if((0,Ct.linerase)(e).setScopesResponse!=="")throw new Error("Wrong `SetScopes` response");return this.getScopes()}async getServiceCapabilities(){let[t]=await this.onvif.request({body:'<GetServiceCapabilities xmlns="http://www.onvif.org/ver10/device/wsdl" />'}),e=(0,Ct.linerase)(t);return Ft(this,Vt,{network:e.getServiceCapabilitiesResponse.capabilities.network,security:e.getServiceCapabilitiesResponse.capabilities.security,system:e.getServiceCapabilitiesResponse.capabilities.system},"f"),e.getServiceCapabilitiesResponse.capabilities.misc&&(V(this,Vt,"f").misc=e.getServiceCapabilitiesResponse.capabilities.misc,V(this,Vt,"f").auxiliaryCommands=e.getServiceCapabilitiesResponse.capabilities.misc.AuxiliaryCommands.split(" ")),V(this,Vt,"f")}async systemReboot(){return this.onvif.request({service:"device",body:'<SystemReboot xmlns="http://www.onvif.org/ver10/device/wsdl"/>'}).then(([t])=>t[0].systemRebootResponse[0].message[0])}async getNTP(){let[t]=await this.onvif.request({service:"device",body:'<GetNTP xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return Ft(this,ut,(0,Ct.linerase)(t[0].getNTPResponse[0].NTPInformation[0]),"f"),V(this,ut,"f")?.NTPManual&&!Array.isArray(V(this,ut,"f").NTPManual)&&(V(this,ut,"f").NTPManual=[V(this,ut,"f").NTPManual]),V(this,ut,"f")?.NTPFromDHCP&&!Array.isArray(V(this,ut,"f").NTPFromDHCP)&&(V(this,ut,"f").NTPFromDHCP=[V(this,ut,"f").NTPFromDHCP]),V(this,ut,"f")}async getDNS(){let[t]=await this.onvif.request({service:"device",body:'<GetDNS xmlns="http://www.onvif.org/ver10/device/wsdl"/>'});return Ft(this,dt,(0,Ct.linerase)(t[0].getDNSResponse[0].DNSInformation),"f"),V(this,dt,"f")?.DNSManual&&!Array.isArray(V(this,dt,"f").DNSManual)&&(V(this,dt,"f").DNSManual=[V(this,dt,"f").DNSManual]),V(this,dt,"f")?.DNSFromDHCP&&!Array.isArray(V(this,dt,"f").DNSFromDHCP)&&(V(this,dt,"f").DNSFromDHCP=[V(this,dt,"f").DNSFromDHCP]),V(this,dt,"f")}async getNetworkInterfaces(){let[t]=await this.onvif.request({service:"device",body:'<GetNetworkInterfaces xmlns="http://www.onvif.org/ver10/device/wsdl"/>'}),e=(0,Ct.linerase)(t[0].getNetworkInterfacesResponse[0].networkInterfaces);return Array.isArray(e)?Ft(this,re,e,"f"):Ft(this,re,[e],"f"),V(this,re,"f")}};_t.Device=fr;ee=new WeakMap,It=new WeakMap,Vt=new WeakMap,ut=new WeakMap,dt=new WeakMap,re=new WeakMap});var mr=X(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.Media=void 0;var zt=te(),dr=class{constructor(t){this.profiles=[],this.videoSources=[],this.onvif=t}async getProfiles(){if(this.onvif.device.media2Support){let[e]=await this.onvif.request({service:"media2",body:'<GetProfiles xmlns="http://www.onvif.org/ver20/media/wsdl"><Type>All</Type></GetProfiles>'});return this.profiles=e[0].getProfilesResponse[0].profiles.map(i=>{let n=(0,zt.linerase)(i),c={token:n.token,name:n.name,fixed:n.fixed||!1};return n.configurations.videoSource&&(c.videoSourceConfiguration=n.configurations.videoSource),n.configurations.audioSource&&(c.audioSourceConfiguration=n.configurations.audioSource),n.configurations.videoEncoder&&(c.videoEncoderConfiguration=n.configurations.videoEncoder),n.configurations.audioEncoder&&(c.audioEncoderConfiguration=n.configurations.audioEncoder),n.configurations.PTZ&&(c.PTZConfiguration=n.configurations.PTZ),n.configurations.analytics&&(c.videoAnalyticsConfiguration=n.configurations.analytics),n.configurations.metadata&&(c.metadataConfiguration=n.configurations.metadata),(n.configurations.audioOutput||n.configurations.audioDecoder)&&(c.extension={audioOutputConfiguration:n.configurations.audioOutput,audioDecoderConfiguration:n.configurations.audioDecoder}),c}),this.profiles}let[t]=await this.onvif.request({service:"media",body:'<GetProfiles xmlns="http://www.onvif.org/ver10/media/wsdl"/>'});return this.profiles=t[0].getProfilesResponse[0].profiles.map(zt.linerase),this.profiles}async getVideoSources(){let[t]=await this.onvif.request({service:"media",body:'<GetVideoSources xmlns="http://www.onvif.org/ver10/media/wsdl"/>'});return this.videoSources=(0,zt.linerase)(t).getVideoSourcesResponse.videoSources,Array.isArray(this.videoSources)||(this.videoSources=[this.videoSources]),this.videoSources}async getStreamUri(t={}){let{profileToken:e,stream:i="RTP-Unicast"}=t,{protocol:n="RTSP"}=t;if(this.onvif.device.media2Support){n==="HTTP"&&(n="RtspOverHttp"),n==="TCP"&&(n="RTSP"),n==="UDP"&&i==="RTP-Unicast"&&(n="RtspUnicast"),n==="UDP"&&i==="RTP-Multicast"&&(n="RtspMulticast");let[l]=await this.onvif.request({service:"media2",body:`<GetStreamUri xmlns="http://www.onvif.org/ver20/media/wsdl"><Protocol>${n}</Protocol><ProfileToken>${e||this.onvif.activeSource.profileToken}</ProfileToken></GetStreamUri>`});return(0,zt.linerase)(l).getStreamUriResponse}let[c]=await this.onvif.request({service:"media",body:`<GetStreamUri xmlns="http://www.onvif.org/ver10/media/wsdl"><StreamSetup><Stream xmlns="http://www.onvif.org/ver10/schema">${i}</Stream><Transport xmlns="http://www.onvif.org/ver10/schema"><Protocol>${n||"RTSP"}</Protocol></Transport></StreamSetup><ProfileToken>${e||this.onvif.activeSource.profileToken}</ProfileToken></GetStreamUri>`});return(0,zt.linerase)(c).getStreamUriResponse.mediaUri}async getSnapshotUri({profileToken:t}={}){if(this.onvif.device.media2Support){let[i]=await this.onvif.request({service:"media2",body:`<GetSnapshotUri xmlns="http://www.onvif.org/ver20/media/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken></GetSnapshotUri>`});return(0,zt.linerase)(i).getSnapshotUriResponse}let[e]=await this.onvif.request({service:"media",body:`<GetSnapshotUri xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken></GetSnapshotUri>`});return(0,zt.linerase)(e).getSnapshotUriResponse.mediaUri}};Be.Media=dr});var yr=X($t=>{"use strict";var Tt=$t&&$t.__classPrivateFieldGet||function(r,t,e,i){if(e==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(r):i?i.value:t.get(r)},gr=$t&&$t.__classPrivateFieldSet||function(r,t,e,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(r,e):n?n.value=e:t.set(r,e),e},ie,Ht,Wt;Object.defineProperty($t,"__esModule",{value:!0});$t.PTZ=void 0;var Gt=te(),mt=class{constructor(t){ie.set(this,{}),Ht.set(this,{}),Wt.set(this,{}),this.onvif=t}get nodes(){return Tt(this,ie,"f")}get configurations(){return Tt(this,Ht,"f")}get presets(){return Tt(this,Wt,"f")}async getNodes(){let[t]=await this.onvif.request({service:"PTZ",body:'<GetNodes xmlns="http://www.onvif.org/ver20/ptz/wsdl" />'});return gr(this,ie,{},"f"),t[0].getNodesResponse.forEach(e=>{let i=(0,Gt.linerase)(e.PTZNode[0]);Tt(this,ie,"f")[i.token]=i}),Tt(this,ie,"f")}async getConfigurations(){let[t]=await this.onvif.request({service:"PTZ",body:'<GetConfigurations xmlns="http://www.onvif.org/ver20/ptz/wsdl"></GetConfigurations>'});return gr(this,Ht,{},"f"),Array.isArray(t[0].getConfigurationsResponse[0].PTZConfiguration)?(t[0].getConfigurationsResponse[0].PTZConfiguration.forEach(e=>{let i=(0,Gt.linerase)(e);Tt(this,Ht,"f")[i.token]=i}),Tt(this,Ht,"f")):Tt(this,Ht,"f")}async getConfigurationOptions({configurationToken:t}){let[e]=await this.onvif.request({service:"PTZ",body:`<GetConfigurationOptions xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ConfigurationToken>${t}</ConfigurationToken></GetConfigurationOptions>`});return(0,Gt.linerase)(e)}async getPresets({profileToken:t}={}){let[e]=await this.onvif.request({service:"PTZ",body:`<GetPresets xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken></GetPresets>`});gr(this,Wt,{},"f");let i=(0,Gt.linerase)(e[0].getPresetsResponse[0].preset);return Array.isArray(i)?(0,Gt.linerase)(i).forEach(n=>Tt(this,Wt,"f")[n.token]=n):Tt(this,Wt,"f")[i.token]=i,Tt(this,Wt,"f")}static formatPTZSimpleVector({pan:t,tilt:e,x:i,y:n,zoom:c}={x:0,y:0,zoom:0}){return{panTilt:{x:t||i,y:e||n},zoom:{x:c}}}static PTZVectorToXML(t){let e="x"in t||"pan"in t?mt.formatPTZSimpleVector(t):t;return(e.panTilt?`<PanTilt x="${e.panTilt.x}" y="${e.panTilt.y}" xmlns="http://www.onvif.org/ver10/schema"/>`:"")+(e.zoom?`<Zoom x="${e.zoom.x}" xmlns="http://www.onvif.org/ver10/schema"/>`:"")}async gotoPreset({profileToken:t,presetToken:e,speed:i}){await this.onvif.request({service:"PTZ",body:`<GotoPreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t||this.onvif.activeSource.profileToken}</ProfileToken><PresetToken>${e}</PresetToken>${i?`<Speed>${mt.PTZVectorToXML(i)}</Speed>`:""}</GotoPreset>`})}async setPreset({profileToken:t,presetName:e,presetToken:i}){let[n]=await this.onvif.request({service:"PTZ",body:`<SetPreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t??this.onvif.activeSource.profileToken}</ProfileToken><PresetName>${e}</PresetName>${i?`<PresetToken>${i}</PresetToken>`:""}</SetPreset>`});return(0,Gt.linerase)(n[0].setPresetResponse)}async removePreset({profileToken:t=this.onvif.activeSource?.profileToken,presetToken:e}){await this.onvif.request({service:"PTZ",body:`<RemovePreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><PresetToken>${e}</PresetToken></RemovePreset>`})}async gotoHomePosition({profileToken:t=this.onvif.activeSource?.profileToken,speed:e}){await this.onvif.request({service:"PTZ",body:`<GotoHomePosition xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken>${e?`<Speed>${mt.PTZVectorToXML(e)}</Speed>`:""}</GotoHomePosition>`})}async setHomePosition({profileToken:t=this.onvif.activeSource?.profileToken}){await this.onvif.request({service:"PTZ",body:`<SetHomePosition xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken></SetHomePosition>`})}async getStatus({profileToken:t=this.onvif.activeSource?.profileToken}={}){let[e]=await this.onvif.request({service:"PTZ",body:`<GetStatus xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken></GetStatus>`});return(0,Gt.linerase)(e).getStatusResponse.PTZStatus}async absoluteMove({profileToken:t=this.onvif.activeSource?.profileToken,position:e,speed:i}){await this.onvif.request({service:"PTZ",body:`<AbsoluteMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><Position>${mt.PTZVectorToXML(e)}</Position>${i?`<Speed>${mt.PTZVectorToXML(i)}</Speed>`:""}</AbsoluteMove>`})}async relativeMove({profileToken:t=this.onvif.activeSource?.profileToken,translation:e,speed:i}){await this.onvif.request({service:"PTZ",body:`<RelativeMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><Translation>${mt.PTZVectorToXML(e)}</Translation>${i?`<Speed>${mt.PTZVectorToXML(i)}</Speed>`:""}</RelativeMove>`})}async continuousMove({profileToken:t=this.onvif.activeSource?.profileToken,velocity:e,timeout:i}){await this.onvif.request({service:"PTZ",body:`<ContinuousMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${t}</ProfileToken><Velocity>${mt.PTZVectorToXML(e)}</Velocity>${i?`<Timeout>${typeof i=="number"?`PT${i/1e3}S`:i}</Timeout>`:""}</ContinuousMove>`})}async stop(t){let e=t?.profileToken||this.onvif?.activeSource?.profileToken,i=t?.panTilt??!0,n=t?.zoom??!0;await this.onvif.request({service:"PTZ",body:`<Stop xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>${e}</ProfileToken><PanTilt>${i}</PanTilt><Zoom>${n}</Zoom></Stop>`})}};$t.PTZ=mt;ie=new WeakMap,Ht=new WeakMap,Wt=new WeakMap});var Ue=X(oe=>{"use strict";var wr=oe&&oe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(oe,"__esModule",{value:!0});oe.Onvif=void 0;var Xo=require("events"),Uo=wr(require("https")),ko=wr(require("http")),ne=require("buffer"),Vo=wr(require("crypto")),Xe=te(),zo=pr(),Go=mr(),Ho=yr(),Yt=class extends Xo.EventEmitter{constructor(t){super(),this.preserveAddress=!1,this.defaultProfiles=[],this.activeSources=[],this.useSecure=t.useSecure??!1,this.secureOptions=t.secureOptions??{},this.hostname=t.hostname,this.username=t.username,this.password=t.password,this.port=t.port??(t.useSecure?443:80),this.path=t.path??"/onvif/device_service",this.timeout=t.timeout||12e4,this.urn=t.urn,this.agent=t.agent??!1,this.preserveAddress=t.preserveAddress??!1,this.events={},this.uri={},this.capabilities={},this.device=new zo.Device(this),this.media=new Go.Media(this),this.ptz=new Ho.PTZ(this),this.on("newListener",e=>{e==="event"&&this.listeners(e).length===0&&setImmediate(()=>{})}),t.autoConnect&&setImmediate(()=>{this.connect().catch(e=>this.emit("error",e))})}envelopeHeader(t=!1){let e='<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing"><s:Header>';if(this.username&&this.password){let i=this.passwordDigest();e+=`<Security s:mustUnderstand="1" xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"><UsernameToken><Username>${this.username}</Username><Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest">${i.passDigest}</Password><Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">${i.nonce}</Nonce><Created xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">${i.timestamp}</Created></UsernameToken></Security>`}return t!==void 0&&t||(e+='</s:Header><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">'),e}envelopeFooter(){return"</s:Body></s:Envelope>"}passwordDigest(){let t=new Date(process.uptime()*1e3+(this.timeShift||0)).toISOString(),e=ne.Buffer.allocUnsafe(16);e.writeUIntLE(Math.ceil(Math.random()*4294967296),0,4),e.writeUIntLE(Math.ceil(Math.random()*4294967296),4,4),e.writeUIntLE(Math.ceil(Math.random()*4294967296),8,4),e.writeUIntLE(Math.ceil(Math.random()*4294967296),12,4);let i=Vo.default.createHash("sha1");return i.update(ne.Buffer.concat([e,ne.Buffer.from(t,"ascii"),ne.Buffer.from(this.password,"ascii")])),{passDigest:i.digest("base64"),nonce:e.toString("base64"),timestamp:t}}setupSystemDateAndTime(t){let e=t[0].getSystemDateAndTimeResponse[0].systemDateAndTime[0],i=e.UTCDateTime||e.localDateTime,n;if(i===void 0)n=new Date;else{let c=(0,Xe.linerase)(i[0]);n=new Date(Date.UTC(c.date.year,c.date.month-1,c.date.day,c.time.hour,c.time.minute,c.time.second))}return this.timeShift||(this.timeShift=n.getTime()-process.uptime()*1e3),n}async rawRequest(t){return new Promise((e,i)=>{let n=!1,c={...t,hostname:this.hostname,path:t.service?this.uri[t.service]?this.uri[t.service]?.pathname:t.service:this.path,port:this.port,agent:this.agent,timeout:this.timeout};c.headers={"Content-Type":"application/soap+xml","Content-Length":ne.Buffer.byteLength(t.body,"utf8"),charset:"utf-8"},c.method="POST";let l=this.useSecure?Uo.default:ko.default;this.useSecure&&Object.assign(c,this.secureOptions);let f=l.request(c,d=>{let T=[],S=0;d.on("data",b=>{T.push(b),S+=b.length}),d.on("end",()=>{if(n)return;n=!0;let b=ne.Buffer.concat(T,S).toString("utf8");this.emit("rawResponse",b),e((0,Xe.parseSOAPString)(b))})});f.setTimeout(this.timeout,()=>{n||(n=!0,f.destroy(),i(new Error("Network timeout")))}),f.on("error",d=>{n||(n=!0,d.code==="ECONNREFUSED"&&d.errno==="ECONNREFUSED"&&d.syscall==="connect"||d.code==="ECONNRESET"&&d.errno==="ECONNRESET"&&d.syscall,i(d))}),this.emit("rawRequest",t.body),f.write(t.body),f.end()})}request(t){if(!t.body)throw new Error("There is no 'body' field in request options");return this.rawRequest({...t,body:`${this.envelopeHeader()}${t.body}${this.envelopeFooter()}`})}parseUrl(t){let e=new URL(t);return this.preserveAddress&&(this.hostname!==e.hostname||this.port.toString()!==e.port)&&(e.hostname=this.hostname,e.host=`${this.hostname}:${this.port}`,e.port=this.port.toString(),e.href=e.toString()),e}async getSystemDateAndTime(){let[t,e]=await this.rawRequest({body:'<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><GetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"/></s:Body></s:Envelope>'});try{return this.setupSystemDateAndTime(t)}catch(i){if(e&&e.toLowerCase().includes("sender not authorized")){let[n]=await this.request({body:'<GetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"/>}'});return this.setupSystemDateAndTime(n)}throw i}}async setSystemDateAndTime(t){if(!["Manual","NTP"].includes(t.dateTimeType))throw new Error("DateTimeType should be `Manual` or `NTP`");let[e]=await this.request({body:`<SetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"><DateTimeType>${t.dateTimeType}</DateTimeType><DaylightSavings>${!!t.daylightSavings}</DaylightSavings>${t.timezone!==void 0?`<TimeZone><TZ xmlns="http://www.onvif.org/ver10/schema">${t.timezone}</TZ></TimeZone>`:""}${t.dateTime!==void 0&&t.dateTime instanceof Date?`<UTCDateTime><Time xmlns="http://www.onvif.org/ver10/schema"><Hour>${t.dateTime.getUTCHours()}</Hour><Minute>${t.dateTime.getUTCMinutes()}</Minute><Second>${t.dateTime.getUTCSeconds()}</Second></Time><Date xmlns="http://www.onvif.org/ver10/schema"><Year>${t.dateTime.getUTCFullYear()}</Year><Month>${t.dateTime.getUTCMonth()+1}</Month><Day>${t.dateTime.getUTCDate()}</Day></Date></UTCDateTime>`:""}</SetSystemDateAndTime>`});if((0,Xe.linerase)(e).setSystemDateAndTimeResponse!=="")throw new Error(`Wrong 'SetSystemDateAndTime' response: '${(0,Xe.linerase)(e).setSystemDateAndTimeResponse}'`);return this.getSystemDateAndTime()}async getActiveSources(){this.media.videoSources.forEach((t,e)=>{let i=t.token,n=this.media.profiles.filter(c=>(c.videoSourceConfiguration?c.videoSourceConfiguration.sourceToken===i:!1)&&c.videoEncoderConfiguration!==void 0);if(n.length===0){if(e===0)throw new Error("Unrecognized configuration");return}if(e===0&&([this.defaultProfile]=n),[this.defaultProfiles[e]]=n,this.activeSources[e]={sourceToken:t.token,profileToken:this.defaultProfiles[e].token,videoSourceConfigurationToken:this.defaultProfiles[e].videoSourceConfiguration.token},this.defaultProfiles[e].videoEncoderConfiguration){let c=this.defaultProfiles[e].videoEncoderConfiguration;this.activeSources[e].encoding=c?.encoding,this.activeSources[e].width=c?.resolution.width,this.activeSources[e].height=c?.resolution.height,this.activeSources[e].fps=c?.rateControl?.frameRateLimit,this.activeSources[e].bitrate=c?.rateControl?.bitrateLimit}e===0&&(this.activeSource=this.activeSources[e]),this.defaultProfiles[e].PTZConfiguration&&(this.activeSources[e].ptz={name:this.defaultProfiles[e].PTZConfiguration.name,token:this.defaultProfiles[e].PTZConfiguration.token})})}async connect(){await this.getSystemDateAndTime();try{await this.device.getServices()}catch{await this.device.getCapabilities()}return await Promise.all([this.media.getProfiles(),this.media.getVideoSources()]),await this.getActiveSources(),this.emit("connect"),this}};oe.Onvif=Yt;Yt.rawRequest="rawRequest";Yt.rawResponse="rawResponse";Yt.warn="warn";Yt.error="error"});var Dn=X(Bt=>{"use strict";var bn=Bt&&Bt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.Discovery=Bt.DiscoverySingleton=void 0;var Wo=require("events"),Yo=require("dgram"),Zo=bn(require("url")),Ko=bn(require("os")),vr=te(),Qo=Ue();function Jo(r,t){return r.filter(i=>i.hostname===t)[0]||r[0]}var bt=class extends Wo.EventEmitter{constructor(){super()}static get getInstance(){return bt.instance||(bt.instance=new bt),bt.instance}probe(t){return new Promise((e,i)=>{let n=new Map,c=[],l=`urn:uuid:${t.messageId||(0,vr.guid)()}`,f=Buffer.from(`<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope" xmlns:dn="http://www.onvif.org/ver10/network/wsdl"><Header><wsa:MessageID xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">${l}</wsa:MessageID><wsa:To xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">urn:schemas-xmlsoap-org:ws:2005:04:discovery</wsa:To><wsa:Action xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">http://schemas.xmlsoap.org/ws/2005/04/discovery/Probe</wsa:Action></Header><Body><Probe xmlns="http://schemas.xmlsoap.org/ws/2005/04/discovery" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><Types>dn:NetworkVideoTransmitter</Types><Scopes /></Probe></Body></Envelope>`),d=(0,Yo.createSocket)(t.type??"udp4");d.on("error",S=>{this.emit("error",S)});let T=async(S,b)=>{let v,h;try{[v,h]=await(0,vr.parseSOAPString)(S.toString())}catch(w){c.push(w),this.emit("error",w,h);return}if(!v[0].probeMatches)c.push(new Error(`Wrong SOAP message from ${b.address}:${b.port}
${h}`)),this.emit("error",`Wrong SOAP message from ${b.address}:${b.port}`,h);else{v=(0,vr.linerase)(v);let w=v.probeMatches.probeMatch.endpointReference.address;if(!n.has(w)){let C;if(t.resolve!==!1){let L=v.probeMatches.probeMatch.XAddrs.split(" ").map(Zo.default.parse),P=Jo(L,b.address);C=new Qo.Onvif({hostname:P.hostname,port:parseInt(P.port,10),path:P.pathname,urn:w})}else C=v;n.set(w,C),this.emit("device",C,b,h)}}};if(t.device){let S=Ko.default.networkInterfaces();t.device in S&&S[t.device]?.forEach(b=>{b.family==="IPv4"&&d.bind(t.listeningPort,b.address)})}d.on("message",T),d.send(f,0,f.length,3702,"239.255.255.250"),setTimeout(()=>{d.removeListener("message",T),d.close(),c.length===0?e(Array.from(n.values())):i(c)},t.timeout||5e3)})}};Bt.DiscoverySingleton=bt;bt.device="device";bt.error="error";Bt.Discovery=bt.getInstance});var En=X(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.Cam=void 0;var ts=require("events"),es=Ue(),Tr=class extends ts.EventEmitter{constructor(t,e){super(),this.onvif=new es.Onvif({...t,autoConnect:e!==void 0?!1:t.autoconnect}),e&&this.onvif.connect().then(i=>e(null,i)).catch(e)}get port(){return this.onvif.port}get path(){return this.onvif.path}set hostname(t){this.onvif.hostname=t}set timeout(t){this.onvif.timeout=t}get timeout(){return this.onvif.timeout}get services(){return this.onvif.device.services}get capabilities(){return this.onvif.capabilities}get uri(){return this.onvif.uri}get videoSources(){return this.onvif.media.videoSources}get profiles(){return this.onvif.media.profiles}get defaultProfile(){return this.onvif.defaultProfile}get defaultProfiles(){return this.onvif.defaultProfiles}get activeSource(){return this.onvif.activeSource}get serviceCapabilities(){return this.onvif.device.serviceCapabilities}get deviceInformation(){return this.onvif.deviceInformation}get nodes(){return this.onvif.ptz.nodes}get configurations(){return this.onvif.ptz.configurations}get presets(){return Object.fromEntries(Object.values(this.onvif.ptz.presets).map(t=>[t.name,t.token]))}connect(t){this.onvif.connect().then(e=>t(null,e)).catch(t)}_request(t,e){if(typeof e!="function")throw new Error("`callback` must be a function");this.onvif.request(t).then(i=>e(null,i)).catch(e)}getSystemDateAndTime(t){this.onvif.device.getSystemDateAndTime().then(e=>t(null,e)).catch(t)}setSystemDateAndTime(t,e){this.onvif.device.setSystemDateAndTime(t).then(i=>e(null,i)).catch(e)}getHostname(t){this.onvif.device.getHostname().then(e=>t(null,e)).catch(t)}getScopes(t){this.onvif.device.getScopes().then(e=>t(null,e)).catch(t)}setScopes(t,e){this.onvif.device.setScopes(t).then(i=>e(null,i)).catch(e)}getCapabilities(t){this.onvif.device.getCapabilities().then(e=>t(null,e)).catch(t)}getServiceCapabilities(t){this.onvif.device.getServiceCapabilities().then(e=>t(null,e)).catch(t)}getActiveSources(t){this.onvif.getActiveSources().then(e=>t(null,e)).catch(t)}getVideoSources(t){this.onvif.media.getVideoSources().then(e=>t(null,e)).catch(t)}getServices(t,e){this.onvif.device.getServices(t).then(i=>e(null,i)).catch(e)}getDeviceInformation(t){this.onvif.device.getDeviceInformation().then(e=>t(null,e)).catch(t)}getStreamUri(t,e){e&&this.onvif.media.getStreamUri(t).then(i=>e(null,i)).catch(e),this.onvif.media.getStreamUri().then(i=>t(null,i)).catch(t)}getSnapshotUri(t,e){e&&this.onvif.media.getSnapshotUri(t).then(i=>e(null,i)).catch(e),this.onvif.media.getSnapshotUri().then(i=>t(null,i)).catch(t)}getNodes(t){this.onvif.ptz.getNodes().then(e=>t(null,e)).catch(t)}getConfigurations(t){this.onvif.ptz.getConfigurations().then(e=>t(null,e)).catch(t)}getConfigurationOptions(t,e){this.onvif.ptz.getConfigurationOptions({configurationToken:t}).then(i=>e(null,i)).catch(e)}systemReboot(t){this.onvif.device.systemReboot().then(e=>t(null,e)).catch(t)}getPresets(t,e){e&&this.onvif.ptz.getPresets(t).then(i=>e(null,Object.fromEntries(Object.values(i).map(n=>[n.name,n.token])))).catch(e),this.onvif.ptz.getPresets().then(i=>t(null,Object.fromEntries(Object.values(i).map(n=>[n.name,n.token])))).catch(t)}gotoPreset(t,e){this.onvif.ptz.gotoPreset(t).then(i=>e(null,i)).catch(e)}setPreset(t,e){this.onvif.ptz.setPreset(t).then(i=>e(null,i)).catch(e)}removePreset(t,e){this.onvif.ptz.removePreset(t).then(i=>e(null,i)).catch(e)}gotoHomePosition(t,e){this.onvif.ptz.gotoHomePosition(t).then(i=>e(null,i)).catch(e)}setHomePosition(t,e){this.onvif.ptz.setHomePosition(t).then(i=>e(null,i)).catch(e)}getStatus(t,e){e&&this.onvif.ptz.getStatus(t).then(i=>e(null,i)).catch(e),this.onvif.ptz.getStatus().then(i=>t(null,i)).catch(t)}absoluteMove(t,e){let i={...t,position:{panTilt:{x:t.x,y:t.y},zoom:{x:t.zoom}}};e?this.onvif.ptz.absoluteMove(i).then(n=>e(null,n)).catch(e):this.onvif.ptz.absoluteMove(i).catch(n=>this.emit("error",n))}relativeMove(t,e){let i={...t,translation:{panTilt:{x:t.x,y:t.y},zoom:{x:t.zoom}}};e?this.onvif.ptz.relativeMove(i).then(n=>e(null,n)).catch(e):this.onvif.ptz.relativeMove(i).catch(n=>this.emit("error",n))}continuousMove(t,e){let i={...t,velocity:{...t.x&&t.y&&!t.onlySendZoom&&{panTilt:{x:t.x,y:t.y}},...t.zoom&&!t.onlySendPanTilt&&{zoom:{x:t.zoom}}}};e?this.onvif.ptz.continuousMove(i).then(n=>e(null,n)).catch(e):this.onvif.ptz.continuousMove(i).catch(n=>this.emit("error",n))}stop(t,e){e&&this.onvif.ptz.stop(t).then(i=>e(null,i)).catch(e),this.onvif.ptz.stop().then(i=>{typeof t=="function"&&t(null,i)}).catch(t||(i=>this.emit("error",i)))}getNTP(t){this.onvif.device.getNTP().then(e=>t(null,e)).catch(t)}getDNS(t){this.onvif.device.getDNS().then(e=>t(null,e)).catch(t)}getNetworkInterfaces(t){this.onvif.device.getNetworkInterfaces().then(e=>t(null,e)).catch(t)}};ke.Cam=Tr});var Sn=X(gt=>{"use strict";var rs=gt&&gt.__createBinding||(Object.create?function(r,t,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,i,n)}:function(r,t,e,i){i===void 0&&(i=e),r[i]=t[e]}),se=gt&&gt.__exportStar||function(r,t){for(var e in r)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&rs(t,r,e)};Object.defineProperty(gt,"__esModule",{value:!0});se(Ue(),gt);se(pr(),gt);se(mr(),gt);se(Dn(),gt);se(yr(),gt);se(En(),gt)});var Dt=ft(require("fs")),_n=ft(require("path")),Nr=ft(require("sharp")),nt=ft(er());var tt=ft(require("fs")),Ee=ft(require("zlib")),Wr=ft(require("http")),Yr=ft(require("http2")),K=ft(require("path")),lt=ft(er()),$,Io={".html":"text/html; charset=utf-8",".js":"text/javascript; charset=utf-8",".css":"text/css; charset=utf-8",".json":"application/json; charset=utf-8",".png":"image/png",".jpg":"image/jpeg",".gif":"image/gif",".ico":"image/x-icon",".svg":"image/svg+xml",".wav":"audio/wav",".mp4":"video/mp4",".woff":"font/woff",".woff2":"font/woff2",".ttf":"font/ttf",".wasm":"application/wasm",".webmanifest":"application/manifest+json"};function _o(r){r=r.split(/[?#]/)[0];let t={ok:!1,stat:null,file:"",redirect:null},e=n=>(t.file=n,tt.existsSync(n)&&(t.stat=tt.statSync(n),t.stat.isFile())?(t.ok=!0,!0):!1),i=n=>(t.file=n,tt.existsSync(n)&&(t.stat=tt.statSync(n),t.stat.isDirectory())?(t.ok=!0,!0):!1);return new Promise(n=>{i(K.join(process.cwd(),$.documentRoot,r))&&e(K.join(process.cwd(),$.documentRoot,r,$.defaultFile))?(t.redirect=K.join(r,$.defaultFile),n(t)):(e(K.join(process.cwd(),$.documentRoot,r))||e(K.join(process.cwd(),$.documentRoot,r,$.defaultFile))||e(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r))||e(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r,$.defaultFile))||i(K.join(process.cwd(),$.documentRoot,r))||i(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r))||i(K.join(K.dirname(K.join(process.cwd(),$.documentRoot,$.defaultFolder,r,$.defaultFile,r)))),n(t))})}async function Hr(r,t){let e=decodeURI(r.url);_o(e).then(i=>{let n=(r.headers.forwarded||"").match(/for="\[(.*)\]:/),c=(Array.isArray(n)?n[1]:null)||r.headers["x-forwarded-for"]||r.ip||r.socket.remoteAddress,l=r.headers[":scheme"]?.toUpperCase()||"HTTP";if(!i||!i.ok||!i.stat)t.writeHead(404,{"Content-Type":"text/html; charset=utf-8"}),t.end(`Error 404: Not Found
`,"utf-8"),lt.warn(`${l}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,url:e,remote:c});else if(i.redirect)t.writeHead(301,{Location:i.redirect}),t.end(),lt.data(`${l}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,url:e,redirect:i.redirect,remote:c});else{let f=encodeURIComponent(i.file).replace(/\*/g,"").replace(/\?/g,"").replace(/%2F/g,"/").replace(/%40/g,"@").replace(/%20/g," ").replace(/%3A/g,":").replace(/%5C/g,"\\");if(i?.stat?.isFile()){let d=String(K.extname(f)).toLowerCase(),T=Io[d]||"application/octet-stream",S=r.headers.range,b=S?.replace("bytes=","").split("-")||[0,i.stat.size-1],v=parseInt(b[0]||0),h=parseInt(b[1]||i.stat.size-1),w=r.headers["accept-encoding"]?r.headers["accept-encoding"].includes("br"):!1,C=S?{"Content-Range":"bytes "+v+"-"+h+"/"+i.stat.size,"Accept-Ranges":"bytes","Content-Length":h-v+1}:{},L=$.cors?{"Cross-Origin-Embedder-Policy":"require-corp","Cross-Origin-Opener-Policy":"same-origin"}:{};t.writeHead(S?206:200,{"Content-Size":i.stat.size,"Content-Language":"en","Content-Type":T,"Content-Encoding":w&&!S?"br":"","Last-Modified":i.stat.mtime.toUTCString(),"Cache-Control":"no-cache","X-Content-Type-Options":"nosniff","Content-Security-Policy":"media-src 'self' http: https: data:","`Service-Worker-Allowed":"/",...L,...C});let P=Ee.createBrotliCompress({params:{[Ee.constants.BROTLI_PARAM_QUALITY]:5}}),R=S?tt.createReadStream(f,{start:v,end:h}):tt.createReadStream(f);!w||S?R.pipe(t):R.pipe(P).pipe(t);let g=S?{range:{start:v,end:h,size:h-v+1}}:{};lt.data(`${l}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,mime:T.replace("; charset=utf-8",""),size:i.stat.size,...g,url:e,remote:c})}if(i?.stat?.isDirectory()){t.writeHead(200,{"Content-Language":"en","Content-Type":"application/json; charset=utf-8","Last-Modified":i.stat.mtime,"Cache-Control":"no-cache","X-Content-Type-Options":"nosniff"});let d=tt.readdirSync(f);d=d.map(T=>K.join(decodeURI(r.url),T)),t.end(JSON.stringify(d),"utf-8"),lt.data(`${l}:`,{method:r.method,ver:r.httpVersion,status:t.statusCode,mime:"directory/json",size:i.stat.size,url:e,remote:c})}}})}async function Zr(r){if($={insecureHTTPParser:!1,...r},tt.existsSync($.sslKey)&&tt.existsSync($.sslCrt))$.key=tt.readFileSync($.sslKey),$.cert=tt.readFileSync($.sslCrt);else try{let t=require.resolve("@vladmandic/build");$.sslKey=K.join(K.dirname(t),"..",$.sslKey),$.sslCrt=K.join(K.dirname(t),"..",$.sslCrt),$.key=tt.existsSync($.sslKey)?tt.readFileSync($.sslKey):null,$.cert=tt.existsSync($.sslCrt)?tt.readFileSync($.sslCrt):null}catch{}(!$.key||!$.cert)&&lt.warn("cannot read SSL certificate"),$.httpPort&&$.httpPort>0&&await new Promise(t=>{let e=Wr.createServer($,Hr);e.on("listening",()=>{lt.state("http:",{port:$.httpPort,root:$.documentRoot}),t(!0)}),e.on("error",i=>{lt.error("http:",i.message||i),t(!1)}),e.listen($.httpPort)}),$.httpsPort&&$.httpsPort>0&&$.key&&$.cert&&await new Promise(t=>{let e=Yr.createSecureServer($,Hr);e.on("listening",()=>{lt.state("https:",{port:$.httpsPort,root:$.documentRoot,sslKey:$.sslKey,sslCrt:$.sslCrt}),t(!0)}),e.on("error",i=>{lt.error("https:",i.message||i),t(!1)}),e.listen($.httpsPort)})}var Nn=ft(Sn());var Pn=require("crypto");var Ve=r=>(0,Pn.createHash)("md5").update(r).digest("hex"),ze=(r,t,e=!0)=>{let n=new RegExp(`${t}=("[^"]*"|[^,]*)`,"i").exec(r);return n?e?n[1].replace(/[\s"]/g,""):n[1]:null},is=r=>{let t=ze(r,"qop");if(t){let e=t.split(",");if(e.includes("auth"))return"auth";if(e.includes("auth-int"))return"auth-int"}return null},ns=()=>{let r="",t="abcdef0123456789";for(let e=0;e<32;++e)r+=t[Math.floor(Math.random()*t.length)];return r},ae=class{constructor(t,e,i){rt(this,"user");rt(this,"password");rt(this,"basic");rt(this,"statusCode");rt(this,"digest");rt(this,"hasAuth");rt(this,"lastAuth");this.user=t,this.password=e,this.digest={nc:0,algorithm:"MD5",realm:""},this.hasAuth=!1,this.statusCode=i?.statusCode||401,this.basic=i?.basic||!1}async fetch(t,e={}){if(this.basic)return fetch(t,this.addBasicAuth(e));let i=await fetch(t,this.addAuth(t,e));if(i.status===401||i.status===this.statusCode&&this.statusCode){if(this.hasAuth=!1,await this.parseAuth(i.headers.get("www-authenticate")),this.hasAuth){let n=await fetch(t,this.addAuth(t,e));return n.status===this.statusCode?this.hasAuth=!1:this.digest.nc++,n}}else this.digest.nc++;return i}addBasicAuth(t){let e=t,i="Basic "+Buffer.from(this.user+":"+this.password).toString("base64");return e.headers=new Headers,e.headers.set("Authorization",i),e}static computeHash(t,e,i){return Ve(`${t}:${e}:${i}`)}addAuth(t,e){if(!this.hasAuth)return e;let c=(typeof t=="object"&&typeof t.url=="string"?t.url:t).replace("//",""),l=c.indexOf("/")===-1?"/":c.slice(c.indexOf("/")),f=e.method?e.method.toUpperCase():"GET",d=ae.computeHash(this.user,this.digest.realm,this.password);if(this.digest.algorithm==="MD5-sess"&&(d=Ve(`${d}:${this.digest.nonce}:${this.digest.cnonce}`)),this.digest.qop==="auth-int")throw new Error("auth-int is not implemented");let T=Ve(`${f}:${l}`),S=("00000000"+this.digest.nc).slice(-8),b=`${d}:${this.digest.nonce}:${S}:${this.digest.cnonce}:${this.digest.qop}:${T}`;this.digest.qop||(b=`${d}:${this.digest.nonce}:${T}`);let v=Ve(b),h=this.digest.opaque!==null?`opaque="${this.digest.opaque}",`:"",w=this.digest.qop?`qop="${this.digest.qop}",`:"",C=`${this.digest.scheme} username="${this.user}",realm="${this.digest.realm}",nonce="${this.digest.nonce}",uri="${l}",${h}${w},algorithm="${this.digest.algorithm}",response="${v}",nc=${S},cnonce="${this.digest.cnonce}"`;e.headers=new Headers,e.headers.set("Authorization",C);let L={};return Object.assign(L,e),L}async parseAuth(t){if(this.lastAuth=t,!t||t.length<5){this.hasAuth=!1;return}this.hasAuth=!0,this.digest.scheme=t.split(/\s/)[0],this.digest.realm=(ze(t,"realm",!1)||"").replace(/["]/g,""),this.digest.qop=is(t),this.digest.opaque=ze(t,"opaque"),this.digest.nonce=ze(t,"nonce")||"",this.digest.cnonce=ns(),this.digest.nc++}};var Ge=class{constructor(t){rt(this,"label");rt(this,"config");rt(this,"cam");rt(this,"video");rt(this,"image");rt(this,"settings",{});rt(this,"client");rt(this,"init",()=>new Promise(t=>{this.cam=new Nn.Cam({hostname:this.config.hostname,username:this.config.username,password:this.config.password,port:this.config.port},async()=>{let e=[new Promise(l=>{this.cam?.getStreamUri((f,d)=>l(d))}),new Promise(l=>{this.cam?.getSnapshotUri((f,d)=>l(d))}),new Promise(l=>{this.cam?.getVideoSources((f,d)=>l(d))})],[i,n,c]=await Promise.all(e);this.video=i?.uri,this.image=n?.uri,this.settings={fps:c?.[0]?.framerate,resolution:[c?.[0]?.resolution?.width||0,c?.[0]?.resolution?.height||0]},t(this.cam)})}));rt(this,"snapshot",async()=>{if(!this.image)return;let t=await this.client.fetch(this.image);if(t.status===200)return t.blob()});this.config=t,this.label=this.config.label,this.client=new ae(this.config.username,this.config.password)}get profile(){return this.cam?this.cam.defaultProfile:{}}get imaging(){return new Promise(t=>{this.cam?.getVideoSources((e,i)=>t(i?.[0]?.imaging))})}};var Cn="@vladmandic/snaps",In="0.1.0";var br={};$n(br,{default:()=>ps,defaultFile:()=>ls,defaultFolder:()=>cs,documentRoot:()=>us,folder:()=>Zt,httpPort:()=>ss,httpsPort:()=>as,index:()=>Dr,interval:()=>Er,log:()=>He,quality:()=>Pr,resizeWidth:()=>Sr,secrets:()=>me,sslCrt:()=>fs,sslKey:()=>hs});var me="secrets.json",He="snaps.log",Zt="images",Dr="images/index.json",Er=3,ss=8e3,as=8001,us=".",cs="/",ls="public/index.html",hs="node_modules/@vladmandic/build/cert/https.key",fs="node_modules/@vladmandic/build/cert/https.crt",Sr=1280,Pr=60,ps={secrets:me,log:He,folder:Zt,index:Dr,interval:Er,httpPort:ss,httpsPort:as,documentRoot:us,defaultFolder:cs,defaultFile:ls,sslKey:hs,sslCrt:fs,resizeWidth:Sr,quality:Pr};var We={},ds=r=>{let t=Dt.readdirSync(Zt),e=0;for(let i of t){if(!i.startsWith(`${r}-`))continue;let n=Number(i.replace(`${r}-`,"").split(".")[0]);n>e&&(e=n)}return e++,nt.info("sequence:",{name:r,start:e}),e},An=()=>{let r=new Date,t=e=>e.toString().padStart(2,"0");return`${r.getFullYear()}:${t(r.getMonth()+1)}:${t(r.getDate())} ${t(r.getHours())}:${t(r.getMinutes())}:${t(r.getSeconds())}`},ms=()=>({IFD0:{Software:`${Cn} ${In}`},IFD2:{DateTimeOriginal:An(),OffsetTime:(new Date().getTimezoneOffset()/60).toString()}});async function gs(r,t){if(t.type!=="image/jpeg"&&t.type!=="image/png"){nt.warn("unrecognized file type:",{name:r,data:t});return}We[r]||(We[r]=ds(r));let e=We[r].toString().padStart(5,"0"),i=_n.join(Zt,`${r}-${e}.jpg`),n=new Uint8Array(await t.arrayBuffer()),c=await(0,Nr.default)(n).metadata(),l=await(0,Nr.default)(n).normalize().resize(Sr,null).jpeg({quality:Pr,mozjpeg:!0}).withMetadata({exif:ms()}).toFile(i);We[r]++;let f={seq:e,file:i,date:new Date,input:{name:r,size:t.size,type:t.type,resolution:[c.width,c.height]},output:{size:l.size,resolution:[l.width,l.height]}};Dt.appendFileSync(Dr,JSON.stringify(f)+`
`),nt.data("image:",f)}async function ys(r){for(let t of r){let e=await t.snapshot();e&&await gs(t.label,e)}}async function ws(){nt.configure({inspect:{breakLength:500}}),He?.length>0&&nt.logFile(He),nt.headerJson(),Dt.existsSync(me)||(nt.error("cannot read secrets:",me),process.exit(1)),(!Dt.existsSync(Zt)||!Dt.statSync(Zt).isDirectory())&&(nt.error("desitnation folder does not exist:",Zt),process.exit(1));let r=Dt.readFileSync(me,"utf8"),t=JSON.parse(r),e=[];for(let i of t){let n=new Ge(i);await n.init(),nt.state("device",{label:n.label,resolution:n.settings.resolution}),n.image&&e.push(n)}await Zr(br),setInterval(()=>ys(e),Er*1e3),An()}ws();
//# sourceMappingURL=snaps.js.map
